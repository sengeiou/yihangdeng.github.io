<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="yhd">
    
    <title>
        
            Spring5 |
        
        DyhBlog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/MyLogo.svg">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"yoursite.com","root":"/","language":"en","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":false,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/avatar.jpg","favicon":"/images/MyLogo.svg","article_img_align":"left","left_side_width":"230px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.jpeg"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":false},"lazyload":{"enable":true},"version":"3.4.1"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 5.1.1"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            <a class="logo-title" href="/">
                DyhBlog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                TAGS
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">TAGS</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">Spring5</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.jpg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">yhd</span>
                        
                            <span class="author-label">Lv4</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;2021-08-04 15:24:22
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Spring/">Spring</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E5%BA%94%E7%94%A8%E6%A1%86%E6%9E%B6/">应用框架</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>22.9k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>99 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <p><strong>引言</strong>：本文主要介绍Spring框架，包括Spring的相关概述、IoC原理、功能、实现。解释了依赖注入DI，讲解基于注解和XML实现Bean的创建。介绍了基于注解和xml的自动装配，以及Sring中通过Java配置类替代xml。讲解AOP的原理及其实现、介绍了JdbcTemplate。最后补充了Spring5的核心新特性等</p>
<h1 id="Spring概述"><a href="#Spring概述" class="headerlink" title="Spring概述"></a>Spring概述</h1><h2 id="基础介绍"><a href="#基础介绍" class="headerlink" title="基础介绍"></a>基础介绍</h2><ul>
<li><p><em>Spring</em>框架是由于软件开发的复杂性而创建的。Spring使用的是基本的JavaBean来完成以前只可能由EJB完成的事情。</p>
</li>
<li><p><em>Spring</em>的用途<strong>不仅仅限于服务器端的开发</strong>。从<u>简单性、可测试性和松耦合性角度而言</u>，绝大部分Java应用都可以从<em>Spring</em>中受益。</p>
<ul>
<li><strong>目的</strong>：解决企业应用开发的复杂性</li>
<li><strong>功能</strong>：使用基本的JavaBean代替EJB，并提供了更多的企业应用功能</li>
<li><strong>范围</strong>：任何Java应用</li>
</ul>
</li>
<li><p><em>Spring</em>是一个轻量级控制反转(Ioc)和面向切面(AOP)的容器框架</p>
</li>
</ul>
<blockquote>
<p>本人并且认为，Spring控制反转的思想，是<strong>任何面向对象程序设计</strong>都会采用的优秀的设计思想</p>
</blockquote>
<h2 id="历史发展"><a href="#历史发展" class="headerlink" title="历史发展"></a>历史发展</h2><ul>
<li><em>Spring</em>前身是由<strong>2002年</strong>，首次推出Spring框架的雏形，<em>interface21</em>框架</li>
<li><em>Spring</em>框架是以<em>interface21</em>框架为基础,经过重新设计,并不断丰富其内涵,于<strong>2004年3</strong>月24日,发布了1.0正式版本</li>
<li><strong>Rod Johnson</strong> ，Spring Framework创始人，著名作者。很难想象Rod johnson的学历，竟是一名悉尼大学的博士，然而他的专业不是计算机，而是音乐学。</li>
<li><em>Spring</em>本身是一个“<strong>大杂烩</strong>”即除了IoC和AOP核心外，有自己的JDBC，MVC，DAO，cache…。基本整合了现有的技术框架！</li>
</ul>
<h2 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h2><h3 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h3><ul>
<li>Spring是一个<u>开源免费</u>的框架 , 容器 </li>
<li>Spring是一个<u>轻量级</u>的框架 , <u>非侵入式</u>，<ul>
<li>非入侵式：即引入Spring对原有项目不会带来任何影响</li>
<li>轻量级：依赖jar包体积小数量少，而且只依赖自身jar包</li>
</ul>
</li>
<li><strong>控制反转</strong> IoC  , <strong>面向切面</strong> AOP</li>
<li>对事务的支持 , 对框架的支持</li>
<li>……</li>
</ul>
<p>Spring是一个开源免费的轻量级的控制反转（IOC）和面向切面编程的框架！</p>
<h3 id="劣势"><a href="#劣势" class="headerlink" title="劣势"></a>劣势</h3><ul>
<li>由于Spring随着不断发展，已经是一个大杂烩了，因此有<strong>非常多的配置</strong>，十分繁琐，人称“<strong>配置地狱</strong>”</li>
</ul>
<h2 id="Spring的7大模块"><a href="#Spring的7大模块" class="headerlink" title="Spring的7大模块"></a>Spring的7大模块</h2><ul>
<li>Spring的7大模块图示（除开测试模块）</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/Spring7大模块02.jpg"
                      style="zoom:150%;" /
                >

<ul>
<li><strong>Spring Core</strong>（核心容器）：核心容器提供 Spring 框架的基本功能。核心容器的主要组件BeanFactory，它是<u>工厂模式</u>的实现。BeanFactory 使用<u>控制反转</u>（IOC） 模式将应用程序的配置和依赖性规范与实际的应用程序代码分开。</li>
<li><strong>Spring Context</strong>（上下文）：Spring 上下文是一个配置文件，向 Spring 框架提供上下文信息。Spring 上下文包括企业服务，例如 JNDI、EJB、电子邮件、国际化、校验和调度功能。</li>
<li><strong>Spring AOP</strong>：通过配置管理特性，Spring AOP 模块直接将面向切面的编程功能 , 集成到了 Spring 框架中。所以，可以很容易地使 Spring 框架管理任何支持 AOP的对象。Spring AOP 模块为基于 Spring 的应用程序中的对象提供了事务管理服务。通过使用 Spring AOP，不用依赖组件，就可以将声明性事务管理集成到应用程序中。</li>
<li><strong>Spring DAO</strong>：JDBC DAO 抽象层提供了有意义的异常层次结构，可用该结构来管理异常处理和不同数据库供应商抛出的错误消息。异常层次结构简化了错误处理，并且极大地降低了需要编写的异常代码数量（例如打开和关闭连接）。Spring DAO 的面向 JDBC 的异常遵从通用的 DAO 异常层次结构。</li>
<li><strong>Spring ORM</strong>：Spring 框架插入了若干个 ORM 框架，从而提供了 ORM 的对象关系工具，其中包括 JDO、Hibernate 和 iBatis SQL Map。所有这些都遵从 Spring 的通用事务和 DAO 异常层次结构。</li>
<li><strong>Spring Web 模块</strong>：Web 上下文模块建立在应用程序上下文模块之上，为基于 Web 的应用程序提供了上下文。所以，Spring 框架支持与 Jakarta Struts 的集成。Web 模块还简化了处理多部分请求以及将请求参数绑定到域对象的工作。</li>
<li><strong>Spring MVC 框架</strong>：MVC 框架是一个全功能的构建 Web 应用程序的 MVC 实现。通过策略接口，MVC 框架变成为高度可配置的，MVC 容纳了大量视图技术，其中包括 JSP、Velocity、Tiles、iText 和 POI。</li>
</ul>
<h2 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h2><h3 id="Spring体系"><a href="#Spring体系" class="headerlink" title="Spring体系"></a>Spring体系</h3><ul>
<li>现代化的Java开发</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210719153004.png"
                     
                ></p>
<h3 id="Spring-Boot"><a href="#Spring-Boot" class="headerlink" title="Spring Boot"></a>Spring Boot</h3><ul>
<li>Spring Boot 是 Spring 的一<strong>套快速配置脚手架</strong>，可以基于Spring Boot 快速开发单个微服务;<ul>
<li>即通过<strong>约定 &gt; 配置</strong>；来减少配置的操作</li>
</ul>
</li>
<li>Spring Boot专注于快速、方便集成的单个微服务个体，Spring Cloud关注全局的服务治理框架；</li>
<li>Spring Boot使用了约束优于配置的理念，很多集成方案已经帮你选择好了，能不配置就不配置 , Spring Cloud很大的一部分是基于Spring Boot来实现，Spring Boot可以离开Spring Cloud独立使用开发项目，但是Spring Cloud离不开Spring Boot，属于依赖的关系。</li>
<li>SpringBoot在SpringClound中起到了承上启下的作用，如果你要学习SpringCloud必须要学习SpringBoot。</li>
<li>而学习Spring Boot 的<strong>前提需完全掌握Spring和SpringMVC</strong></li>
</ul>
<h3 id="Spring-Cloud"><a href="#Spring-Cloud" class="headerlink" title="Spring Cloud"></a>Spring Cloud</h3><ul>
<li>Spring Cloud是基于Spring Boot实现的</li>
</ul>
<h1 id="IoC理论"><a href="#IoC理论" class="headerlink" title="IoC理论"></a>IoC理论</h1><h2 id="场景分析"><a href="#场景分析" class="headerlink" title="场景分析"></a>场景分析</h2><h3 id="调用流程"><a href="#调用流程" class="headerlink" title="调用流程"></a>调用流程</h3><p><strong>逐层调用</strong>，<u>层次之间的实现类</u>属于<strong>组合/依赖</strong>的关系</p>
<ul>
<li>前端User请求</li>
<li>UserServlet，业务Servlet</li>
<li>UserService，业务接口</li>
<li>UserServiceImpl，业务实现类</li>
<li>UserDao，持久层接口</li>
<li>UserDaoImpl，持久层是实现类</li>
</ul>
<h3 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h3><h4 id="模拟DAO层"><a href="#模拟DAO层" class="headerlink" title="模拟DAO层"></a>模拟DAO层</h4><ul>
<li>UserDao接口</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function">User <span class="title">getUser</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>UserDao实现类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImp</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;UserDaoImp的方法实现&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="模拟业务层"><a href="#模拟业务层" class="headerlink" title="模拟业务层"></a>模拟业务层</h4><ul>
<li>UserService接口</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getUser</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>UserService实现类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">	<span class="comment">//依赖关系</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao = <span class="keyword">new</span> UserDaoImp();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUser</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        userDao.getUser(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="模拟Servlet层"><a href="#模拟Servlet层" class="headerlink" title="模拟Servlet层"></a>模拟Servlet层</h4><ul>
<li>UserServlet</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//main函数调用接口对应的方法模拟web容器调用</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> UserServlet().login();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//依赖关系</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService = <span class="keyword">new</span> UserServiceImpl();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> id = <span class="number">0</span>;</span><br><span class="line">        userService.getUser(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>输出结果</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UserDaoImp的方法实现</span><br></pre></td></tr></table></figure>

<h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h3><h4 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h4><ul>
<li>若此时用户提出需求，要在某一层中增加一个其他方式的实现类代码，如增加UserDaoOracleImpl实现类</li>
<li>此时需要进入到Service层的<strong>源代码中</strong>，将UserDao的实现类<strong>手动修改</strong>为UserDaoOracleImpl</li>
<li>在<u>实际开发</u>中，如果采用这种方式，则可能存在<strong>需要修改成千上万的代码</strong>，代价是非常昂贵的</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210718164611.png"
                     
                ></p>
<h4 id="代码示例-1"><a href="#代码示例-1" class="headerlink" title="代码示例"></a>代码示例</h4><ul>
<li>增加的UserDaoOracleImpl实现类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoOracleImpl</span> <span class="keyword">implements</span> <span class="title">UserDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;UserDaoOracleImpl的方法实现&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>修改部分，进入Service代码修改</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao = <span class="keyword">new</span> UserDaoOracleImpl();<span class="comment">//new UserDaoImp();</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUser</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        userDao.getUser(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>输出效果</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UserDaoOracleImpl的方法实现</span><br></pre></td></tr></table></figure>

<h2 id="依赖注入"><a href="#依赖注入" class="headerlink" title="依赖注入"></a>依赖注入</h2><h3 id="设计思想"><a href="#设计思想" class="headerlink" title="设计思想"></a>设计思想</h3><ul>
<li>对依赖的对象通过<strong>接收该接口实现类</strong>的方式设置一个<strong>setter方法</strong></li>
<li>在调用依赖对象方法前，先将依赖的对象的实现类传入后再调用</li>
<li>其实这个过程就是“<strong>依赖注入</strong>”（Dependency Injection,DI），即<strong>依赖关系</strong>的是实现类对象<strong>通过外部注入</strong>。从而表现出的现象做“<strong>控制反转</strong>”（Inversion of control）</li>
</ul>
<h3 id="代码示例-2"><a href="#代码示例-2" class="headerlink" title="代码示例"></a>代码示例</h3><ul>
<li>为存在依赖关系的Service层添加一个实现类注入的setter方法</li>
<li>在service接口中声明setter方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getUser</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setUserDao</span><span class="params">(UserDao dao)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>实现类实现</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//依赖注入</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserDao</span><span class="params">(UserDao userDao)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUser</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        userDao.getUser(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>调用测试</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//main函数调用接口对应的方法模拟web容器调用</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> UserServlet().login();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//根据用户的需求变更实现类</span></span><br><span class="line">        String need = <span class="string">&quot;oracle&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;oracle&quot;</span>.equals(need))&#123;</span><br><span class="line">            userService = <span class="keyword">new</span> UserServiceImpl();</span><br><span class="line">            userService.setUserDao(<span class="keyword">new</span> UserDaoOracleImpl());</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            userService = <span class="keyword">new</span> UserServiceImpl();</span><br><span class="line">            userService.setUserDao(<span class="keyword">new</span> UserDaoImpl());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> id = <span class="number">0</span>;</span><br><span class="line">        userService.getUser(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="问题分析-1"><a href="#问题分析-1" class="headerlink" title="问题分析"></a>问题分析</h3><ul>
<li>此时程序的控制权不再是程序员，而变成了用户</li>
<li>程序此时可以通过用户的需要注入对应的实现类，从而在尽量不改变原有代码的情况下变更代码</li>
<li>即变成了由用户的需求动态地选择了程序的实现体</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210718165605.png"
                     
                ></p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><ul>
<li>首先，程序开发中，不是所有类之间的关系都是继承关系(接口可以都定义)；继承关系本身是低耦合</li>
<li>即<strong>依赖/组合</strong>这 种类和对象的关系是<strong>必定存在</strong>的。而依赖组合本身就必<strong>定是高耦合的</strong></li>
<li>当用户需求变更时，会直接影响到组合依赖关系的代码，此时需要根据用户的需求改写源代码，如果程序代码量十分大，修改成本将是巨昂的。</li>
<li>即其中的关系为：用户变更，促使程序变更，促使程序员手动修改源代码</li>
<li>难道就没有什么方法，在这种必然存在的<strong>依赖组合关系中减低程序的耦合度</strong>？</li>
<li>有，就是基于依赖注入，从而实现的控制反转（Ioc），此时代码是根据用户的需求改变程序代码，而不是根据用户的需求，程序员去修改代码。</li>
<li>最后配合工厂模式，可以使注入的过程本身更加低耦合，增强其动态性</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210718173204.png"
                     
                ></p>
<ul>
<li><u>依赖注入实现的控制反转就是针对降低依赖/组合这种对象关系耦合度的设计思想</u></li>
<li>通过把具有依赖关系的类，创建其接口，通过外部注入接口实现类的方式让用户去管理是实现类对象</li>
<li>以后就不用程序员管理对象创建了，系统的耦合性大大减低，使其更专注于业务的实现</li>
<li>个人认为，DI就是Ioc，无论是注解方式还是配置方式、这些都是“依赖注入”的表现</li>
</ul>
<h2 id="IoC容器"><a href="#IoC容器" class="headerlink" title="IoC容器"></a>IoC容器</h2><h3 id="为什么有IoC容器"><a href="#为什么有IoC容器" class="headerlink" title="为什么有IoC容器?"></a>为什么有IoC容器?</h3><ul>
<li>所谓IOC容器就是指下述注释中的代码部分，即根据用户的需求(String need)变量去统一生产并注入其依赖关系的实现类对象。</li>
<li>这部分代码是进行IoC控制操作的代码，<strong>由于</strong>这部分代码的功能逻辑是<strong>具有统一性</strong>，即可考虑封装成一个通用的结构进行通用的操作。</li>
<li>而将这部分代码封装成一个统一的结构就是IoC的容器结构。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServlet</span> </span>&#123;</span><br><span class="line">    <span class="comment">//main函数调用接口对应的方法模拟web容器调用</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> UserServlet().login();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//根据用户的需求变更实现类</span></span><br><span class="line">        <span class="comment">//IOC容器开始部分------------</span></span><br><span class="line">        String need = <span class="string">&quot;oracle&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;oracle&quot;</span>.equals(need))&#123;</span><br><span class="line">            userService = <span class="keyword">new</span> UserServiceImpl();</span><br><span class="line">            userService.setUserDao(<span class="keyword">new</span> UserDaoOracleImpl());</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            userService = <span class="keyword">new</span> UserServiceImpl();</span><br><span class="line">            userService.setUserDao(<span class="keyword">new</span> UserDaoImpl());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//IOC容器结束部分--------------</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> id = <span class="number">0</span>;</span><br><span class="line">        userService.getUser(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="IoC容器结构"><a href="#IoC容器结构" class="headerlink" title="IoC容器结构"></a>IoC容器结构</h3><ul>
<li>实际开发中并非这种简单的分支结构实现，为了更低的耦合度，基于工厂模式于反射实现。等价关系如下</li>
</ul>
<table>
<thead>
<tr>
<th>具体操作</th>
<th>代码示例结构</th>
<th>实际IoC容器结构</th>
</tr>
</thead>
<tbody><tr>
<td><strong>对象创建</strong></td>
<td>当前need信息同时包含表示创建的对象类型</td>
<td>配置信息中<strong>id</strong>和<strong>class</strong>部分(xml，注解)</td>
</tr>
<tr>
<td><strong>依赖注入</strong></td>
<td>need + 分支语句 + new操作</td>
<td>配置信息中<strong>property</strong> + 工厂模式 + 反射操作</td>
</tr>
</tbody></table>
<h3 id="IoC容器功能"><a href="#IoC容器功能" class="headerlink" title="IoC容器功能"></a>IoC容器功能</h3><ul>
<li>IoC容器<strong>不仅</strong>相当于一个非常大的工厂。</li>
<li>IoC容器区别纯粹的工厂模式是IoC容器生产对象后还会通过配置信息(xml/注解)<strong>实现对存在依赖关系的属性进行依赖注入</strong>，使其依赖关系的实现类被统一管理，提高代码复用性，减低耦合度。</li>
<li>即我们通过IOC容器(工厂)去统一管理这些依赖关系，并在配置信息中统一去进行依赖的注入</li>
<li>此时程序员的身份相当于用户的身份，用户的需求变更，等价于程序员只需要修改配置文件中的注入内容</li>
</ul>
<hr>
<ul>
<li>小结：<ul>
<li>IoC容器 == <strong>工厂 + 依赖注入操作</strong></li>
<li>IoC容器同时包含了<strong>对象创建</strong>和，<strong>依赖注入</strong>(关键)的两个操作，并非大一的工厂</li>
<li>IoC容器使对象由Spring进行对象的<strong>创建</strong>、**<u>管理、装配</u>**工作</li>
</ul>
</li>
</ul>
<h3 id="Spring-IoC改写"><a href="#Spring-IoC改写" class="headerlink" title="Spring IoC改写"></a>Spring IoC改写</h3><ul>
<li>将上述案例改写成Spring实际使用方式</li>
</ul>
<h4 id="设置配置文件"><a href="#设置配置文件" class="headerlink" title="设置配置文件"></a>设置配置文件</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.dao.UserDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoOracleImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.dao.UserDaoOracleImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userServiceImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.service.UserServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- ref：通过引用Srping容器中创建的对象(id)，而value是具体的值 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 依赖注入操作 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoOracleImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="从容器中获取对象"><a href="#从容器中获取对象" class="headerlink" title="从容器中获取对象"></a>从容器中获取对象</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//main函数调用接口对应的方法模拟web容器调用</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> UserServlet().login();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//用户的需求变更，变更在配置文件中，对象统一从IoC容器中获取并进行依赖注入操作</span></span><br><span class="line">        ApplicationContext context =</span><br><span class="line">                <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean.xml&quot;</span>);</span><br><span class="line">        userService = (UserService) context.getBean(<span class="string">&quot;userServiceImpl&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> id = <span class="number">0</span>;</span><br><span class="line">        userService.getUser(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>输出结果</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UserDaoOracleImpl的方法实</span><br></pre></td></tr></table></figure>

<ul>
<li>若想更改依赖关系对象的实现，只需在配置文件这一个位置修改配置信息即全部改动，极大降低了依赖关系的耦合度。</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userServiceImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.service.UserServiceImpl&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 依赖注入操作 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>输出结果2</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UserDaoImp的方法实现</span><br></pre></td></tr></table></figure>

<h1 id="HelloWorld"><a href="#HelloWorld" class="headerlink" title="HelloWorld"></a>HelloWorld</h1><h2 id="原始方式"><a href="#原始方式" class="headerlink" title="原始方式"></a>原始方式</h2><h3 id="官网介绍"><a href="#官网介绍" class="headerlink" title="官网介绍"></a>官网介绍</h3><ul>
<li>官网地址：<a class="link"   target="_blank" rel="noopener" href="https://spring.io/" >https://spring.io<i class="fas fa-external-link-alt"></i></a></li>
<li>Spring框架版本页所在处</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210718215729.png"
                     
                ></p>
<ul>
<li><p><strong>GA</strong>：General Availability，<u>正式发布的版本</u>，官方推荐使用此版本。在国外都是用GA来说明release(发行版)版本的。</p>
</li>
<li><p><strong>SNAPSHOT</strong>：Snapshot，<u>快照版</u>，可以稳定使用，且仍在继续改进版本。</p>
</li>
<li><p><strong>PRE</strong>：Preview，<u>预览版，内部测试版</u>，主要是给开发人员和测试人员测试和找BUG用的，不建议使用</p>
</li>
</ul>
<h3 id="资源下载地址"><a href="#资源下载地址" class="headerlink" title="资源下载地址"></a>资源下载地址</h3><ul>
<li>官方下载地址：<a class="link"   target="_blank" rel="noopener" href="https://repo.spring.io/ui/native/libs-release-local/org/springframework/spring" >https://repo.spring.io/ui/native/libs-release-local/org/springframework/spring<i class="fas fa-external-link-alt"></i></a></li>
</ul>
<h4 id="地址寻找步骤"><a href="#地址寻找步骤" class="headerlink" title="地址寻找步骤"></a>地址寻找步骤</h4><ol>
<li>进入仓库页面</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210718222951.png"
                     
                ></p>
<ol start="2">
<li>找到本地发行版本仓库</li>
</ol>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210718222442.png"
                      style="zoom:67%;" /
                >

<ol start="3">
<li>选择想下载的版本<ul>
<li>主要下载，spring-5.3.9-dist.zip</li>
</ul>
</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210718222757.png"
                     
                ></p>
<h3 id="创建Java项目"><a href="#创建Java项目" class="headerlink" title="创建Java项目"></a>创建Java项目</h3><ul>
<li>略</li>
</ul>
<h3 id="导入IoC基础包"><a href="#导入IoC基础包" class="headerlink" title="导入IoC基础包"></a>导入IoC基础包</h3><h4 id="Jar包结构"><a href="#Jar包结构" class="headerlink" title="Jar包结构"></a>Jar包结构</h4><p>每种类型的jar包均含3个，代码jar包，稳定jar包，源代码jar包</p>
<ul>
<li><strong>spring-aop-5.3.9</strong><ul>
<li>spring-aop-5.3.9.jar</li>
<li>spring-aop-5.3.9-javadoc.jar</li>
<li>spring-aop-5.3.9-sources.jar</li>
</ul>
</li>
<li>spring-aspects-5.3.9<ul>
<li>spring-aspects-5.3.9.jar</li>
<li>spring-aspects-5.3.9-javadoc.jar</li>
<li>spring-aspects-5.3.9-sources.jar</li>
</ul>
</li>
<li>spring-beans-5.3.9<ul>
<li>spring-beans-5.3.9.jar</li>
<li>……</li>
</ul>
</li>
<li>….</li>
</ul>
<h4 id="导入Core-Container"><a href="#导入Core-Container" class="headerlink" title="导入Core Container"></a>导入Core Container</h4><p>导入Spring Core Container的核心Jar包即可，包含4个</p>
<ul>
<li><p><strong>Beans</strong>：spring-beans-5.3.9.jar</p>
</li>
<li><p><strong>Core</strong>：spring-core-5.3.9.jar</p>
</li>
<li><p><strong>Context</strong>：spring-context-5.3.9.jar</p>
</li>
<li><p><strong>Expression</strong>：spring-expression-5.3.9.jar</p>
<hr>
</li>
<li><p>外部依赖的日志包：commons-logging-1.1.1.jar</p>
</li>
</ul>
<h3 id="准备Bean结构"><a href="#准备Bean结构" class="headerlink" title="准备Bean结构"></a>准备Bean结构</h3><ul>
<li>无属性JavaBean</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;I am &quot;</span> + name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="配置Bean信息"><a href="#配置Bean信息" class="headerlink" title="配置Bean信息"></a>配置Bean信息</h3><ul>
<li>可通过注解或者XML配置方式，暂且采用XML配置方式</li>
</ul>
<h4 id="创建XML文件"><a href="#创建XML文件" class="headerlink" title="创建XML文件"></a>创建XML文件</h4><ul>
<li>在src目录下创建xml文件，文件名可自定义</li>
</ul>
<h5 id="查询Spring的XML结构"><a href="#查询Spring的XML结构" class="headerlink" title="查询Spring的XML结构"></a>查询Spring的XML结构</h5><ul>
<li>进入官方的core文档介绍</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210718230439.png"
                     
                ></p>
<ul>
<li>找到xml定义</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210718230539.png"
                     
                ></p>
<ul>
<li>Spring的xml的命名空间。也可以通过IDEA——new——XML configuration File——Spring Config创建</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="配置Bean信息-1"><a href="#配置Bean信息-1" class="headerlink" title="配置Bean信息"></a>配置Bean信息</h4><ul>
<li>配置User类Bean信息</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- id相当于创建的唯一变量名，calss为全类名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.spring.User&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 属性注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;admin&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- collaborators and configuration for this bean go here --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="加载配置文件及获取对象"><a href="#加载配置文件及获取对象" class="headerlink" title="加载配置文件及获取对象"></a>加载配置文件及获取对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//1、获取Spring的上下对象，加载配置文件，即IoC容器</span></span><br><span class="line">        ApplicationContext context = </span><br><span class="line">            <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2、从容器中获取对象实例，调用getBean()，输入配置文件中的id</span></span><br><span class="line">        User user = context.getBean(<span class="string">&quot;user&quot;</span>,User.class);</span><br><span class="line">        user.hello();<span class="comment">//I am admin</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Maven方式"><a href="#Maven方式" class="headerlink" title="Maven方式"></a>Maven方式</h2><ul>
<li>Spring maven依赖查询地址：<a class="link"   target="_blank" rel="noopener" href="https://mvnrepository.com/tags/spring" >https://mvnrepository.com/tags/spring<i class="fas fa-external-link-alt"></i></a></li>
<li>可以按需选择导入相关的包</li>
<li>也可以选择导入一个覆盖范围大些的 <a class="link"   target="_blank" rel="noopener" href="https://mvnrepository.com/artifact/org.springframework/spring-webmvc" >spring webmvc<i class="fas fa-external-link-alt"></i></a>的maven依赖，此时maven会讲依赖的包自动导入</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-webmvc --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>导入Maven依赖后操作如同上述”原始方式”进行HelloWorld案例实现</li>
</ul>
<h1 id="IoC容器实例化"><a href="#IoC容器实例化" class="headerlink" title="IoC容器实例化"></a>IoC容器实例化</h1><h2 id="IoC容器接口"><a href="#IoC容器接口" class="headerlink" title="IoC容器接口"></a>IoC容器接口</h2><p>Spring 提供 IOC 容器实现两种方式：（两个接口）</p>
<ul>
<li><strong>BeanFactory</strong>：<ul>
<li>IOC 容器基本实现，是 Spring 内部的使用接口，不提供开发人员进行使用</li>
<li><strong>懒加载</strong>，加载配置文件时候不会创建对象，在获取对象（使用）才去创建对象</li>
</ul>
</li>
<li><strong>ApplicationContext</strong>：（<u>更常用与Web开发</u>）<ul>
<li>BeanFactory 接口的子接口，提供更多更强大的功能，一般由开发人员进行使用 </li>
<li>加载配置文件时候就会把在配置文件对象进行创建</li>
</ul>
</li>
</ul>
<blockquote>
<ul>
<li>单从普通程序运行角度来说，BeanFactroy更占优势，懒加载模式更节省资源</li>
<li>从Web开发这角度来说，ApplicationContext更占优势，一般将耗时耗费内存的加载过程放到服务器启动时操作</li>
<li>Spring常用与Web开发，因此更推荐ApplicationContext接口</li>
</ul>
</blockquote>
<h2 id="主要实现类"><a href="#主要实现类" class="headerlink" title="主要实现类"></a>主要实现类</h2><ul>
<li><p><strong>ClassPathXmlApplicationContext</strong>：相当于<strong>类路径</strong>xml配置文件上下文加载</p>
</li>
<li><p><strong>FileSystemXmlApplicationContext</strong>：文件系统<strong>绝对路径</strong>xml配置文件上下文加载</p>
</li>
</ul>
<h1 id="IoC对象创建方式"><a href="#IoC对象创建方式" class="headerlink" title="IoC对象创建方式"></a>IoC对象创建方式</h1><ul>
<li><strong>注</strong>：设置属性值，即依赖注入。必须<strong>提供该属性的setter方法</strong></li>
<li>对象实例化时机并非getBean()时机，而是<strong>xml文件被加载时</strong>，所有配置的<strong>所有bean都被一同创建了</strong></li>
</ul>
<h2 id="空参构造器方式"><a href="#空参构造器方式" class="headerlink" title="空参构造器方式"></a>空参构造器方式</h2><ul>
<li>通过调用<strong>无参构造器</strong>实例化对象，也是默认的一种方式</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.User&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="有参构造器方式"><a href="#有参构造器方式" class="headerlink" title="有参构造器方式"></a>有参构造器方式</h2><ul>
<li>常用程度：参数名值对匹配 &gt; 参数位置匹配 &gt; 参数类型匹配</li>
</ul>
<h3 id="名值对匹配"><a href="#名值对匹配" class="headerlink" title="名值对匹配"></a>名值对匹配</h3><ul>
<li><strong>构造器示例</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String username, String password, Date time)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.username = username;</span><br><span class="line">    <span class="keyword">this</span>.password = password;</span><br><span class="line">    <span class="keyword">this</span>.time = time;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>xml配置</strong><ul>
<li>基本数据类型：name - value</li>
<li>引用数据类型：ref，通过id引用容器中的其他bean对象</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;admin&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;password&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 引用数据类型适用ref，可通过id引用容器中的其他bean对象 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;data&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;data&quot;</span> <span class="attr">class</span>=<span class="string">&quot;java.util.Date&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="位置匹配"><a href="#位置匹配" class="headerlink" title="位置匹配"></a>位置匹配</h3><ul>
<li><strong>构造器示例</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String username, String password)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.username = username;</span><br><span class="line">    <span class="keyword">this</span>.password = password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>xml配置</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;admin&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;password&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="类型匹配"><a href="#类型匹配" class="headerlink" title="类型匹配"></a>类型匹配</h3><ul>
<li><u>只适用于</u>参数列表中<strong>各参数类型不同的情况</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;exampleBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;examples.ExampleBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">&quot;int&quot;</span> <span class="attr">value</span>=<span class="string">&quot;7500000&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">&quot;java.lang.String&quot;</span> <span class="attr">value</span>=<span class="string">&quot;42&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="xml配置基础"><a href="#xml配置基础" class="headerlink" title="xml配置基础"></a>xml配置基础</h1><h2 id="bean"><a href="#bean" class="headerlink" title="bean"></a>bean</h2><ul>
<li>用于配置一个bean的信息<ul>
<li><strong>id</strong>：bean的唯一标识符，相当于变量名</li>
<li><strong>class</strong>：实例化对象的全类名</li>
<li><strong>name</strong>：bean的<strong>别名</strong>，<u>可以取多个</u>，每个别名用逗号、空格、分号隔开</li>
<li>……</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.User&quot;</span> <span class="attr">name</span>=<span class="string">&quot;user1,user2;user3&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="alias"><a href="#alias" class="headerlink" title="alias"></a>alias</h2><ul>
<li>alias标签可以为某个bean配置独立设置别名</li>
<li>在配置文件中，或者IoC容器获取中都可以适用别名进行获取</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">alias</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;userAlias&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="import"><a href="#import" class="headerlink" title="import"></a>import</h2><ul>
<li>将其他xml配置文件导入合并到当前文件，一般用于团队开发</li>
<li>虽然<code>new ClassPathXmlApplicationContext();</code>可同时传入多个配置文件</li>
<li>但一般团队开发都是各自创建各自xml文件，最后都导入到一个配置文件，加载时只加载一个</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;bean.xml&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="依赖注入-1"><a href="#依赖注入-1" class="headerlink" title="依赖注入"></a>依赖注入</h1><ul>
<li><p>“<strong>依赖注入</strong>”（Dependency Injection,DI），即将属于<strong>依赖关系</strong>的是对象实例<strong>通过外部注入</strong></p>
</li>
<li><p>Spring 支持具有命名空间的可扩展配置格式</p>
</li>
<li><p>依赖注入</p>
</li>
<li><p>通过命名空间设置可以使Spring支持一些额外的格式化配置方式</p>
<blockquote>
<p>官方提示：命名空间不如标准 XML 格式灵活。例如，声明属性引用的格式与以 结尾的属性冲突<code>Ref</code>，而标准 XML 格式则不然。我们建议您谨慎选择您的方法并将其传达给您的团队成员，以避免同时使用所有三种方法生成 XML 文档。</p>
</blockquote>
</li>
</ul>
<h2 id="有参构造器注入"><a href="#有参构造器注入" class="headerlink" title="有参构造器注入"></a>有参构造器注入</h2><h3 id="lt-constructor-arg-gt-方式"><a href="#lt-constructor-arg-gt-方式" class="headerlink" title="&lt;constructor-arg&gt;方式"></a>&lt;constructor-arg&gt;方式</h3><ul>
<li>即IoC对象创建时，构建有参构造器的方式</li>
</ul>
<h3 id="c命名空间方式"><a href="#c命名空间方式" class="headerlink" title="c命名空间方式"></a>c命名空间方式</h3><ul>
<li>从概念上与p命名空间类似</li>
<li>c命名空间是对应 constructor，即刻构造器注入的一种方式</li>
<li><strong>导入c命名空间约束</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlns:c=&quot;http://www.springframework.org/schema/c&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>c命名空间的使用实例，其他配置具体对应详情看<a class="link"   target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#spring-core" >官方文档<i class="fas fa-external-link-alt"></i></a></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:c</span>=<span class="string">&quot;http://www.springframework.org/schema/c&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 传统标签方式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;user1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.User&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Tom&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- c命名空间方式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;user2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.User&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">c:name</span>=<span class="string">&quot;Deny&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="set注入"><a href="#set注入" class="headerlink" title="set注入"></a>set注入</h2><h3 id="测试准备"><a href="#测试准备" class="headerlink" title="测试准备"></a>测试准备</h3><ul>
<li>强调涵盖各种结构，不一定使标准规范的面向对象设计</li>
</ul>
<h4 id="Sutdent-java"><a href="#Sutdent-java" class="headerlink" title="Sutdent.java"></a>Sutdent.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Address address;</span><br><span class="line">    <span class="keyword">private</span> String[] books;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; hobbies;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,String&gt; card;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; games;</span><br><span class="line">    <span class="keyword">private</span> String wife;</span><br><span class="line">    <span class="keyword">private</span> Properties info;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//只有一个空参构造器，忽略getter和setter以及toString方法...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Address-java"><a href="#Address-java" class="headerlink" title="Address.java"></a>Address.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Address</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String address;</span><br><span class="line">    <span class="comment">//只有一个空参构造器，忽略getter和setter以及toString方法...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="lt-property-gt-方式"><a href="#lt-property-gt-方式" class="headerlink" title="&lt;property&gt;方式"></a>&lt;property&gt;方式</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;address&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Address&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">value</span>=<span class="string">&quot;中国&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Student&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 普通数据类型注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Tom&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Bean数据类型注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;address&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 数组类型注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;books&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>Spring实战<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>Spring源码揭秘<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- List类型注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hobbies&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>听歌<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>学习<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 注入bean使用ref标签 --&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- &lt;ref bean=&quot;beanId&quot;&gt;&lt;/ref&gt; --&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Set类型注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;games&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>COD<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>DMC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Map类型注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;身份证&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123123123&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;银行卡&quot;</span> <span class="attr">value</span>=<span class="string">&quot;23241231241&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- null值显示注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;wife&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">null</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 空串注入 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;property name=&quot;wife&quot; value=&quot;&quot;/&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Properties类型注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;info&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;driver&quot;</span>&gt;</span>232323<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;sex&quot;</span>&gt;</span>男<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;username&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;password&quot;</span>&gt;</span>password<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="其他注入写法"><a href="#其他注入写法" class="headerlink" title="其他注入写法"></a>其他注入写法</h4><h5 id="特殊属性值注入"><a href="#特殊属性值注入" class="headerlink" title="特殊属性值注入"></a>特殊属性值注入</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--属性值包含特殊符号</span></span><br><span class="line"><span class="comment"> 方法1：把&lt;&gt;进行转义 &amp;lt; &amp;gt;</span></span><br><span class="line"><span class="comment"> 方法2：把带特殊符号内容写到 CDATA</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">value</span>&gt;</span>&lt;![CDATA[&lt;&lt;南京&gt;&gt;]]&gt;<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="内部bean注入"><a href="#内部bean注入" class="headerlink" title="内部bean注入"></a>内部bean注入</h5><ul>
<li>少用，更多使使用常规的配置到外部</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--内部 bean--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;emp&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.spring5.bean.Emp&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设置两个普通属性--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;ename&quot;</span> <span class="attr">value</span>=<span class="string">&quot;lucy&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;女&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--内部bean注入写法、设置对象类型属性--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dept&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dept&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.spring5.bean.Dept&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;安保部&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="get方法获取"><a href="#get方法获取" class="headerlink" title="get方法获取"></a>get方法获取</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--级联赋值--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;emp&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.spring5.bean.Emp&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设置两个普通属性--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;ename&quot;</span> <span class="attr">value</span>=<span class="string">&quot;lucy&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;女&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 直接将注入的外部bean的属性赋值，需要该属性有getter方法 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dept.dname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;技术部&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<h5 id="提取集合类型注入"><a href="#提取集合类型注入" class="headerlink" title="提取集合类型注入"></a>提取集合类型注入</h5><ol>
<li>在 spring 配置文件中引入名称空间 util</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span>  </span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:util</span>=<span class="string">&quot;http://www.springframework.org/schema/util&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/util </span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/util/spring-util.xsd&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>把集合注入的配置内容通过util标签独立出来</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 独立出list 集合类型属性注入--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">util:list</span> <span class="attr">id</span>=<span class="string">&quot;bookList&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>易筋经<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>九阴真经<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>九阳神功<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 注入bean使用ref标签 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;ref bean=&quot;beanId&quot;&gt;&lt;/ref&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">util:list</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 通过引入方式注入集合 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;book&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.spring5.collectiontype.Book&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;list&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookList&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="引入外部properties注入"><a href="#引入外部properties注入" class="headerlink" title="引入外部properties注入"></a>引入外部properties注入</h5><ol>
<li><p>准备好数据库连接池依赖，并创建数据库连接池配置文件</p>
<blockquote>
<p>prop.driverClass可以直接写driverClass，只是一般这些名字会存在冲突，因此增加prop.前缀来区分</p>
</blockquote>
</li>
</ol>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">prop.driverClass</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">prop.url</span>=<span class="string">jdbc:mysql://localhost:3306/userDb</span></span><br><span class="line"><span class="meta">prop.userName</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">prop.password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>引入命名空间context，并引入外部文件的路径</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span> </span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> </span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span> </span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:util</span>=<span class="string">&quot;http://www.springframework.org/schema/util&quot;</span> </span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span> </span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">                           http://www.springframework.org/schema/beans/spring-beans.xsd </span></span></span><br><span class="line"><span class="tag"><span class="string">                           http://www.springframework.org/schema/util </span></span></span><br><span class="line"><span class="tag"><span class="string">                           http://www.springframework.org/schema/util/spring-util.xsd </span></span></span><br><span class="line"><span class="tag"><span class="string">                           http://www.springframework.org/schema/context </span></span></span><br><span class="line"><span class="tag"><span class="string">                           http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--引入外部属性文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:jdbc.properties&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置连接池--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;prop.driverClass&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;prop.url&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;prop.userName&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;prop.password&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="p命名空间方式"><a href="#p命名空间方式" class="headerlink" title="p命名空间方式"></a>p命名空间方式</h3><ul>
<li>p即对应property标签。导入p命名空间可以使用一些专属的类property配置属性</li>
<li><strong>导入p命名空间约束</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlns:p=&quot;http://www.springframework.org/schema/p&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>p命名空间的使用实例，其他配置具体对应详情看<a class="link"   target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#spring-core" >官方文档<i class="fas fa-external-link-alt"></i></a></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 传统标签方式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;student1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Student&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Tom&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- p命名空间方式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;student2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Student&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">p:name</span>=<span class="string">&quot;Tom&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">p:address-ref</span>=<span class="string">&quot;addr&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;addr&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Address&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="Bean作用域"><a href="#Bean作用域" class="headerlink" title="Bean作用域"></a>Bean作用域</h1><ul>
<li>在配置bean时，还可以配置bean的作用域</li>
<li>官方提供设置的作用域分为两大类型：<strong>普通JavaBean</strong>(单例、)，<strong>JavaWeb中作用域</strong></li>
</ul>
<table>
<thead>
<tr>
<th align="left"><em>singleton</em></th>
<th align="left"><strong>单例模式</strong>（默认作用域），接无论从容器取<strong>相同id</strong>的bean多少次都是同一个对象</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><em>prototype</em></td>
<td align="left"><strong>原型模式</strong>，<u>每次</u>从容器中获取bean都是一个<u>新的实例</u></td>
</tr>
<tr>
<td align="left"><em>request</em></td>
<td align="left">JavaWeb中请求域</td>
</tr>
<tr>
<td align="left"><em>session</em></td>
<td align="left">JavaWeb中会话域</td>
</tr>
<tr>
<td align="left"><em>application</em></td>
<td align="left">javaWeb中应用域</td>
</tr>
<tr>
<td align="left"><em>websocket</em></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Scope</td>
<td align="left">Description</td>
</tr>
</tbody></table>
<h2 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h2><ul>
<li><strong>单例模式</strong>（默认作用域），接无论从容器取<strong>相同id</strong>的bean多少次都是同一个对象</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.User&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="原型模式"><a href="#原型模式" class="headerlink" title="原型模式"></a><strong>原型模式</strong></h2><ul>
<li><strong>原型模式</strong>，<u>每次</u>从容器中获取bean都是一个<u>新的实例</u></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.User&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;prototype&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="JavaWeb作用域"><a href="#JavaWeb作用域" class="headerlink" title="JavaWeb作用域"></a>JavaWeb作用域</h2><ul>
<li>其余的request、session、application、对应JavaWeb中作用域，只能在web开发中使用    </li>
</ul>
<h1 id="Bean自动装配"><a href="#Bean自动装配" class="headerlink" title="Bean自动装配"></a>Bean自动装配</h1><ul>
<li>注意，一旦使用了自动装配，则<strong>必须要能匹配到装配成功</strong>，否则<strong>会报错</strong></li>
<li>默认是<strong>不允许注入null值</strong>的，注入null值需另外设置，否则也<strong>会报错</strong></li>
</ul>
<h2 id="何为自动装配？"><a href="#何为自动装配？" class="headerlink" title="何为自动装配？"></a>何为自动装配？</h2><h3 id="自动装配"><a href="#自动装配" class="headerlink" title="自动装配"></a>自动装配</h3><ul>
<li>“自动装配”中装配的东西就是依赖注入的东西</li>
<li>在上述依赖注入中，都是手动指明注入的数值或引用，而自动装配是通过软件扫描的方式实现注入内容适配工作</li>
</ul>
<ul>
<li>即Spring会在应用上下文中为某个bean寻找其依赖的bean</li>
</ul>
<h3 id="三种装配机制"><a href="#三种装配机制" class="headerlink" title="三种装配机制"></a>三种装配机制</h3><p>Spring中bean有三种装配机制，分别是：</p>
<ol>
<li>在xml中显式配置；</li>
<li>在java中显式配置；</li>
<li>隐式的bean发现机制和自动装配。</li>
</ol>
<h3 id="自动装配原理"><a href="#自动装配原理" class="headerlink" title="自动装配原理"></a>自动装配原理</h3><p>Spring的自动装配需要从两个角度来实现，或者说是两个操作：</p>
<ol>
<li>组件扫描(component scanning)：spring会自动发现应用上下文中所创建的bean；</li>
<li>自动装配(autowiring)：spring自动满足bean之间的依赖，也就是我们说的IoC/DI；</li>
</ol>
<p>组件扫描和自动装配组合发挥巨大威力，使得显示的配置降低到最少。</p>
<p><strong>推荐不使用自动装配xml配置 , 而使用注解 .</strong></p>
<h2 id="自动装配方式"><a href="#自动装配方式" class="headerlink" title="自动装配方式"></a>自动装配方式</h2><ul>
<li>使用自动装配为bean标签的<strong>autowire</strong>属性赋值，值可取以下四种</li>
</ul>
<table>
<thead>
<tr>
<th align="left">Mode</th>
<th align="left">Explanation</th>
</tr>
</thead>
<tbody><tr>
<td align="left">no</td>
<td align="left">不适用自动装配，<u>默认方式</u></td>
</tr>
<tr>
<td align="left">byName</td>
<td align="left">通过待注入bean对象的setter方法<strong>属性名</strong>匹配Srping上下文中的bean <strong>id</strong></td>
</tr>
<tr>
<td align="left">byType</td>
<td align="left">通过待注入bean对象的<strong>对象类型</strong>匹配Srping上下文中的<strong>bean 类型</strong><br><strong>使用前提</strong>是上下文中<u>不能存在重复相同类型的bean</u>，否则编译时期报错</td>
</tr>
<tr>
<td align="left">constructor</td>
<td align="left"></td>
</tr>
</tbody></table>
<h3 id="byName"><a href="#byName" class="headerlink" title="byName"></a>byName</h3><ul>
<li>通过待注入bean对象的setter方法<strong>属性名</strong>匹配Srping上下文中的bean <strong>id</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 待注入bean --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mouth&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Mouth&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;eye&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Eye&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 手动装配 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;person1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Person&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;eye&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;eye&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mouth&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;mouth&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 自动装配之byName方式 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--  setEye()的eye匹配id=eye 与 setMouth的mouth匹配id=mouth --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;person2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Person&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byName&quot;</span>/&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="byType"><a href="#byType" class="headerlink" title="byType"></a>byType</h3><ul>
<li>通过待注入bean对象的<strong>对象类型</strong>匹配Srping上下文中的<strong>bean 类型</strong></li>
<li><strong>使用前提</strong>是上下文中<u>不能存在重复相同类型的bean</u>，否则编译时期报错</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 待注入bean,id都不需要写 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Mouth&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Eye&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 自动装配之byName方式 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--  通过匹配待注入bean对象的setter属性类型进行自动装配 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Person&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byType&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="constructor-NaN"><a href="#constructor-NaN" class="headerlink" title="constructor"></a>constructor</h3><h3 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h3><ul>
<li>byName模式：需保证所有bean的<strong>id唯一</strong>，且bean需要和自动注入的属性的<strong>set方法的属性名</strong>值一致！</li>
<li>byType模式：需保证所有bean的<strong>class唯一</strong>，并且这个bean需要和自动注入的<strong>属性的类型</strong>一致！</li>
</ul>
<h2 id="注解自动装配"><a href="#注解自动装配" class="headerlink" title="注解自动装配"></a>注解自动装配</h2><ul>
<li>jdk1.5、Spring2.5开始支持注解</li>
<li><u>从Spring4规定，使用注解的自动装配也要导入AOP的jar包</u></li>
<li>最常用为@Autowired注解</li>
</ul>
<h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><ul>
<li><p><strong>导入context命名空间</strong></p>
<ul>
<li>xmlns:context属性</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br></pre></td></tr></table></figure>
<ul>
<li>xsi:schemaLocation</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xsi:schemaLocation=&quot;http://www.springframework.org/schema/context</span><br><span class="line">        https://www.springframework.org/schema/context/spring-context.xsd&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>导入配置注解的支持</strong></p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<p><strong>完整注解约束支持xml配置，如下</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Autowired"><a href="#Autowired" class="headerlink" title="@Autowired"></a>@Autowired</h3><h4 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h4><ul>
<li>将需要依赖注入且采用自动装配的<strong>属性上</strong>添加**@Autowired**注解实现自动装配</li>
<li>使用@Autowired注解后<strong>不需要setter方法</strong></li>
<li>@Autowired是按<u><strong>类型自动装配</strong>（byType）实现</u>，不支持id匹配</li>
<li>某些IDE，如IDEA可以在编译时期检测到被声明@Autowired注解的属性是否能被自动匹配到</li>
</ul>
<hr>
<ul>
<li>xml配置</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 待注入bean --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Mouth&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Eye&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Person&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>待注入类设置</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Eye eye;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Mouth mouth;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="required属性"><a href="#required属性" class="headerlink" title="required属性"></a>required属性</h4><ul>
<li>@Autowired注解含required属性，默认为true，<strong>设置为false</strong>时表示可以<strong>允许null值注入</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//如果允许对象为null，设置required = false,默认为true</span></span><br><span class="line"><span class="meta">@Autowired(required = false)</span></span><br><span class="line"><span class="keyword">private</span> Eye eye;</span><br></pre></td></tr></table></figure>

<h4 id="Qualifier"><a href="#Qualifier" class="headerlink" title="@Qualifier"></a>@Qualifier</h4><ul>
<li>若配置环境比较复杂，可以<strong>在@Autowired基础上<u>追加</u>@Qualifier注解</strong></li>
<li>@Qualifier<code>[ˈkwɒlɪfaɪə(r)]</code>，表“限定”，显式指定<strong>属性value</strong>为注入的<strong>bean的id</strong></li>
</ul>
<hr>
<ul>
<li>xml配置</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 注入的bean --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mouth1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Mouth&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mouth2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Mouth&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Eye&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 待注入bean --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Person&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>待注入类配置</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Eye eye;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(value=&quot;mouth2&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Mouth mouth;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Resource"><a href="#Resource" class="headerlink" title="@Resource"></a>@Resource</h3><ul>
<li>先进行byName查找匹配（需配合name属性使用），在进行byType查找匹配</li>
<li>当@Resource都不能唯一匹配到bean时，可以通过name属性显式指定bean id</li>
</ul>
<hr>
<ul>
<li><strong>xml配置</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 注入的bean --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mouth1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Mouth&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mouth2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Mouth&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Eye&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 待注入bean --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.bean.Person&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>待注入类配置</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> Eye eye;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource(name = &quot;mouth1&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Mouth mouth;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Nullable"><a href="#Nullable" class="headerlink" title="@Nullable"></a>@Nullable</h3><ul>
<li>可以显式修饰到属性中，表示注入时可允许为null值，效果等价于<code>@Autowired(required = false)</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="keyword">private</span> Eye eye;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(<span class="meta">@Nullable</span> String name)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="IoC注解开发"><a href="#IoC注解开发" class="headerlink" title="IoC注解开发"></a>IoC注解开发</h1><ul>
<li>如今实际开发中更多是<strong>完全使用注解方式来进行依赖注入</strong>。配置文件只用于<u>配置核心系统参数</u></li>
<li>从Spring4规定，使用注解的自动装配也要<strong>导入AOP的jar包</strong></li>
</ul>
<h2 id="指定组件扫描"><a href="#指定组件扫描" class="headerlink" title="指定组件扫描"></a>指定组件扫描</h2><ul>
<li>不设置组件扫描，默认是扫描所有的java源文件是否含Spring注解</li>
<li>通过<code>context:component-scan</code>可以指定扫描Spring注解的包的范围</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 指定扫描Spring组件(注解)的包的范围，此时Spring不再全局扫描 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 如果扫描多个包，多个包使用逗号隔开 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.company.pojo&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="指定组件类型扫描"><a href="#指定组件类型扫描" class="headerlink" title="指定组件类型扫描"></a>指定组件类型扫描</h3><ul>
<li>context:<strong>include</strong>-filter</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--示例 1</span></span><br><span class="line"><span class="comment"> &quot;use-default-filters=&quot;false&quot; 表示现在不使用默认 filter，自己配置 filter</span></span><br><span class="line"><span class="comment"> context:include-filter ，设置扫描哪些内容，其中type=&quot;annotation&quot;表示对注解进行过滤</span></span><br><span class="line"><span class="comment"> 	expression表达式定义扫描的注解类Controller，只扫描表示@Controller的注解</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 总的效果：只扫描com.company包下所有@Controller注解的bean --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.company&quot;</span> <span class="attr">use-default-filters</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="指定组件类型不扫描"><a href="#指定组件类型不扫描" class="headerlink" title="指定组件类型不扫描"></a>指定组件类型不扫描</h3><ul>
<li>context:<strong>exclude</strong>-filter</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--示例 2</span></span><br><span class="line"><span class="comment">  context:exclude-filter： 设置哪些内容不进行扫描</span></span><br><span class="line"><span class="comment">  总的效果：不扫描com.company包下所有@Controller注解的bean</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.company&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>注</strong>：使用指定组件类型<strong>不扫描</strong>(<code>&lt;context:exclude-filter</code>)时，<strong>无需</strong><code>use-default-filters=&quot;false</code>设置</p>
<h2 id="Bean的创建"><a href="#Bean的创建" class="headerlink" title="Bean的创建"></a>Bean的创建</h2><ul>
<li>通过<code>@Component</code>注解的方式实现Bean的创建，被该注解标识的Bean又称为<strong>组件</strong></li>
</ul>
<h3 id="默认方式"><a href="#默认方式" class="headerlink" title="默认方式"></a>默认方式</h3><ul>
<li>将JavaBean添加<code>@Component</code>注解设置为Spring组件</li>
<li>此时默认创建<strong>一个</strong>以<u>类名的首字母小写</u>的bean对象，即bean id  = “<strong>user</strong>“</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//等价于xml配置中的 &lt;bean id=&quot;user&quot; class=&quot;com.company.pojo.User&quot;/&gt; </span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>从容器中取出Bean实例</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">    User user = context.getBean(<span class="string">&quot;user&quot;</span>, User.class);</span><br><span class="line">    System.out.println(user);<span class="comment">//com.company.pojo.User@60611244</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="指定Bean-Id方式"><a href="#指定Bean-Id方式" class="headerlink" title="指定Bean Id方式"></a>指定Bean Id方式</h3><ul>
<li>通过指明组件注解的value属性自定义bean id，<code>@Component(value = &quot;BeanId&quot;)</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(value = &quot;userDef&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>从容器中取出Bean实例</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">    User user = context.getBean(<span class="string">&quot;userDef&quot;</span>, User.class);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="衍生注解"><a href="#衍生注解" class="headerlink" title="衍生注解"></a>衍生注解</h3><ul>
<li>与<code>@Component</code>注解一样，下述3个注解都是声明为Spring组件，只是名字不一样，便于识别分层</li>
</ul>
<table>
<thead>
<tr>
<th>MVC</th>
<th>等价@Component注解</th>
</tr>
</thead>
<tbody><tr>
<td>dao</td>
<td>@Repository</td>
</tr>
<tr>
<td>service</td>
<td>@Service</td>
</tr>
<tr>
<td>controller</td>
<td>@Controller</td>
</tr>
</tbody></table>
<h2 id="依赖注入-2"><a href="#依赖注入-2" class="headerlink" title="依赖注入"></a>依赖注入</h2><ul>
<li>在需要注入的<strong>属性</strong>或<strong>setter</strong>方法上使用<code>@Value</code>注解</li>
<li>复杂的注入<code>@Value</code>注解不能胜任时需使用xml注解</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(value = &quot;userDef&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//等价于 &lt;property name=&quot;name&quot; value=&quot;Tom&quot;/&gt;</span></span><br><span class="line">    <span class="meta">@Value(&quot;Tom&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="自动装配-1"><a href="#自动装配-1" class="headerlink" title="自动装配"></a>自动装配</h2><p>详情请看讲解Bean自动装配中含注解使用自动装配</p>
<ul>
<li><code>@Autowired</code></li>
<li><code>@Resource</code></li>
<li><code>@Nullable</code></li>
</ul>
<h2 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h2><ul>
<li>使用<code>@Scope</code>注解配置Bean的作用域</li>
</ul>
<table>
<thead>
<tr>
<th align="left"><em>singleton</em></th>
<th align="left"><strong>单例模式</strong>（默认作用域），接无论从容器取<strong>相同id</strong>的bean多少次都是同一个对象</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><em>prototype</em></td>
<td align="left"><strong>原型模式</strong>，<u>每次</u>从容器中获取bean都是一个<u>新的实例</u></td>
</tr>
<tr>
<td align="left"><em>request</em></td>
<td align="left">JavaWeb中请求域</td>
</tr>
<tr>
<td align="left"><em>session</em></td>
<td align="left">JavaWeb中会话域</td>
</tr>
<tr>
<td align="left"><em>application</em></td>
<td align="left">javaWeb中应用域</td>
</tr>
<tr>
<td align="left"><em>websocket</em></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Scope</td>
<td align="left">Description</td>
</tr>
</tbody></table>
<ul>
<li>示例代码</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(value = &quot;userDef&quot;)</span></span><br><span class="line"><span class="meta">@Scope(&quot;singleton&quot;)</span> <span class="comment">//单例模式</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;Tom&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="IoC全Java类配置"><a href="#IoC全Java类配置" class="headerlink" title="IoC全Java类配置"></a>IoC全Java类配置</h1><ul>
<li>JavaConfig 原来是 Spring 的一个子项目，它通过 Java 类的方式提供 Bean 的定义信息</li>
<li>在 Spring4 的版本， JavaConfig 已正式成为 Spring4 的核心功能 </li>
</ul>
<h2 id="Java替代XML"><a href="#Java替代XML" class="headerlink" title="Java替代XML"></a>Java替代XML</h2><ul>
<li>通过<code>@Configuration</code>注解修饰一个Java类，使其称为Spring配置类，<strong>等价于applicationContext.xml</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>	<span class="comment">//等价整个xml文件</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span>	<span class="comment">//等价xml文件中的&lt;bean&gt;标签配置，方法名为bean id</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>从注解配置AnnotationConfigApplicationContext中取出Spring上下文对象<ul>
<li><strong>Class类形参</strong>：直接传入配置文件的Class对象</li>
<li><strong>String包类名</strong>：可以传入包名，如”com.company.config”</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ApplicationContext context = <span class="keyword">new</span> AnnotationConfigApplicationContext(<span class="string">&quot;com.company.config&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    User user = context.getBean(<span class="string">&quot;getUser&quot;</span>, User.class);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Configuration"><a href="#Configuration" class="headerlink" title="@Configuration"></a>@Configuration</h3><ul>
<li><p>被<code>@Configuration</code>修饰的类成为了一个applicationContent.xml文件，类名等价与文件名</p>
</li>
<li><p><code>@Configuration</code>注解的本质也是<code>@Component</code>Spring组件</p>
</li>
<li><p>XML中等价的其他注解</p>
<ul>
<li>XML文件中ComponentScan属性也有等价的<code>@ComponentScan</code>注解使用</li>
<li>Impot标签也有等价的<code>@Import</code>注解，以此类推….</li>
</ul>
</li>
</ul>
<h3 id="Bean"><a href="#Bean" class="headerlink" title="@Bean"></a>@Bean</h3><ul>
<li>等价与xml文件中的bean标签</li>
<li>方法名等价于bean标签的id属性</li>
<li>方法返回值类型等价于bean标签的class属性</li>
<li>方法返回值等价于需要注入的对象</li>
</ul>
<h1 id="Bean的生命周期"><a href="#Bean的生命周期" class="headerlink" title="Bean的生命周期"></a>Bean的生命周期</h1><h2 id="常规生命周期"><a href="#常规生命周期" class="headerlink" title="常规生命周期"></a>常规生命周期</h2><h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><ol>
<li>通过构造器创建 bean 实例（无参数构造）</li>
<li>为 bean 的属性设置值和对其他 bean 引用（调用 set 方法） </li>
<li>调用 bean 的初始化的方法（需要进行配置初始化的方法，<code>initMethod</code>）</li>
<li>bean的使用（对象获取到了） </li>
<li>当容器关闭时（调用<code>context.close()</code>），调用bean的销毁的方法（需配置销毁方法<code>destroy-method</code>）</li>
</ol>
<h3 id="演示代码"><a href="#演示代码" class="headerlink" title="演示代码"></a>演示代码</h3><ul>
<li>生命周期测试代码</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Orders</span> </span>&#123;</span><br><span class="line">    <span class="comment">//无参数构造</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Orders</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;第一步 执行无参数构造创建 bean 实例&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> String oname;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOname</span><span class="params">(String oname)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.oname = oname;</span><br><span class="line">        System.out.println(<span class="string">&quot;第二步 调用 set 方法设置属性值&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建执行的初始化的方法，需xml配置</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;第三步 执行初始化的方法&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建执行的销毁的方法，需xml配置且调用close方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroyMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;第五步 执行销毁的方法&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>配置bean，并且配置初始化方法<code>init-method</code>和销毁方法<code>destroy-method</code></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orders&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.spring5.bean.Orders&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;initMethod&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;destroyMethod&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;oname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;手机&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>测试bena 的生命周期，手动关闭IoC容器触发销毁方法的调用</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testBean3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//close()方法属于实现类定义的方法，不能用ApplicationContext接口接收</span></span><br><span class="line">    ClassPathXmlApplicationContext context =</span><br><span class="line">        <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean4.xml&quot;</span>);</span><br><span class="line">    Orders orders = context.getBean(<span class="string">&quot;orders&quot;</span>, Orders.class);</span><br><span class="line">    </span><br><span class="line">    System.out.println(<span class="string">&quot;第四步 获取创建 bean 实例对象&quot;</span>);</span><br><span class="line">    System.out.println(orders);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//手动让 bean 实例销毁</span></span><br><span class="line">    context.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="添加后置处理器"><a href="#添加后置处理器" class="headerlink" title="添加后置处理器"></a>添加后置处理器</h2><ul>
<li>在常规的bean什么周期中，还有更完整的生命周期，即添加后置管理器</li>
<li>后置处理器会作用在<strong>所有配置的bean</strong>的<u>初始化方法的</u><strong>前后</strong></li>
</ul>
<h3 id="生命周期-1"><a href="#生命周期-1" class="headerlink" title="生命周期"></a>生命周期</h3><ol>
<li>通过构造器创建 bean 实例（无参数构造）</li>
<li>为 bean 的属性设置值和对其他 bean 引用（调用 set 方法） </li>
<li><strong>把 bean 实例传递 bean 后置处理器的方法 postProcessBeforeInitialization</strong>  </li>
<li>调用 bean 的初始化的方法（需要进行配置初始化的方法） </li>
<li><strong>把 bean 实例传递 bean 后置处理器的方法 postProcessAfterInitialization</strong> </li>
<li>bean 可以使用了（对象获取到了）</li>
<li>当容器关闭时候，调用 bean 的销毁的方法（需要进行配置销毁的方法）</li>
</ol>
<h3 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h3><ul>
<li>创建类，实现接口BeanPostProcessor，创建后置处理器</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBeanPost</span> <span class="keyword">implements</span> <span class="title">BeanPostProcessor</span> </span>&#123;</span><br><span class="line">    <span class="comment">//修改了@Nullabledefault修饰</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> </span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;在初始化之前执行的方法&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">postProcessAfterInitialization</span><span class="params">(Object bean, String beanName)</span> </span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;在初始化之后执行的方法&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>只要在IoC容器中创建了后置处理器，就会自动作用在IoC的所有bean中</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置后置处理器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myBeanPost&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.spring5.bean.MyBeanPost&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>重新测试上述常规生命周期测试代码即可看出后置处理器的调用</li>
</ul>
<h1 id="FactoryBean"><a href="#FactoryBean" class="headerlink" title="FactoryBean"></a>FactoryBean</h1><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p>Spring 有两种类型 bean，一种普通 bean，另外一种工厂 bean（FactoryBean）</p>
<ul>
<li><p>普通 bean：在配置文件中定义 bean 类型就是返回类型</p>
</li>
<li><p>工厂 bean：就相当于配置了一个工厂类，和工厂模式一致，用工厂创建指定类</p>
</li>
</ul>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><ol>
<li>创建类工厂类，实现接口**FactoryBean&lt;工厂返回类型&gt;**，及其抽象方法</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBean</span> <span class="keyword">implements</span> <span class="title">FactoryBean</span>&lt;<span class="title">Course</span>&gt; </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//返回工厂的生产对象的类型</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Course <span class="title">getObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Course course = <span class="keyword">new</span> Course();</span><br><span class="line">        course.setCname(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> course;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//定义对象类型</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//定义是否单例</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSingleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>实例化工厂bean，从工厂中获取指定生成对象</li>
</ol>
<ul>
<li>XML</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.spring5.factorybean.MyBean&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ApplicationContext context =</span><br><span class="line">        <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean3.xml&quot;</span>);</span><br><span class="line">    Course course = context.getBean(<span class="string">&quot;myBean&quot;</span>, Course.class);</span><br><span class="line">    System.out.println(course);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="AOP理论"><a href="#AOP理论" class="headerlink" title="AOP理论"></a>AOP理论</h1><h2 id="AOP原理"><a href="#AOP原理" class="headerlink" title="AOP原理"></a>AOP原理</h2><ul>
<li>AOP的原理实际上就是动态代理，因此了解AOP的前提是掌握代理模式。</li>
</ul>
<h2 id="代理模式概述"><a href="#代理模式概述" class="headerlink" title="代理模式概述"></a>代理模式概述</h2><h3 id="静态代理"><a href="#静态代理" class="headerlink" title="静态代理"></a>静态代理</h3><p>**(静态)代理的好处:**（尤其注意2、3点，可以说AOP本质就是代理模式的大规模应用）</p>
<ul>
<li>代理模式真正的好处在于，如果需要在原有的业务上增加一些公共的操作</li>
<li>可以实现<strong>不在原有代码</strong>上进行修改，而是<u>通过代理角色</u><strong>间接地实现实现代码的增改</strong><ul>
<li>其实这就就是AOP原理，在不修改源代码情况下，进行功能添加和增加。</li>
</ul>
</li>
<li>使其原有业务<strong>更加纯粹</strong>(维护了单一职责原则)，不会因为需要增加一些公共操作而影响到业务的本质内容</li>
<li>公共业务发生扩展时变得更加集中和方便 </li>
</ul>
<p><strong>缺点</strong> :</p>
<ul>
<li>静态代理由于每个被代理类都配一个代理类 ,<strong>代码量翻倍</strong>，工作量变大了，开发效率降低 </li>
<li>动态代理即有代理的好处，又可以动态生成代理类，解决了代码量翻倍的问题，而且减少代码冗余</li>
</ul>
<h3 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h3><h4 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h4><ul>
<li>动态代理中，“动态”的关键是指<u>动态创建实现代理接口的代理类</u>（动态创建代理类）</li>
<li>这个过程在JDK层面是<u>无法</u>让用户<strong>实现</strong>的<ul>
<li>因为要创建一个不存在的类</li>
<li>且这个类要去主动实现一个未知的由用户指定的接口（代理接口）</li>
</ul>
</li>
<li>因此这需要更底层的操作才能实现这个功能，因此动态代理的<strong>使用</strong>是由JDK提供的，而不是用户实现的</li>
</ul>
<h4 id="实现方式"><a href="#实现方式" class="headerlink" title="实现方式"></a>实现方式</h4><ul>
<li><strong>基于接口实现</strong>：jdk提供原生动态代理实现（Proxy、InvocationHandler）<ul>
<li>代理类作为实现类去实现代理接口进行功能增加</li>
</ul>
</li>
<li><strong>基于类实现</strong>：CGLIB<ul>
<li>代理类作为被代理类的子类，在重写方法中调用父类（被代理类）方法基础上进行方法的增强</li>
</ul>
</li>
<li><strong>基于Java字节码实现</strong>：Javasist（基于JBoss服务器实现）</li>
</ul>
<h3 id="jdk实现动态代理"><a href="#jdk实现动态代理" class="headerlink" title="jdk实现动态代理"></a>jdk实现动态代理</h3><h4 id="动态性分析"><a href="#动态性分析" class="headerlink" title="动态性分析"></a>动态性分析</h4><ul>
<li><p>静态代理存在的代码冗余</p>
<ul>
<li>冗余1：总要传入被代理类对象去代理实现调用接口同名的所有抽象方法</li>
<li>冗余2：从总的代理类的结构来说，每个代理接口都需要创建所属的代理类，单这些代理类结构都类似</li>
</ul>
</li>
<li><p>即对应需解决两个问题为</p>
<ul>
<li>冗余2：如何动态创建代理类，并实现对应的接口？—— 用户无法实现，由jdk底层提供实现 <strong>Proxy</strong></li>
<li>冗余1：如何让动态创建的代理类在调用代理接口方法时候自动调用同名方法 —— <strong>Proxy + InvocationHandler</strong></li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.compeny.dynamic_proxy.proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 代理类统一动态生成工厂</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yhd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2021-07-30 22:34</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 返回被代理对象的代理类对象</span></span><br><span class="line"><span class="comment">     *  - 从静态代理可知，代理类需已知两大因素，代理接口和代理类对象（用于代理方法的实现）</span></span><br><span class="line"><span class="comment">     *  - 由于通过反射可以从代理类对象中获得代理类实现的代理接口，因此形参至少需要被代理类对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> obj 被代理类对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getProxyInstance</span><span class="params">(Object obj)</span></span>&#123;</span><br><span class="line">        <span class="comment">//我们无法实现，只能通过jdk调用底层实现</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 形参：</span></span><br><span class="line"><span class="comment">         *  1、返回的代理类对象使用的类加载器：一般设为与被代理类对象的加载器一致</span></span><br><span class="line"><span class="comment">         *  2、代理接口的Class对象数组：一般通过被代理类对象的反射操作获取其实现的接口Class实例</span></span><br><span class="line"><span class="comment">         *  3、InvocationHandler接口实例：有别于1、2两点的硬需求。这是一个额外的回调设计</span></span><br><span class="line"><span class="comment">         *      当通过代理类对象调用被代理类的任何方法时，都会调用InvocationHandler接口的</span></span><br><span class="line"><span class="comment">         *      抽象方法invoke。并提供三个传入形参</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(obj.getClass().getClassLoader(),</span><br><span class="line">                obj.getClass().getInterfaces(),<span class="keyword">new</span> MyInvocationHandler(obj));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyInvocationHandler</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//被代理类对象，由于代理类使用反射调用方法时需要传入被调用的对象</span></span><br><span class="line">    <span class="keyword">private</span> Object obj;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyInvocationHandler</span><span class="params">(Object obj)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.obj = obj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 代理方法调用的统一回调方法</span></span><br><span class="line"><span class="comment">     * 通过InvocationHandler接口的invoke方法进一步缩减了代码，即讲所有被代理方法都统一在一个</span></span><br><span class="line"><span class="comment">     * 方法体中，由于代理一般都是代理所有接口方法，因此采取了这种设计，进一步缩减代码量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> proxy ：代理类对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> method ：代理类被调用的代理方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args ： 代理类被调用的代理方法的形参</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 被代理类对象调用方法的返回值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Throwable</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.print(<span class="string">&quot;日志开始----- : &quot;</span>);</span><br><span class="line">        <span class="comment">//在代理类的环境下通过反射调用被代理类的方法，此时写成直接调用对应的方法。</span></span><br><span class="line">        <span class="comment">//也可以让用户通过对Method对象进行判别进行自定义的反射调用</span></span><br><span class="line">        Object result = method.invoke(obj,args);</span><br><span class="line">        System.out.print(<span class="string">&quot;日志结束----- : &quot;</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>测试代码，最终效果是代码中至始至终没有出现过代理类，是动态创建的</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//任何一个想被代理的对象都可以通过ProxyFactory获取到自己的代理类，实现代理操作</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DynamicProxyTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ProductDao proxyProductDao = (ProductDao) ProxyFactory.getProxyInstance(<span class="keyword">new</span> ProductMysqlImpl());</span><br><span class="line">        proxyProductDao.get();</span><br><span class="line">        proxyProductDao.update();</span><br><span class="line"></span><br><span class="line">        UserDao proxyUserDao = (UserDao) ProxyFactory.getProxyInstance(<span class="keyword">new</span> UserDaoOracleImpl());</span><br><span class="line">        proxyUserDao.add();</span><br><span class="line">        proxyUserDao.update();</span><br><span class="line">        proxyUserDao.delete();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Spring实现AOP"><a href="#Spring实现AOP" class="headerlink" title="Spring实现AOP"></a>Spring实现AOP</h1><h2 id="AOP概述"><a href="#AOP概述" class="headerlink" title="AOP概述"></a>AOP概述</h2><h3 id="基本概念-1"><a href="#基本概念-1" class="headerlink" title="基本概念"></a>基本概念</h3><ul>
<li><em>AOP</em>（Aspect Oriented Programming）意为：面向切面编程</li>
<li>通过预编译方式和运行期动态代理实现程序功能的统一维护的一种技术。</li>
<li>AOP是OOP的延续，是软件开发中的一个热点，也是Spring框架中的一个重要内容，是函数式编程的一种衍生范型。</li>
<li>利用AOP可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高了开发的效率。</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B%E7%A4%BA%E6%84%8F%E5%9B%BE01.png"
                     
                ></p>
<h3 id="AspectJ"><a href="#AspectJ" class="headerlink" title="AspectJ"></a>AspectJ</h3><ul>
<li>Spring框架一般基于AspectJ实现AOP操作</li>
<li>AspectJ不是Spring组成部分，是一个独立与Spring的AOP框架</li>
</ul>
<h3 id="专业术语"><a href="#专业术语" class="headerlink" title="专业术语"></a>专业术语</h3><h4 id="横切关注点"><a href="#横切关注点" class="headerlink" title="横切关注点"></a>横切关注点</h4><p><strong>横切关注点</strong>（cross-cutting concern）：</p>
<ul>
<li>跨越应用程序多个模块的方法或功能。</li>
<li>即与业务逻辑无关的，但需要关注的部分，就是横切关注点。如日志 , 安全 , 缓存 , 事务等等 ….</li>
</ul>
<blockquote>
<p>把这些横切关注点与业务逻辑相分离正是AOP所要解决的问题</p>
</blockquote>
<h4 id="切面"><a href="#切面" class="headerlink" title="切面"></a>切面</h4><ul>
<li><strong>切面</strong>（Aspect）：横切关注点被模块化为的特殊的类，这些类称为切面。<u>通知和切点共同定义了切面的全部内容</u>——它是什么，在何时何处完成其功能</li>
</ul>
<blockquote>
<p>可以说，横切关注点就是每一个公共业务（日志、安全…）。而切面就是这些公共业务抽取出来(AOP)的模块化的抽象描述。通知和切点就是代码层面对切面的实现</p>
</blockquote>
<h5 id="通知"><a href="#通知" class="headerlink" title="通知"></a>通知</h5><ul>
<li><strong>通知/增强</strong>（Advice）：切面完成的工作内容及其工作时间。是类中的一个方法。（实际增加的逻辑）</li>
</ul>
<table>
<thead>
<tr>
<th>通知类型</th>
<th>描述</th>
<th>Spring 接口</th>
</tr>
</thead>
<tbody><tr>
<td><strong>前置通知</strong></td>
<td>在目标方法被调用前执行。常用于权限管理</td>
<td>MethodBeforeAdvice</td>
</tr>
<tr>
<td><strong>后置通知</strong></td>
<td>在目标方法完成后执行。常用于关闭流、上传、删除临时文件</td>
<td>MethodAfterAdvice</td>
</tr>
<tr>
<td><strong>返回通知</strong></td>
<td>在目标方法完成后执行，且可获得返回值。常用于</td>
<td>AfterReturningAdvice</td>
</tr>
<tr>
<td><strong>环绕通知</strong></td>
<td>包裹被目标方法，在目标方法调用前后执行。常用于日志、事务</td>
<td>Around</td>
</tr>
<tr>
<td><strong>异常通知</strong></td>
<td>在目标方法抛出指定异常后执行。常用于异常记录日志</td>
<td>AfterThrowing</td>
</tr>
</tbody></table>
<h5 id="切点"><a href="#切点" class="headerlink" title="切点"></a>切点</h5><ul>
<li><strong>切点</strong>（Pointcut）：通知所执行的位置，即切点定义了所要织入的一个或多个连接点</li>
</ul>
<h4 id="连接点"><a href="#连接点" class="headerlink" title="连接点"></a>连接点</h4><ul>
<li><strong>连接点</strong>（JointPoint）：与切点匹配的执行点，即待增强的原有方法体</li>
</ul>
<h4 id="织入"><a href="#织入" class="headerlink" title="织入"></a>织入</h4><p><strong>织入</strong>（Weaving）：</p>
<ul>
<li><p>把切面应用到目标对象并创建新得代理对象得过程</p>
</li>
<li><p>在目标对象的生命周期力有多个点可以进行织入</p>
<ul>
<li><strong>编译期</strong>：切面在目标类编译时被织入，需要特殊的编译器（AspectJ）</li>
<li><strong>类加载期</strong>：切面在目标类加载到JVM时被织入，需特殊的类加载器。它可以在目标类被引入应用之前增强该目标类的字节码。AspectJ 5的加载时织入（load-time weaving，LTW）就支持这种方式织入</li>
<li><strong>运行期</strong>：切面在应用允许的某个时刻被织入，在织入切面时，AOP容器会为目标对象动态地创建一个代理对象。Spring AOP就是以这种方式织入切面的。</li>
</ul>
</li>
</ul>
<blockquote>
<p>《Spring实战》第四版</p>
</blockquote>
<h4 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h4><p>​    引入允许我们向现有的类添加新方法或属性。例如，我们可以创建一个Auditable通知类，该类记录了对象最后一次修改时的状态。这很简单，只需一个方法，setLastModified（Date），和一个实例变量来保存这个状态。然后，这个新方法和实例变量就可以被引入到现有的类中，从而可以在无需修改这些现有的类的情况下，让它们具有新的行为和状态。</p>
<blockquote>
<p>了解-《Spring实战》第四版</p>
</blockquote>
<h4 id="核心小结"><a href="#核心小结" class="headerlink" title="核心小结"></a>核心小结</h4><ul>
<li><strong>横切关注点</strong>：跨越应用程序多个模块的公共方法或功能概述，如日志、安全、缓存、事务等</li>
<li><strong>切面</strong>：切面是横切关注点的抽象实现，表现为一个类，主要由通知和切点两部分构成<ul>
<li><strong>通知</strong>：包含了需要用于多个应用对象的横切行为（行为内容于行为时机），表现为实际增强的内容</li>
<li><strong>切点</strong>：定义了通知被应用的具体位置（在哪些连接点）、即哪些连接点会得到通知，表现为一些匹配连接点的表达式</li>
</ul>
</li>
<li><strong>连接点</strong>：程序执行过程中能够应用通知的所有点，表现为待被增强的内容</li>
</ul>
<h2 id="切点表达式"><a href="#切点表达式" class="headerlink" title="切点表达式"></a>切点表达式</h2><h3 id="基本概念-2"><a href="#基本概念-2" class="headerlink" title="基本概念"></a>基本概念</h3><ul>
<li>定义切点时，通过切点表达式去匹配一个或多个连接点(<strong>方法</strong>)进行切入</li>
<li>简而言之，即用与匹配待增强方法的表达式</li>
</ul>
<h3 id="语法结构"><a href="#语法结构" class="headerlink" title="语法结构"></a>语法结构</h3><p><strong>语法结构</strong>：<code>execution([权限修饰符][返回类型][类全路径].[方法名称]([参数列表]))</code></p>
<ul>
<li><strong>权限修饰符</strong>：public、protected、default、private</li>
<li><strong>返回类型</strong>：</li>
<li><strong>类全路径</strong>：</li>
<li><strong>参数列表</strong>：用于定位重载方法，若只有一个方法时，可以使用两个点<code>(..)</code>表示任意的参数列表</li>
<li>‘*’：表示上述4种类型的任意值</li>
<li>‘ ‘：空格，表示忽略不写</li>
</ul>
<blockquote>
<p>注意表达式之间本身没有空格相隔，若填入空格也算占位，表示忽略不写</p>
</blockquote>
<h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><ul>
<li><strong>举例 1</strong>：<ul>
<li>问：对 com.company.dao.BookDao 类中的 add方法 进行增强 </li>
<li>答：<code>execution(* com.company.dao.BookDao.add(..))</code></li>
</ul>
</li>
<li><strong>举例 2</strong>：<ul>
<li>问：对 com.company.dao.BookDao 类里面的所有的方法进行增强</li>
<li>答：<code>execution(* com.company.dao.BookDao.*(..))</code></li>
</ul>
</li>
<li><strong>举例 3</strong>：<ul>
<li>问：对 com.company.dao 包里面所有类，类里面所有方法进行增强 </li>
<li>答：<code>execution(* com.company.dao.*.*(..))</code></li>
</ul>
</li>
</ul>
<h3 id="表达式重用"><a href="#表达式重用" class="headerlink" title="表达式重用"></a>表达式重用</h3><ul>
<li>在使用注解完成AOP操作时，可以通过调用一个空方法实现切点表达式的重用</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//相同切入点抽取</span></span><br><span class="line"><span class="meta">@Pointcut(value = &quot;execution(* com.company.spring5.aopanno.User.add(..))&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pointDemo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//直接调用空方法实现切点表达式的重用</span></span><br><span class="line"><span class="meta">@Before(value = &quot;pointDemo()&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;before.........&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="导入织入依赖"><a href="#导入织入依赖" class="headerlink" title="导入织入依赖"></a>导入织入依赖</h2><p>在Spring中使用AOP时需在Spring核心jar包基础上再导入AOP的织入依赖包</p>
<ul>
<li><strong>spring aspects</strong><ul>
<li>spring-aspects-5.3.9.jar</li>
<li>aspects其他依赖<ul>
<li>com.springsource.net.sf.cglib-2.2.0.jar</li>
<li>com.springsource.org.aopalliance-1.0.0</li>
<li>com.springsource.org.aspectj.weaver-1.6.8.RELEASE</li>
</ul>
</li>
</ul>
</li>
<li><strong>maven</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-aspects --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="接口通知方式"><a href="#接口通知方式" class="headerlink" title="接口通知方式"></a>接口通知方式</h2><ul>
<li>接口方式实现需要被增强类的方法有对应的代理接口</li>
<li>这种方式称不上最好，但由于贴近动态代理，因此先讲解。</li>
</ul>
<h3 id="XML命名空间"><a href="#XML命名空间" class="headerlink" title="XML命名空间"></a>XML命名空间</h3><ul>
<li>在Spring命令空间基础上添加</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>通用命名空间结构：变动部分<code>[?]</code></p>
<ul>
<li>首句添加：<code>xmlns:[?]=&quot;http://www.springframework.org/schema/[?]&quot;</code>，添加在<code>xmlns:xsi</code>下</li>
<li>尾句添加：<code>xsi:schemaLocation=&quot;http://www.springframework.org/schema/[?] https://www.springframework.org/schema/[?]/spring-[?].xsd&quot;</code></li>
</ul>
</blockquote>
<ul>
<li>添加aop命名空间XML</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="实现切面-通知"><a href="#实现切面-通知" class="headerlink" title="实现切面(通知)"></a>实现切面(通知)</h3><p>假如需要通过AOP添加一个特殊指定的日志功能，执行前打印执行方法，执行后打印返回值</p>
<h4 id="准备代理接口"><a href="#准备代理接口" class="headerlink" title="准备代理接口"></a>准备代理接口</h4><ul>
<li>通过接口实现AOP的方式，必须有对应的代理接口</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="编写通知"><a href="#编写通知" class="headerlink" title="编写通知"></a>编写通知</h4><ul>
<li>选用合适的切入时机通知接口（AfterReturningAdvice）实现，并编写横切行为</li>
<li>即创建前置日志切面，并编写通知（选择切入时机和编写横切行为）</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AfterLog</span> <span class="keyword">implements</span> <span class="title">AfterReturningAdvice</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *通知：在目标执行完成后调用，并且接收执行结果</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> returnValue 被调用方法的返回值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> method</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> target</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Throwable</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturning</span><span class="params">(Object returnValue, Method method, Object[] args, Object target)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.print(target.getClass().getName() + <span class="string">&quot; 对象的 &quot;</span> + method.getName() + <span class="string">&quot; 方法被调用，&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;方法返回值为：&quot;</span> + returnValue);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>创建后置日志</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 实现切面BeforeLog</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yhd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2021-07-31 17:32</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeforeLog</span> <span class="keyword">implements</span> <span class="title">MethodBeforeAdvice</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通知：选择切入时机(在执行目标前执行)，编写横切内容</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> method 被调用(代理)方法的method封装对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args 被调用方法形参</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> target 目标对象/被代理对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Throwable</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">(Method method, Object[] args, Object target)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.println(target.getClass().getName() + <span class="string">&quot; 对象的 &quot;</span> + method.getName() + <span class="string">&quot; 方法被调用&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="AOP配置"><a href="#AOP配置" class="headerlink" title="AOP配置"></a>AOP配置</h3><h4 id="注册相关bean"><a href="#注册相关bean" class="headerlink" title="注册相关bean"></a>注册相关bean</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1、准备相关的bean--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.dao.UserDaoImpl&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;afterLog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.log.AfterLog&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;beforeLog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.log.BeforeLog&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="配置切面"><a href="#配置切面" class="headerlink" title="配置切面"></a>配置切面</h4><ul>
<li>配置切面包括配置<strong>切点</strong>与<strong>通知</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 2、配置AOP --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置切点 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;afterLogPc&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.company.dao.UserDaoImpl.*(..))&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;beforeLogPc&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.company.dao.UserDaoImpl.*(..))&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 配置通知(切面)：横切行为(待增加方法体) + 切点--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;afterLog&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;afterLogPc&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;beforeLog&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;beforeLogPc&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="获取代理对象"><a href="#获取代理对象" class="headerlink" title="获取代理对象"></a>获取代理对象</h3><ul>
<li>注意接口方式实现AOP返回的bean对象为代理对象：<code>class com.sun.proxy.$Proxy3</code></li>
<li>因此必须<strong>以代理接口通过多态的方式接收</strong>返回的实例，否则会报<code>BeanNotOfRequiredTypeException</code>异常</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ApplicationContext context =</span><br><span class="line">        <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//注意接口方式实现AOP返回的bean对象为代理对象：class com.sun.proxy.$Proxy3</span></span><br><span class="line">    <span class="comment">//因此需以代理接口多态的方式接收返回的实例，否则会报BeanNotOfRequiredTypeException异常</span></span><br><span class="line">    Object obj = context.getBean(<span class="string">&quot;userDaoImpl&quot;</span>);</span><br><span class="line">    <span class="comment">//System.out.println(obj.getClass()); //class com.sun.proxy.$Proxy3</span></span><br><span class="line"></span><br><span class="line">    UserDao userDaoImpl = context.getBean(<span class="string">&quot;userDaoImpl&quot;</span>,UserDao.class);</span><br><span class="line">    userDaoImpl.add();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>输出结果</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">com.company.dao.UserDaoImpl 对象的 add 方法被调用</span><br><span class="line">add方法执行</span><br><span class="line">com.company.dao.UserDaoImpl 对象的 add 方法被调用，方法返回值为：null</span><br></pre></td></tr></table></figure>

<h2 id="自定义切面方式"><a href="#自定义切面方式" class="headerlink" title="自定义切面方式"></a>自定义切面方式</h2><h3 id="配置方式"><a href="#配置方式" class="headerlink" title="配置方式"></a>配置方式</h3><h4 id="XML命名空间-1"><a href="#XML命名空间-1" class="headerlink" title="XML命名空间"></a>XML命名空间</h4><ul>
<li>同接口方式实现AOP的XML命名空间</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="定义切面"><a href="#定义切面" class="headerlink" title="定义切面"></a>定义切面</h4><ul>
<li>只编写切面中的通知内容，即横切行为。切入时机和切点均在配置文件中配置</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyLog</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeLog</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;==代码执行前==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterLog</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;==代码执行后==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="AOP配置-1"><a href="#AOP配置-1" class="headerlink" title="AOP配置"></a>AOP配置</h4><h5 id="注册相关bean-1"><a href="#注册相关bean-1" class="headerlink" title="注册相关bean"></a>注册相关bean</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1、准备相关的bean--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.dao.UserDaoImpl&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myLog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.company.log.MyLog&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="配置切面-1"><a href="#配置切面-1" class="headerlink" title="配置切面"></a>配置切面</h5><ul>
<li>配置切面包括配置切点和通知</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 2、配置AOP --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置切点 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;myLogPc&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.company.dao.UserDaoImpl.*(..))&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置切面 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;myLog&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 配置通知(时机 + 增强的方法体) 和 引入切点 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;beforeLog&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;myLogPc&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">&quot;afterLog&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;myLogPc&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="获取Bean"><a href="#获取Bean" class="headerlink" title="获取Bean"></a>获取Bean</h4><ul>
<li><p>注意，此时若被增强类有<strong>实现</strong>对应的接口，则使用的还是接口实现AOP，即刻返回的还是代理类</p>
</li>
<li><p>若想通过子类方式实现AOP，则必须保证被增强类没有对应的接口。而和XML配置方式无关</p>
</li>
<li><p><u>因此下述是取消了UserDao接口实现后的结果</u></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ApplicationContext context =</span><br><span class="line">        <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">    UserDaoImpl userDaoImpl = context.getBean(<span class="string">&quot;userDaoImpl&quot;</span>,UserDaoImpl.class);</span><br><span class="line">    userDaoImpl.add();</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<ul>
<li>输出效果</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;代码执行前&#x3D;&#x3D;</span><br><span class="line">add方法执行</span><br><span class="line">&#x3D;&#x3D;代码执行后&#x3D;&#x3D;</span><br></pre></td></tr></table></figure>

<h3 id="注解方式"><a href="#注解方式" class="headerlink" title="注解方式"></a>注解方式</h3><h4 id="XML命名空间-2"><a href="#XML命名空间-2" class="headerlink" title="XML命名空间"></a>XML命名空间</h4><ul>
<li>添加context和aop命名空间</li>
<li>开启注解支持和注解组件扫描，启用aop自动代理</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 组件扫描 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.company&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 开启注解支持 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 启用AOP自动代理 (默认)proxy-target-class=&quot;false&quot;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>aop:aspectj-autoproxy：说明</p>
<ul>
<li>通过aop命名空间的&lt;aop:aspectj-autoproxy /&gt;声明自动为spring容器中那些配置@aspectJ切面的bean创建代理，织入切面。当然，spring 在内部依旧采用AnnotationAwareAspectJAutoProxyCreator进行自动代理的创建工作，但具体实现的细节已经被&lt;aop:aspectj-autoproxy /&gt;隐藏起来了</li>
<li>&lt;aop:aspectj-autoproxy /&gt;有一个proxy-target-class属性，默认为false，表示使用jdk动态代理织入增强，</li>
<li>当配为&lt;aop:aspectj-autoproxy  poxy-target-class=”true”/&gt;时，表示使用CGLib动态代理技术织入增强。不过即使proxy-target-class设置为false，如果目标类没有声明接口，则spring将自动使用CGLib动态代理。</li>
</ul>
</blockquote>
<h4 id="注解定义切面"><a href="#注解定义切面" class="headerlink" title="注解定义切面"></a>注解定义切面</h4><ul>
<li><p>在类上面使用<code>@Aspect</code>注解将其标注为一个切面</p>
</li>
<li><p>在切入的方法上配置通知，使用<code>@Before</code>、<code>@After</code>…注解配置切入时机，方法体编写横切行为逻辑</p>
</li>
<li><p>配置切点，即在切入时机<code>@Before</code>、<code>@After</code>…的注解属性中填入<code>execution表达式</code></p>
<blockquote>
<p>若使用全注解方式，记得使用@Component 标注成Spring组件(Bean)</p>
<p>被增强的方法又要使用@Component 加载成Bean</p>
</blockquote>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company.log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.After;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yhd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2021-08-01 11:26</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyLog</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;execution(* com.company.dao.UserDaoImpl.*(..))&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeLog</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;==代码执行前==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After(&quot;execution(* com.company.dao.UserDaoImpl.*(..))&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterLog</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;==代码执行后==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.company.dao.UserDaoImpl.*(..))&quot;)</span></span><br><span class="line">    <span class="comment">//ProceedingJoinPoint是一个可选的传入形参</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">aroundLog</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;环绕前&quot;</span>);</span><br><span class="line">        joinPoint.proceed();</span><br><span class="line">        System.out.println(<span class="string">&quot;环绕后&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ApplicationContext context =</span><br><span class="line">    <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">    UserDaoImpl userDaoImpl = context.getBean(<span class="string">&quot;userDaoImpl&quot;</span>,UserDaoImpl.class);</span><br><span class="line">    userDaoImpl.add();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>输出结果</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">环绕前</span><br><span class="line">&#x3D;&#x3D;代码执行前&#x3D;&#x3D;</span><br><span class="line">add方法执行</span><br><span class="line">&#x3D;&#x3D;代码执行后&#x3D;&#x3D;</span><br><span class="line">环绕后</span><br></pre></td></tr></table></figure>

<blockquote>
<p>环绕通知与其他通知的相对顺序与环绕通知代码与其他通知代码的相对顺序有关</p>
</blockquote>
<h2 id="切面优先级设置"><a href="#切面优先级设置" class="headerlink" title="切面优先级设置"></a>切面优先级设置</h2><ul>
<li>在增强类上面添加注解 <code>@Order</code>(数字类型值)，数字类型值<strong>越小优先级越高</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Order(1)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonProxy</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="配置类启用AOP"><a href="#配置类启用AOP" class="headerlink" title="配置类启用AOP"></a>配置类启用AOP</h2><ul>
<li>使用<code>@EnableAspectJAutoProxy</code>注解启用AOP注解</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(basePackages = &#123;&quot;com.company&quot;&#125;)</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy(proxyTargetClass = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfigAop</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="JdbcTemplate"><a href="#JdbcTemplate" class="headerlink" title="JdbcTemplate"></a>JdbcTemplate</h1><h2 id="基本概念-3"><a href="#基本概念-3" class="headerlink" title="基本概念"></a>基本概念</h2><ul>
<li>Spring 框架对 JDBC 进行封装，使用 JdbcTemplate 方便实现对数据库操作</li>
</ul>
<h2 id="依赖jar包"><a href="#依赖jar包" class="headerlink" title="依赖jar包"></a>依赖jar包</h2><ul>
<li><strong>JdbcTemplate依赖</strong>（spring的libs中）<ul>
<li><u>spring-jdbc-5.3.9.jar</u></li>
<li><u>spring-tx-5.3.9.jar</u>（事务相关依赖）</li>
<li><em>spring-orm-5.3.9.jar</em>（非必须，orm框架整合依赖）</li>
</ul>
</li>
<li><strong>mysql相关依赖</strong><ul>
<li><u>mysql-connector-java-5.1.7-bin.jar</u></li>
</ul>
</li>
<li><em>数据库连接池</em>（非必须）<ul>
<li>druid-1.1.9.jar</li>
</ul>
</li>
</ul>
<h2 id="配置JdbcTemplate对象"><a href="#配置JdbcTemplate对象" class="headerlink" title="配置JdbcTemplate对象"></a>配置JdbcTemplate对象</h2><ul>
<li>由于JdbcTemplate也支持基于数据库连接池基础上的操作</li>
<li>因此采用IoC的方式创建JdbcTemplate对象时为其对象的dataSource属性注入数据库连接池对象</li>
</ul>
<h3 id="配置数据库连接池对象"><a href="#配置数据库连接池对象" class="headerlink" title="配置数据库连接池对象"></a>配置数据库连接池对象</h3><ul>
<li>基于Druid数据库连接池的IoC注入配置</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">destroy-method</span>=<span class="string">&quot;close&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql:///user_db&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="配置JdbcTemplate"><a href="#配置JdbcTemplate" class="headerlink" title="配置JdbcTemplate"></a>配置JdbcTemplate</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 创建JdbcTemplate对象并通过IoC方式注入 数据库连接池对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jdbcTemplate&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 实际是set方法注入 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="注入JdbcTemplate"><a href="#注入JdbcTemplate" class="headerlink" title="注入JdbcTemplate"></a>注入JdbcTemplate</h3><ul>
<li>采用自动装配方式</li>
<li>dao层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title">BookDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//自动装配JdbcTemplate对象</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>service层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookService</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BookDao bookDaoImpl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="增删改操作"><a href="#增删改操作" class="headerlink" title="增删改操作"></a>增删改操作</h2><ul>
<li>类似DBUtils的封装操作，修改(增删)都使用update函数</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addBook</span><span class="params">(Book book)</span> </span>&#123;</span><br><span class="line">    String sql = <span class="string">&quot;INSERT INTO t_book(t_book.`book_name`,t_book.`price`) VALUES(?,?);&quot;</span>;</span><br><span class="line">    <span class="keyword">int</span> update = jdbcTemplate.update(sql, book.getBookName(), book.getPrice());</span><br><span class="line">    <span class="keyword">return</span> update;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="查询操作"><a href="#查询操作" class="headerlink" title="查询操作"></a>查询操作</h2><h3 id="查询返回某个值"><a href="#查询返回某个值" class="headerlink" title="查询返回某个值"></a>查询返回某个值</h3><p><strong>queryForObject</strong>(String sql,Class&lt;T&gt; requiredType)方法</p>
<ul>
<li>String sql：sql 语句</li>
<li>Class&lt;T&gt; requiredType：查询结果的数据类型 Class</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询表记录数</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">selectCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line"> String sql = <span class="string">&quot;select count(*) from t_book&quot;</span>;</span><br><span class="line"> Integer count = jdbcTemplate.queryForObject(sql, Integer.class);</span><br><span class="line"> <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="查询返回bean"><a href="#查询返回bean" class="headerlink" title="查询返回bean"></a>查询返回bean</h3><p><strong>queryForObjet</strong>(String sql,RowMapper&lt;T&gt; rowMapper,Object…args)</p>
<ul>
<li>String sql：sql 语句</li>
<li><strong>RowMapper</strong>&lt;T&gt; <strong>rowMapper</strong>：<ul>
<li>RowMapper是一个接口，使用这个接口不同的实现类完成不同数据类型的封装</li>
<li>由于当前需要返回bean结构，因此选用其中的BeanPropertyRowMapper实现类</li>
<li>在该实现类的<u>泛型<code>&lt;&gt;</code>中注入返回的Bean类型</u>，并将Bean的Class对象作为<u>构造器实参传入</u></li>
</ul>
</li>
<li>Object…args：sql语句的传入参数</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询返回对象</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Book <span class="title">findBookInfo</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">	String sql = <span class="string">&quot;select * from t_book where user_id=?&quot;</span>;</span><br><span class="line">    <span class="comment">//调用方法</span></span><br><span class="line">    Book book = jdbcTemplate.queryForObject(sql, <span class="keyword">new</span> BeanPropertyRowMapper&lt;Book&gt;(Book.class), id);</span><br><span class="line">    <span class="keyword">return</span> book;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="查询返回集合"><a href="#查询返回集合" class="headerlink" title="查询返回集合"></a>查询返回集合</h3><ul>
<li><strong>query</strong>(String sql,RowMapper&lt;T&gt; rowMapper,Object…args)，</li>
<li>查询返回集合和查询返回bean调用的<strong>方法形参一致</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Book&gt; <span class="title">findAllBook</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String sql = <span class="string">&quot;select * from t_book&quot;</span>;</span><br><span class="line">    <span class="comment">//调用方法</span></span><br><span class="line">    List&lt;Book&gt; bookList = jdbcTemplate.query(sql, <span class="keyword">new</span> </span><br><span class="line">    BeanPropertyRowMapper&lt;Book&gt;(Book.class));</span><br><span class="line">    <span class="keyword">return</span> bookList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="批量修改"><a href="#批量修改" class="headerlink" title="批量修改"></a>批量修改</h3><ul>
<li>批量操作指批量的修改操作(增删改)，均使用<code>batchUpdate(String sql，List\&lt;Object[]&gt; batchArgs)</code>方法<ul>
<li>String sql：操作sql语句</li>
<li>List&lt;Object[]&gt; batchArgs：批量修改的数据，每一个Object[]数组表示一条记录的所有字段</li>
<li>返回值：影响行数</li>
</ul>
</li>
</ul>
<h4 id="批量增加示例"><a href="#批量增加示例" class="headerlink" title="批量增加示例"></a>批量增加示例</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">batchAddBook</span><span class="params">(List&lt;Object[]&gt; batchArgs)</span> </span>&#123;</span><br><span class="line">    String sql = <span class="string">&quot;insert into t_book values(?,?,?)&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//批量添加测试</span></span><br><span class="line">    List&lt;Object[]&gt; batchArgs = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    Object[] o1 = &#123;<span class="string">&quot;3&quot;</span>,<span class="string">&quot;java&quot;</span>,<span class="string">&quot;a&quot;</span>&#125;;</span><br><span class="line">    Object[] o2 = &#123;<span class="string">&quot;4&quot;</span>,<span class="string">&quot;c++&quot;</span>,<span class="string">&quot;b&quot;</span>&#125;;</span><br><span class="line">    Object[] o3 = &#123;<span class="string">&quot;5&quot;</span>,<span class="string">&quot;MySQL&quot;</span>,<span class="string">&quot;c&quot;</span>&#125;;</span><br><span class="line">    batchArgs.add(o1);</span><br><span class="line">    batchArgs.add(o2);</span><br><span class="line">    batchArgs.add(o3);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span>[] ints = jdbcTemplate.batchUpdate(sql, batchArgs);</span><br><span class="line">    System.out.println(Arrays.toString(ints));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="批量修改示例"><a href="#批量修改示例" class="headerlink" title="批量修改示例"></a>批量修改示例</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">batchUpdateBook</span><span class="params">(List&lt;Object[]&gt; batchArgs)</span> </span>&#123;</span><br><span class="line">    String sql = <span class="string">&quot;update t_book set username=?,ustatus=? where user_id=?&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//批量修改</span></span><br><span class="line">    List&lt;Object[]&gt; batchArgs = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    Object[] o1 = &#123;<span class="string">&quot;java0909&quot;</span>,<span class="string">&quot;a3&quot;</span>,<span class="string">&quot;3&quot;</span>&#125;;</span><br><span class="line">    Object[] o2 = &#123;<span class="string">&quot;c++1010&quot;</span>,<span class="string">&quot;b4&quot;</span>,<span class="string">&quot;4&quot;</span>&#125;;</span><br><span class="line">    Object[] o3 = &#123;<span class="string">&quot;MySQL1111&quot;</span>,<span class="string">&quot;c5&quot;</span>,<span class="string">&quot;5&quot;</span>&#125;;</span><br><span class="line">    batchArgs.add(o1);</span><br><span class="line">    batchArgs.add(o2);</span><br><span class="line">    batchArgs.add(o3);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span>[] ints = jdbcTemplate.batchUpdate(sql, batchArgs);</span><br><span class="line">    System.out.println(Arrays.toString(ints));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="批量删除示例"><a href="#批量删除示例" class="headerlink" title="批量删除示例"></a>批量删除示例</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//批量删除</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">batchDeleteBook</span><span class="params">(List&lt;Object[]&gt; batchArgs)</span> </span>&#123;</span><br><span class="line">    String sql = <span class="string">&quot;delete from t_book where user_id=?&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//批量删除</span></span><br><span class="line">    List&lt;Object[]&gt; batchArgs = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    Object[] o1 = &#123;<span class="string">&quot;3&quot;</span>&#125;;</span><br><span class="line">    Object[] o2 = &#123;<span class="string">&quot;4&quot;</span>&#125;;</span><br><span class="line">    batchArgs.add(o1);</span><br><span class="line">    batchArgs.add(o2);</span><br><span class="line">    <span class="comment">//调用方法实现批量删除</span></span><br><span class="line">    bookService.batchDelete(batchArgs);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span>[] ints = jdbcTemplate.batchUpdate(sql, batchArgs);</span><br><span class="line">    System.out.println(Arrays.toString(ints));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Spring事务操作"><a href="#Spring事务操作" class="headerlink" title="Spring事务操作"></a>Spring事务操作</h1><h2 id="基本概念-4"><a href="#基本概念-4" class="headerlink" title="基本概念"></a>基本概念</h2><h3 id="事务的概念"><a href="#事务的概念" class="headerlink" title="事务的概念"></a>事务的概念</h3><ul>
<li><strong>事务基本概念</strong>：事务是数据库操作最基本单元，是逻辑上一组操作，要么都成功，如果有一个失败所有操 作都失败 <ul>
<li>典型场景：银行转账， lucy 转账 100 元 给 mary ；lucy 少 100，mary 多 100</li>
</ul>
</li>
<li><strong>事务四个特性</strong>（ACID） <ul>
<li>原子性：不可分割，要么都执行，要么都回滚</li>
<li>一致性：保证数据的状态操作前和操作后保持一致（数据总量不变）</li>
<li>隔离性：多个事务同时操作相同数据库的同一个数据时，一个事务的执行不受另外一个事务的干扰</li>
<li>持久性：一个事务一旦提交，则数据将持久化到本地（即保证完成修改），除非其他事务对其进行修改</li>
</ul>
</li>
</ul>
<h3 id="Spring事务管理"><a href="#Spring事务管理" class="headerlink" title="Spring事务管理"></a>Spring事务管理</h3><ul>
<li>事务添加到 JavaEE 三层结构里面 <strong>Service 层</strong>（业务逻辑层）</li>
<li>在 Spring 进行事务管理操作有两种方式：<ul>
<li><strong>编程式事务管理</strong>：即最原始的硬编码方式添加事务相关代码</li>
<li><strong>声明式事务管理</strong>（推荐使用）：基于AOP方式添加事务相关操作的代码</li>
</ul>
</li>
</ul>
<h2 id="事务管理相关API"><a href="#事务管理相关API" class="headerlink" title="事务管理相关API"></a>事务管理相关API</h2><ul>
<li><p>Spring在事务管理上提供了一个接口表示<strong>事务管理器</strong></p>
</li>
<li><p>接口针对<strong>不同的持久层框架</strong>提供<strong>不同事务管理器的实现类</strong></p>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210803115821.png"
                     
                ></p>
<h2 id="编程式事务管理"><a href="#编程式事务管理" class="headerlink" title="编程式事务管理"></a>编程式事务管理</h2><ul>
<li>所谓编程式事务管理，即最原始的事务管理代码添加操作，<strong>采用硬编码的方式编写</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDaoImpl;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transferAccounts</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> transfer = <span class="number">100</span>;</span><br><span class="line">        <span class="comment">//编程式事务管理：硬编码方式添加事务管理代码</span></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//1、开启事务</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//2、执行数据库操作（业务操作）</span></span><br><span class="line">            <span class="comment">//Lucy ——&gt; Mary</span></span><br><span class="line">            userDaoImpl.reduceMoney(transfer,<span class="string">&quot;lucy&quot;</span>);</span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">3</span> / <span class="number">0</span>;</span><br><span class="line">            userDaoImpl.addMoney(transfer,<span class="string">&quot;mary&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//3、提交事务</span></span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;Lucy ——&gt; Mary转账 &quot;</span> + transfer + <span class="string">&quot; 成功&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            <span class="comment">//4、出现异常，事务回滚</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="声明式事务管理"><a href="#声明式事务管理" class="headerlink" title="声明式事务管理"></a>声明式事务管理</h2><h3 id="创建事务管理器"><a href="#创建事务管理器" class="headerlink" title="创建事务管理器"></a>创建事务管理器</h3><ol>
<li><p><strong>创建事务管理器</strong> <span id="jump_createTransactionManager"></span></p>
<ul>
<li>无论哪种方式实现声明式事务，一般配置bean都在xml中配置</li>
<li><strong>JdbcTemplate对应</strong>就是<strong>DataSourceTransactionManager</strong>实现类</li>
</ul>
<blockquote>
<p>注意，DataSourceTransactionManager由org.springframework.jdbc提供，即使用前需导入JdbcTemplate（spring-jdbc）依赖</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>添加<strong>事务</strong>（tx）<strong>xml命名空间</strong>，<strong>开启事务注解</strong>（若使用xml配置这不需要）</p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">            http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">            http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">            http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">            http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">            http://www.springframework.org/schema/tx/spring-tx.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 开启组件扫描--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.company&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 创建数据库连接池对象 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">destroy-method</span>=<span class="string">&quot;close&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql:///book_db&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 创建JdbcTemplate对象并通过IoC方式注入 数据库连接池对象--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jdbcTemplate&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 实际是set方法注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 创建事务管理器实现类，JdbcTemplate使用DataSourceTransactionManager实现类。并注入数据库连接池对象 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 开启事务注解，并指明事务管理器实现类对象 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：若当前事务管理器的bean id 不是 “transactionManager”，则在通过AOP配置事务（通知）时需要显式设置transaction-manager属性，指明使用新的事务管理器bean id</p>
</blockquote>
<h3 id="注解方式-1"><a href="#注解方式-1" class="headerlink" title="注解方式"></a>注解方式</h3><h4 id="Transactional"><a href="#Transactional" class="headerlink" title="@Transactional"></a>@Transactional</h4><ul>
<li><strong>@Transactional注解</strong>：表示事务，可添加到类和方法上。被添加的类或方法会自动植入事务机制，不用用户写try-catch，<u>自动完成事务开启、提交、异常捕获及进行回滚操作</u><ul>
<li>类：则该类的所有的方法都被添加事务</li>
<li>方法：则只为该方法添加事务</li>
</ul>
</li>
<li><strong>在Service层类（或方法）上添加事务注解</strong> </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDaoImpl;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transferAccounts</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> transfer = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//自动实现事务机制</span></span><br><span class="line">        <span class="comment">//Lucy ——&gt; Mary</span></span><br><span class="line">        userDaoImpl.reduceMoney(transfer,<span class="string">&quot;lucy&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">3</span> / <span class="number">0</span>;</span><br><span class="line">        userDaoImpl.addMoney(transfer,<span class="string">&quot;mary&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;Lucy ——&gt; Mary转账 &quot;</span> + transfer + <span class="string">&quot; 成功&quot;</span>);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>@Transactional</code>注解含有多个属性如下</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210803151112.png"
                     
                ></p>
<ul>
<li>以下选取常用的几个属性进行讲解</li>
</ul>
<table>
<thead>
<tr>
<th>相关属性</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><strong>propagation</strong></td>
<td>事务传播行为</td>
</tr>
<tr>
<td><strong>ioslation</strong></td>
<td>事务隔离级别</td>
</tr>
<tr>
<td><strong>timeout</strong></td>
<td>超时时机</td>
</tr>
<tr>
<td><strong>readOnly</strong></td>
<td>是否只读</td>
</tr>
<tr>
<td><strong>rollbackFor</strong></td>
<td>回滚</td>
</tr>
<tr>
<td><strong>noRollbackFor</strong></td>
<td>不回滚</td>
</tr>
</tbody></table>
<h4 id="propagation"><a href="#propagation" class="headerlink" title="propagation"></a>propagation</h4><h5 id="基本概念-5"><a href="#基本概念-5" class="headerlink" title="基本概念"></a>基本概念</h5><p>propagation<code>[ˌprɒpə&#39;ɡeɪʃ(ə)n]</code>，译为“传播”，该属性用于定义<u>事务的传播行为</u></p>
<ul>
<li><strong>事务的传播行为</strong>：多个<u>事务方法</u>之间进行调用的过程中，Spring对事务进行管理的行为机制</li>
<li><strong>事务方法</strong>：对数据库数据进行操作的方法</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210803153343.png"
                     
                ></p>
<blockquote>
<ul>
<li>如上图中，有两个操作数据库的方法（事务方法），并且add方法中调用了update方法</li>
<li>add方法有声明Spring事务，而update方法没有事务</li>
<li>此时若add方法体或update方法体产生异常，Spring将怎么进行事务控制，哪部分回滚或不回滚？</li>
<li>或者一个没有声明事务的事务方法操作有声明事务的事务方法会发生什么情况，这就是事务的传播行为</li>
</ul>
</blockquote>
<ul>
<li>Spring中7种事务的传播行为，常用为required、required_new</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210803161400.png"
                     
                ></p>
<h5 id="REQUIRED"><a href="#REQUIRED" class="headerlink" title="REQUIRED"></a>REQUIRED</h5><p>若存在被<strong>设置为required的A方法/类</strong>（required也是Spring的默认传播机制）</p>
<ul>
<li>若被一个有事务的B操作调用，则A方法共用(依赖于)B的事务</li>
<li>若被一个无事务的B操作调用，则A方法自身建立一个事务运行</li>
</ul>
<p><code>@Transactional(propagation = Propagation.REQUIRES_NEW)</code></p>
<blockquote>
<p>required在这里翻译成依赖</p>
</blockquote>
<h5 id="REQUIRED-NEW"><a href="#REQUIRED-NEW" class="headerlink" title="REQUIRED_NEW"></a>REQUIRED_NEW</h5><p>若存在被设置为required_new的A方法（或类）</p>
<ul>
<li>无论A方法被有事务或没事务的其他方法调用，<strong>A方法都将创建自身的事务</strong>进行操作</li>
</ul>
<p><code>@Transactional(propagation = Propagation.REQUIRED)</code></p>
<h4 id="isolation"><a href="#isolation" class="headerlink" title="isolation"></a>isolation</h4><h5 id="并发操作带来的数据不一致性"><a href="#并发操作带来的数据不一致性" class="headerlink" title="并发操作带来的数据不一致性"></a>并发操作带来的数据不一致性</h5><p>事务是并发控制的基本单位，当多个事务<strong>并发操作时</strong>，若没有正确的并发控制机制，一个事务的执行将会对其他事务进行错误的影响（如丢失修改、不可重复读、度“脏数据”等），因此<strong>破坏了事务的“隔离性”特点</strong></p>
<ul>
<li><strong>不可重复读</strong>：<ul>
<li>同一个事务中对同一个数据读取两次，却得到不一致的结果。其实在<u>两次读取之间，数据被其他事务修改</u>、删除(幻影)、增加(幻影) </li>
<li>换种方式说，即一个<u>未提交的事务</u>多次读取到另一个<u>已提交且为<strong>修改</strong></u>操作的事务后的数据。导致一个事务内每次夺取同一个数据都不一样</li>
</ul>
</li>
<li><strong>虚读/幻读</strong>：<ul>
<li>一个<u>未提交的事务</u>多次读取到另一个<u>已提交且为<strong>添加数据</strong></u>操作的事务后的数据（类似不可重复读）</li>
<li>换句话说一个事务在前后两次查询同一范围的时候，后一次查询看到了前一次查询没有看到的行，好像出现幻觉一般</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><strong>读</strong>“<strong>脏</strong>”<strong>数据</strong>：（主要避免操作）<ul>
<li>一个<u>未提交</u>的事务读取到<u>另一个未提交</u>事务的数据。（如读到了回滚前的数据）</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><strong>丢失修改</strong>：<ul>
<li>后一个事务用原有的数据进行修改，从而<u>忽略了比它先执行的事务对数据的修改操作</u>。使其先前事务的修改像“丢失”一样</li>
</ul>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210803165511.png"
                     
                ></p>
<h5 id="事务的隔离级别"><a href="#事务的隔离级别" class="headerlink" title="事务的隔离级别"></a>事务的隔离级别</h5><ul>
<li>isolation<code>[ˌaɪsəˈleɪʃn] </code>，译为“隔离”，该属性是用于设置事务的隔离级别</li>
<li>其实Spring中事务的隔离级别等价于数据库并发控制技术中的封锁技术</li>
</ul>
<table>
<thead>
<tr>
<th>隔离级别</th>
<th>封锁协议</th>
<th>脏读</th>
<th>不可重复读</th>
<th>幻读</th>
</tr>
</thead>
<tbody><tr>
<td><strong>read uncommitted</strong>（读未提交）</td>
<td>无锁</td>
<td>true</td>
<td>true</td>
<td>true</td>
</tr>
<tr>
<td><strong>read committed</strong>（读已提交）</td>
<td>一级封锁</td>
<td><strong>false</strong></td>
<td>true</td>
<td>true</td>
</tr>
<tr>
<td><strong>repeatable read</strong>（可重复读）</td>
<td>二级封锁</td>
<td><strong>false</strong></td>
<td><strong>false</strong></td>
<td>true</td>
</tr>
<tr>
<td><strong>serializable</strong>（串行化）</td>
<td>三级封锁</td>
<td><strong>false</strong></td>
<td><strong>false</strong></td>
<td><strong>false</strong></td>
</tr>
</tbody></table>
<h5 id="设置隔离级别"><a href="#设置隔离级别" class="headerlink" title="设置隔离级别"></a>设置隔离级别</h5><ul>
<li>下述为设置成可重复读隔离级别，<strong>也是Spring默认的隔离级别</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Transactional(isolation &#x3D; Isolation.REPEATABLE_READ)</span><br></pre></td></tr></table></figure>

<h4 id="timeout"><a href="#timeout" class="headerlink" title="timeout"></a>timeout</h4><ul>
<li>timeout，超时时间。事务提交的超时时间，若超过该时间未提交事务，自动进行回滚</li>
<li>timeout属性值得单位为秒。默认值为 -1，表示无超时设定</li>
</ul>
<p><code>@Transactional(timeout = -1)</code></p>
<h4 id="readOnly"><a href="#readOnly" class="headerlink" title="readOnly"></a>readOnly</h4><ul>
<li>readOnly是一个布尔类型，设置数据操作是否只读<ul>
<li>false：默认值，表示可以增删改查</li>
<li>true：只读，只能进行查询操作</li>
</ul>
</li>
</ul>
<p><code>@Transactional(readOnly = false)</code></p>
<h4 id="rollbackFor"><a href="#rollbackFor" class="headerlink" title="rollbackFor"></a>rollbackFor</h4><ul>
<li>rollbackFor是一个Class属性，用于设置哪些异常<strong>触发事务回滚</strong></li>
</ul>
<p><code>@Transactional(rollbackFor = NullPointerException.class)</code></p>
<h4 id="noRollbackFor"><a href="#noRollbackFor" class="headerlink" title="noRollbackFor"></a>noRollbackFor</h4><ul>
<li>反之norollbackFor用于设置哪些异常<strong>不触发事务回滚</strong></li>
</ul>
<h3 id="xml文件方式"><a href="#xml文件方式" class="headerlink" title="xml文件方式"></a>xml文件方式</h3><ul>
<li>首先要创建事务管理，<a href="#jump_createTransactionManager">见上述</a></li>
<li>xml方式配置事务是<strong>基于接口方式AOP的配置</strong>，只是此时<strong>事务</strong>操作等价于<strong>通知</strong>，唯一区别在于事务的通知还需配置一些事务相关的属性</li>
</ul>
<h4 id="配置通知（事务）"><a href="#配置通知（事务）" class="headerlink" title="配置通知（事务）"></a>配置通知（事务）</h4><p>此时通知的内容就是需要切入的事务管理的内容</p>
<ul>
<li>指定在哪个方法（方法名）以哪种规则添加事务机制</li>
<li>配置的方法名可取通配符”*“或”add*”（表示add开头的所有方法）</li>
<li>被配置事务的方法支持@Transactional注解的所有属性设置</li>
<li>可以配置事务的方法的规则可以多个修饰</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1、配置通知（事务） --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;myAdvice&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;transferAccounts&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="配置切面-2"><a href="#配置切面-2" class="headerlink" title="配置切面"></a>配置切面</h4><ul>
<li>配置切面需要配置<u>通知和切入点</u>（通知已在上述中配置了）</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 2、配置切面（切点和通知） --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置切点 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;myPt&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.company.service.UserServiceImpl.*(..))&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 引入通知--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;myAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;myPt&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="配置类启用事务"><a href="#配置类启用事务" class="headerlink" title="配置类启用事务"></a>配置类启用事务</h3><p>思路和注解方式实现Spring事务类似，只是把注解方式中剩余的xml部分写成Java配置类</p>
<ol>
<li>准备操作：配置类一般的准备操作含：开启组件扫描、注解扫描、开启事务注解</li>
<li>准备bean：对应注解实现Spring事务中的xml部分，将需要创建的bean在配置类中一一创建</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.datasource.DataSourceTransactionManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.EnableTransactionManagement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yhd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2021-08-03 20:07</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span>  <span class="comment">//标记为配置类</span></span><br><span class="line"><span class="meta">@ComponentScan(basePackages = &quot;com.company&quot;)</span>    <span class="comment">//开启组件扫描</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span> <span class="comment">//开启事务</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TxConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1、配置bean：返回类型为bean的数据类型，方法名为bean id即变量名</span></span><br><span class="line">    <span class="comment">//配置数据库连接池</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DruidDataSource <span class="title">dataSource</span><span class="params">()</span></span>&#123;</span><br><span class="line">        DruidDataSource dataSource = <span class="keyword">new</span> DruidDataSource();</span><br><span class="line">        <span class="comment">//注入的属性需要通过set方法设置进去</span></span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql:///book_db&quot;</span>);</span><br><span class="line">        dataSource.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置JdbcTemplate</span></span><br><span class="line">    <span class="comment">//这些@Bean都会在IoC容器中得到创建。通过设置形参，可以实现@Autowirde根据类型自动注入（形参传入已有实例）</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JdbcTemplate <span class="title">jdbcTemplate</span><span class="params">(DataSource dataSource)</span></span>&#123;</span><br><span class="line">        JdbcTemplate jdbcTemplate = <span class="keyword">new</span> JdbcTemplate();</span><br><span class="line">        jdbcTemplate.setDataSource(dataSource);</span><br><span class="line">        <span class="keyword">return</span> jdbcTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建事务管理器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSourceTransactionManager <span class="title">transactionManager</span><span class="params">(DataSource dataSource)</span></span>&#123;</span><br><span class="line">        DataSourceTransactionManager transactionManager = <span class="keyword">new</span> DataSourceTransactionManager();</span><br><span class="line">        transactionManager.setDataSource(dataSource);</span><br><span class="line">        <span class="keyword">return</span> transactionManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="核心新特性"><a href="#核心新特性" class="headerlink" title="核心新特性"></a>核心新特性</h1><h2 id="基于JDK8实现"><a href="#基于JDK8实现" class="headerlink" title="基于JDK8实现"></a>基于JDK8实现</h2><ul>
<li>Spring5 框架的代码基于 Java8，引用了Java8中增强的语法功能。运行时兼容 JDK9</li>
<li>许多不建议使用的类和方 法在代码库中删除</li>
</ul>
<h2 id="日志相关"><a href="#日志相关" class="headerlink" title="日志相关"></a>日志相关</h2><ul>
<li>Spring 5.0 框架自带了通用的日志封装 </li>
<li>Spring5 已经移除 Log4jConfigListener，官方建议使用 Log4j2</li>
</ul>
<h3 id="手动整合Log42"><a href="#手动整合Log42" class="headerlink" title="手动整合Log42"></a>手动整合Log42</h3><h4 id="引入jar包"><a href="#引入jar包" class="headerlink" title="引入jar包"></a>引入jar包</h4><ul>
<li>log4j-api-2.11.2.jar</li>
<li>log4j-core-2.11.2.jar</li>
<li>log4j-slf4j-impl-2.11.2.jar</li>
<li>slf4j-api-1.7.30.jar</li>
</ul>
<h4 id="创建log4j2配置文件"><a href="#创建log4j2配置文件" class="headerlink" title="创建log4j2配置文件"></a>创建log4j2配置文件</h4><ul>
<li>创建名为log4j2.xml的配置文件，文件名固定</li>
<li>创建后，进行类似如下配置，Spring5将自动启用log4j2的日志功能（执行程序就可以看到）</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--Configuration后面的status用于设置log4j2自身内部的信息输出，可以不设置，当设置成TRACE时，可以看到log4j2内部各种详细输出--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--日志级别以及优先级排序: OFF &gt; FATAL &gt; ERROR &gt; WARN &gt; INFO &gt; DEBUG &gt; TRACE &gt; ALL --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 假如定义了INFO，则&lt; INFO的所有内容（除OFF和FATAL外的error、warn）都会显示 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">status</span>=<span class="string">&quot;INFO&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--先定义所有的appender--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appenders</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--输出日志信息到控制台--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">console</span> <span class="attr">name</span>=<span class="string">&quot;Console&quot;</span> <span class="attr">target</span>=<span class="string">&quot;SYSTEM_OUT&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--控制日志输出的格式--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%t] %-5level %logger&#123;36&#125; - %msg%n&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">console</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appenders</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--然后定义logger，只有定义了logger并引入的appender，appender才会生效--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--root：用于指定项目的根日志，如果没有单独指定Logger，则会使用root作为默认的日志输出--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">loggers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;info&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;Console&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">loggers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>当前xml日志格式配置输出效果</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2021-08-03 21:27:42.953 [main] INFO  com.alibaba.druid.pool.DruidDataSource - &#123;dataSource-1&#125; inited</span><br></pre></td></tr></table></figure>

<h4 id="自定义日志输出"><a href="#自定义日志输出" class="headerlink" title="自定义日志输出"></a>自定义日志输出</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserLog</span></span>&#123;</span><br><span class="line">    <span class="comment">//设置日志类（就是当前类）</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = LoggerFactory.getLogger(UserLog.class);</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;hello log4j2&quot;</span>);</span><br><span class="line">        log.warn(<span class="string">&quot;hello log4j2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Nullable注解"><a href="#Nullable注解" class="headerlink" title="@Nullable注解"></a>@Nullable注解</h2><p>@Nullable 注解可以使用在方法上面，属性上面，参数上面</p>
<ul>
<li>方法上：表示方法返回可以为空，属性值可以 为空，参数值可以为空 </li>
<li>注解上：注解用在方法上面，方法返回值可以为空 </li>
<li>形参上：注解使用在方法参数里面，方法参数可以为空 </li>
<li>注解使用在属性上面，属性值可以为空</li>
</ul>
<h2 id="支持函数式编程"><a href="#支持函数式编程" class="headerlink" title="支持函数式编程"></a>支持函数式编程</h2><ul>
<li>对于GenericApplicationContext和AnnotationConfigApplicationContext类的操作支持函数式编程</li>
<li>通过GenericApplicationContext将自定义对象注册到IoC容器中让Spring托管操作来演示函数式编程的支持</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//函数式风格创建对象，交给 spring 进行管理</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGenericApplicationContext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1 创建 GenericApplicationContext 对象</span></span><br><span class="line">    GenericApplicationContext context = <span class="keyword">new</span> GenericApplicationContext();</span><br><span class="line">    <span class="comment">//2 调用 context 的方法对象注册</span></span><br><span class="line">    context.refresh();</span><br><span class="line">    context.registerBean(<span class="string">&quot;user1&quot;</span>,User.class,() -&gt; <span class="keyword">new</span> User());</span><br><span class="line">    <span class="comment">//3 获取在 spring 注册的对象</span></span><br><span class="line">    <span class="comment">// User user = (User)context.getBean(&quot;com.company.spring5.test.User&quot;);</span></span><br><span class="line">    User user = (User)context.getBean(<span class="string">&quot;user1&quot;</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="测试方面的改进"><a href="#测试方面的改进" class="headerlink" title="测试方面的改进"></a>测试方面的改进</h2><ul>
<li>Spring5对于junit5整合测试提供了一些新的注解</li>
<li>使其Spring5中进行测试更方便（如不用手动再创建IoC容器等）</li>
</ul>
<h3 id="整合junit4"><a href="#整合junit4" class="headerlink" title="整合junit4"></a>整合junit4</h3><ul>
<li>junit4可以直接在spring5中引用，但整合后会有和Spring框架交互更紧密的功能(如新注解)</li>
</ul>
<h4 id="引入测试依赖"><a href="#引入测试依赖" class="headerlink" title="引入测试依赖"></a>引入测试依赖</h4><ol>
<li>导入junit4相关依赖</li>
<li>导入spring整合测试类的相关依赖（可以使用注解）：<strong>spring-test-5.3.9.jar</strong></li>
</ol>
<h4 id="使用注解完成测试"><a href="#使用注解完成测试" class="headerlink" title="使用注解完成测试"></a>使用注解完成测试</h4><ul>
<li>使用注解可以减少“创建IoC容器对象，从IoC容器中获取测试对象”这两个步骤的代码量</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.company.service.UserService;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yhd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2021-08-04 11:52</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RunWith(SpringJUnit4ClassRunner.class)</span> <span class="comment">//定义单元测试框架</span></span><br><span class="line"><span class="meta">@ContextConfiguration(&quot;classpath:applicationContext.xml&quot;)</span>   <span class="comment">//加载配置文件</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JTest4</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//JTest4将会被视为Spring组件，因此可以采用自动装配获取想要测试的bean对象</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transferAccounts</span><span class="params">()</span></span>&#123;</span><br><span class="line">        userService.transferAccounts();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="整合junit5"><a href="#整合junit5" class="headerlink" title="整合junit5"></a>整合junit5</h3><h3 id="引入测试依赖-1"><a href="#引入测试依赖-1" class="headerlink" title="引入测试依赖"></a>引入测试依赖</h3><ol>
<li><p>导入junit5相关依赖，不用外部引入，直接在IDEA在线添加即可</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210804120816.png"
                     
                ></p>
</li>
<li><p>导入spring整合测试类的相关依赖（可以使用注解）：<strong>spring-test-5.3.9.jar</strong></p>
</li>
</ol>
<h3 id="使用注解完成测试-1"><a href="#使用注解完成测试-1" class="headerlink" title="使用注解完成测试"></a>使用注解完成测试</h3><ul>
<li>junit5整合后的新注解<code>@ExtendWith</code>和<code>@SpringJUnitConfig</code>等</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.company.service.UserService;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.extension.ExtendWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit.jupiter.SpringExtension;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit.jupiter.SpringJUnitConfig;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yhd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2021-08-04 11:52</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//@ExtendWith(SpringExtension.class)  //新注解：定义单元测试框架</span></span><br><span class="line"><span class="comment">//@ContextConfiguration(&quot;classpath:applicationContext.xml&quot;)   //加载配置文件</span></span><br><span class="line"><span class="comment">//也可以使用复合注解替代上面两个注解</span></span><br><span class="line"><span class="meta">@SpringJUnitConfig(locations = &quot;classpath:applicationContext.xml&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JTest5</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transferAccounts</span><span class="params">()</span></span>&#123;</span><br><span class="line">        userService.transferAccounts();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SpringWebFlux"><a href="#SpringWebFlux" class="headerlink" title="SpringWebFlux"></a>SpringWebFlux</h2><h3 id="WebFlux概述"><a href="#WebFlux概述" class="headerlink" title="WebFlux概述"></a>WebFlux概述</h3><ul>
<li>WebFlux是 Spring5 添加新的模块，用于 web 开发的，功能和 SpringMVC 类似的</li>
<li>Webflux 使用当前一种比较流行<strong>响应式编程</strong>出现的框架</li>
</ul>
<blockquote>
<p>前置基础知识：SpringMVC、SpringBoot、Maven、Java8新特性（特别使函数式编程）</p>
</blockquote>
<h3 id="响应式编程"><a href="#响应式编程" class="headerlink" title="响应式编程"></a>响应式编程</h3><h3 id="WebFlux的实现"><a href="#WebFlux的实现" class="headerlink" title="WebFlux的实现"></a>WebFlux的实现</h3><h2 id="其他增强"><a href="#其他增强" class="headerlink" title="其他增强"></a>其他增强</h2><ul>
<li>还有对SpringMVC的增强</li>
</ul>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><h2 id="Spring核心"><a href="#Spring核心" class="headerlink" title="Spring核心"></a>Spring核心</h2><ul>
<li><p>Spring作用是降低企业开发的复杂性，减低代码的耦合度</p>
</li>
<li><p>实现降耦的两大利器是IoC和AOP</p>
<ul>
<li><p>IoC(控制反转)用于减低<strong>类之间依赖关系</strong>的代码耦合度。实现方式和原理为DI(工厂 + DI)</p>
<ul>
<li><u>充分发挥IoC优势</u>的还需要<u>自动装配功能的加持</u>，IoC只是把所有依赖注入外部化成xml配置，但是配置的硬编码内容的数量还是一比一等价于源码编写</li>
<li>自动装配理想情况下只需配置bean注入操作全自动匹配实现</li>
</ul>
</li>
<li><p>AOP(面向切面编程)用于减低<strong>业务之间</strong>的耦合度，实现在不修改原有代码的情况下添加功能，最大程度地<u>维护了类的单一职责原则</u>，常用于事务操作。实现方式和原理为动态代理</p>
<blockquote>
<ul>
<li>业务之间：公共的业务 (日志 , 安全等) 和领域业务（真正的需求业务）</li>
<li>实现公共业务的重复利用 . 领域业务更纯粹 , 程序猿专注领域业务</li>
</ul>
</blockquote>
</li>
</ul>
</li>
<li><p><strong>IoC是减低依赖的耦合度，AOP是减低业务的耦合度。可以说Spring就是降耦利器</strong></p>
</li>
</ul>
<hr>
<ul>
<li>SpringBoot全面使用Java配置类方式，是没有一个用于bean的配置文件的</li>
</ul>
<h2 id="开发经验"><a href="#开发经验" class="headerlink" title="开发经验"></a>开发经验</h2><ul>
<li>xml与注解：<ul>
<li>xml更加万能，适用于任何场合！维护简单方便</li>
<li>注解不是自己类使用不了，维护相对复杂！</li>
</ul>
</li>
<li>xml与注解最佳实践：</li>
<li>xml用来管理bean；</li>
<li>注解只负责完成属性的注入；</li>
<li>在使用的过程中，只需要注意必须让注解生效，就需要开启注解的支持，且能扫描到需要使用注解的包</li>
</ul>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>Post title：Spring5</li>
        <li>Post author：yhd</li>
        <li>Create time：2021-08-04 15:24:22</li>
        <li>
            Post link：https://keep.xpoet.cn/2021/08/04/Spring5/
        </li>
        <li>
            Copyright Notice：All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.
        </li>
    </ul>
</div>

            </div>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2021/08/11/SpringMVC5/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">SpringMVC5</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2021/07/18/H5%20video%E6%A0%87%E7%AD%BE%E5%8F%8AJava%E5%AE%9E%E7%8E%B0%E8%A7%86%E9%A2%91%E6%B5%81%E6%92%AD%E6%94%BE/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">H5 video标签及Java实现视频流播放</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>&nbsp;-&nbsp;
            
            2021&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">yhd</a>
        </div>
        
            <script async  src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.1</a>
        </div>
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Spring%E6%A6%82%E8%BF%B0"><span class="nav-number">1.</span> <span class="nav-text">Spring概述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.1.</span> <span class="nav-text">基础介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%86%E5%8F%B2%E5%8F%91%E5%B1%95"><span class="nav-number">1.2.</span> <span class="nav-text">历史发展</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-number">1.3.</span> <span class="nav-text">优缺点</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E5%8A%BF"><span class="nav-number">1.3.1.</span> <span class="nav-text">优势</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A3%E5%8A%BF"><span class="nav-number">1.3.2.</span> <span class="nav-text">劣势</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring%E7%9A%847%E5%A4%A7%E6%A8%A1%E5%9D%97"><span class="nav-number">1.4.</span> <span class="nav-text">Spring的7大模块</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%A9%E5%B1%95"><span class="nav-number">1.5.</span> <span class="nav-text">扩展</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring%E4%BD%93%E7%B3%BB"><span class="nav-number">1.5.1.</span> <span class="nav-text">Spring体系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-Boot"><span class="nav-number">1.5.2.</span> <span class="nav-text">Spring Boot</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-Cloud"><span class="nav-number">1.5.3.</span> <span class="nav-text">Spring Cloud</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#IoC%E7%90%86%E8%AE%BA"><span class="nav-number">2.</span> <span class="nav-text">IoC理论</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF%E5%88%86%E6%9E%90"><span class="nav-number">2.1.</span> <span class="nav-text">场景分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%83%E7%94%A8%E6%B5%81%E7%A8%8B"><span class="nav-number">2.1.1.</span> <span class="nav-text">调用流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B"><span class="nav-number">2.1.2.</span> <span class="nav-text">代码示例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A8%A1%E6%8B%9FDAO%E5%B1%82"><span class="nav-number">2.1.2.1.</span> <span class="nav-text">模拟DAO层</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A8%A1%E6%8B%9F%E4%B8%9A%E5%8A%A1%E5%B1%82"><span class="nav-number">2.1.2.2.</span> <span class="nav-text">模拟业务层</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A8%A1%E6%8B%9FServlet%E5%B1%82"><span class="nav-number">2.1.2.3.</span> <span class="nav-text">模拟Servlet层</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90"><span class="nav-number">2.1.3.</span> <span class="nav-text">问题分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0"><span class="nav-number">2.1.3.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B-1"><span class="nav-number">2.1.3.2.</span> <span class="nav-text">代码示例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5"><span class="nav-number">2.2.</span> <span class="nav-text">依赖注入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3"><span class="nav-number">2.2.1.</span> <span class="nav-text">设计思想</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B-2"><span class="nav-number">2.2.2.</span> <span class="nav-text">代码示例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90-1"><span class="nav-number">2.2.3.</span> <span class="nav-text">问题分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-number">2.2.4.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IoC%E5%AE%B9%E5%99%A8"><span class="nav-number">2.3.</span> <span class="nav-text">IoC容器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E6%9C%89IoC%E5%AE%B9%E5%99%A8"><span class="nav-number">2.3.1.</span> <span class="nav-text">为什么有IoC容器?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IoC%E5%AE%B9%E5%99%A8%E7%BB%93%E6%9E%84"><span class="nav-number">2.3.2.</span> <span class="nav-text">IoC容器结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IoC%E5%AE%B9%E5%99%A8%E5%8A%9F%E8%83%BD"><span class="nav-number">2.3.3.</span> <span class="nav-text">IoC容器功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-IoC%E6%94%B9%E5%86%99"><span class="nav-number">2.3.4.</span> <span class="nav-text">Spring IoC改写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">2.3.4.1.</span> <span class="nav-text">设置配置文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%8E%E5%AE%B9%E5%99%A8%E4%B8%AD%E8%8E%B7%E5%8F%96%E5%AF%B9%E8%B1%A1"><span class="nav-number">2.3.4.2.</span> <span class="nav-text">从容器中获取对象</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HelloWorld"><span class="nav-number">3.</span> <span class="nav-text">HelloWorld</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E5%A7%8B%E6%96%B9%E5%BC%8F"><span class="nav-number">3.1.</span> <span class="nav-text">原始方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%98%E7%BD%91%E4%BB%8B%E7%BB%8D"><span class="nav-number">3.1.1.</span> <span class="nav-text">官网介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B5%84%E6%BA%90%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80"><span class="nav-number">3.1.2.</span> <span class="nav-text">资源下载地址</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%B0%E5%9D%80%E5%AF%BB%E6%89%BE%E6%AD%A5%E9%AA%A4"><span class="nav-number">3.1.2.1.</span> <span class="nav-text">地址寻找步骤</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAJava%E9%A1%B9%E7%9B%AE"><span class="nav-number">3.1.3.</span> <span class="nav-text">创建Java项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5IoC%E5%9F%BA%E7%A1%80%E5%8C%85"><span class="nav-number">3.1.4.</span> <span class="nav-text">导入IoC基础包</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Jar%E5%8C%85%E7%BB%93%E6%9E%84"><span class="nav-number">3.1.4.1.</span> <span class="nav-text">Jar包结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5Core-Container"><span class="nav-number">3.1.4.2.</span> <span class="nav-text">导入Core Container</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%86%E5%A4%87Bean%E7%BB%93%E6%9E%84"><span class="nav-number">3.1.5.</span> <span class="nav-text">准备Bean结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEBean%E4%BF%A1%E6%81%AF"><span class="nav-number">3.1.6.</span> <span class="nav-text">配置Bean信息</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAXML%E6%96%87%E4%BB%B6"><span class="nav-number">3.1.6.1.</span> <span class="nav-text">创建XML文件</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2Spring%E7%9A%84XML%E7%BB%93%E6%9E%84"><span class="nav-number">3.1.6.1.1.</span> <span class="nav-text">查询Spring的XML结构</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEBean%E4%BF%A1%E6%81%AF-1"><span class="nav-number">3.1.6.2.</span> <span class="nav-text">配置Bean信息</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A0%E8%BD%BD%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%8F%8A%E8%8E%B7%E5%8F%96%E5%AF%B9%E8%B1%A1"><span class="nav-number">3.1.7.</span> <span class="nav-text">加载配置文件及获取对象</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Maven%E6%96%B9%E5%BC%8F"><span class="nav-number">3.2.</span> <span class="nav-text">Maven方式</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#IoC%E5%AE%B9%E5%99%A8%E5%AE%9E%E4%BE%8B%E5%8C%96"><span class="nav-number">4.</span> <span class="nav-text">IoC容器实例化</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#IoC%E5%AE%B9%E5%99%A8%E6%8E%A5%E5%8F%A3"><span class="nav-number">4.1.</span> <span class="nav-text">IoC容器接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BB%E8%A6%81%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="nav-number">4.2.</span> <span class="nav-text">主要实现类</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#IoC%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA%E6%96%B9%E5%BC%8F"><span class="nav-number">5.</span> <span class="nav-text">IoC对象创建方式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A9%BA%E5%8F%82%E6%9E%84%E9%80%A0%E5%99%A8%E6%96%B9%E5%BC%8F"><span class="nav-number">5.1.</span> <span class="nav-text">空参构造器方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%89%E5%8F%82%E6%9E%84%E9%80%A0%E5%99%A8%E6%96%B9%E5%BC%8F"><span class="nav-number">5.2.</span> <span class="nav-text">有参构造器方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8D%E5%80%BC%E5%AF%B9%E5%8C%B9%E9%85%8D"><span class="nav-number">5.2.1.</span> <span class="nav-text">名值对匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%8D%E7%BD%AE%E5%8C%B9%E9%85%8D"><span class="nav-number">5.2.2.</span> <span class="nav-text">位置匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E5%8C%B9%E9%85%8D"><span class="nav-number">5.2.3.</span> <span class="nav-text">类型匹配</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#xml%E9%85%8D%E7%BD%AE%E5%9F%BA%E7%A1%80"><span class="nav-number">6.</span> <span class="nav-text">xml配置基础</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#bean"><span class="nav-number">6.1.</span> <span class="nav-text">bean</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#alias"><span class="nav-number">6.2.</span> <span class="nav-text">alias</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#import"><span class="nav-number">6.3.</span> <span class="nav-text">import</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5-1"><span class="nav-number">7.</span> <span class="nav-text">依赖注入</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%89%E5%8F%82%E6%9E%84%E9%80%A0%E5%99%A8%E6%B3%A8%E5%85%A5"><span class="nav-number">7.1.</span> <span class="nav-text">有参构造器注入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#lt-constructor-arg-gt-%E6%96%B9%E5%BC%8F"><span class="nav-number">7.1.1.</span> <span class="nav-text">&lt;constructor-arg&gt;方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#c%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E6%96%B9%E5%BC%8F"><span class="nav-number">7.1.2.</span> <span class="nav-text">c命名空间方式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#set%E6%B3%A8%E5%85%A5"><span class="nav-number">7.2.</span> <span class="nav-text">set注入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E5%87%86%E5%A4%87"><span class="nav-number">7.2.1.</span> <span class="nav-text">测试准备</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Sutdent-java"><span class="nav-number">7.2.1.1.</span> <span class="nav-text">Sutdent.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Address-java"><span class="nav-number">7.2.1.2.</span> <span class="nav-text">Address.java</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#lt-property-gt-%E6%96%B9%E5%BC%8F"><span class="nav-number">7.2.2.</span> <span class="nav-text">&lt;property&gt;方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E6%B3%A8%E5%85%A5%E5%86%99%E6%B3%95"><span class="nav-number">7.2.2.1.</span> <span class="nav-text">其他注入写法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E5%B1%9E%E6%80%A7%E5%80%BC%E6%B3%A8%E5%85%A5"><span class="nav-number">7.2.2.1.1.</span> <span class="nav-text">特殊属性值注入</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%86%85%E9%83%A8bean%E6%B3%A8%E5%85%A5"><span class="nav-number">7.2.2.1.2.</span> <span class="nav-text">内部bean注入</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#get%E6%96%B9%E6%B3%95%E8%8E%B7%E5%8F%96"><span class="nav-number">7.2.2.1.3.</span> <span class="nav-text">get方法获取</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8F%90%E5%8F%96%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="nav-number">7.2.2.1.4.</span> <span class="nav-text">提取集合类型注入</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BC%95%E5%85%A5%E5%A4%96%E9%83%A8properties%E6%B3%A8%E5%85%A5"><span class="nav-number">7.2.2.1.5.</span> <span class="nav-text">引入外部properties注入</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#p%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E6%96%B9%E5%BC%8F"><span class="nav-number">7.2.3.</span> <span class="nav-text">p命名空间方式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Bean%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">8.</span> <span class="nav-text">Bean作用域</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F"><span class="nav-number">8.1.</span> <span class="nav-text">单例模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="nav-number">8.2.</span> <span class="nav-text">原型模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JavaWeb%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">8.3.</span> <span class="nav-text">JavaWeb作用域</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Bean%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D"><span class="nav-number">9.</span> <span class="nav-text">Bean自动装配</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%95%E4%B8%BA%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D%EF%BC%9F"><span class="nav-number">9.1.</span> <span class="nav-text">何为自动装配？</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D"><span class="nav-number">9.1.1.</span> <span class="nav-text">自动装配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E7%A7%8D%E8%A3%85%E9%85%8D%E6%9C%BA%E5%88%B6"><span class="nav-number">9.1.2.</span> <span class="nav-text">三种装配机制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D%E5%8E%9F%E7%90%86"><span class="nav-number">9.1.3.</span> <span class="nav-text">自动装配原理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D%E6%96%B9%E5%BC%8F"><span class="nav-number">9.2.</span> <span class="nav-text">自动装配方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#byName"><span class="nav-number">9.2.1.</span> <span class="nav-text">byName</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#byType"><span class="nav-number">9.2.2.</span> <span class="nav-text">byType</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#constructor-NaN"><span class="nav-number">9.2.3.</span> <span class="nav-text">constructor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93-1"><span class="nav-number">9.2.4.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%A8%E8%A7%A3%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D"><span class="nav-number">9.3.</span> <span class="nav-text">注解自动装配</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="nav-number">9.3.1.</span> <span class="nav-text">准备工作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Autowired"><span class="nav-number">9.3.2.</span> <span class="nav-text">@Autowired</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="nav-number">9.3.2.1.</span> <span class="nav-text">基本使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#required%E5%B1%9E%E6%80%A7"><span class="nav-number">9.3.2.2.</span> <span class="nav-text">required属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Qualifier"><span class="nav-number">9.3.2.3.</span> <span class="nav-text">@Qualifier</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Resource"><span class="nav-number">9.3.3.</span> <span class="nav-text">@Resource</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nullable"><span class="nav-number">9.3.4.</span> <span class="nav-text">@Nullable</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#IoC%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91"><span class="nav-number">10.</span> <span class="nav-text">IoC注解开发</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%87%E5%AE%9A%E7%BB%84%E4%BB%B6%E6%89%AB%E6%8F%8F"><span class="nav-number">10.1.</span> <span class="nav-text">指定组件扫描</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%87%E5%AE%9A%E7%BB%84%E4%BB%B6%E7%B1%BB%E5%9E%8B%E6%89%AB%E6%8F%8F"><span class="nav-number">10.1.1.</span> <span class="nav-text">指定组件类型扫描</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%87%E5%AE%9A%E7%BB%84%E4%BB%B6%E7%B1%BB%E5%9E%8B%E4%B8%8D%E6%89%AB%E6%8F%8F"><span class="nav-number">10.1.2.</span> <span class="nav-text">指定组件类型不扫描</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bean%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="nav-number">10.2.</span> <span class="nav-text">Bean的创建</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E6%96%B9%E5%BC%8F"><span class="nav-number">10.2.1.</span> <span class="nav-text">默认方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%87%E5%AE%9ABean-Id%E6%96%B9%E5%BC%8F"><span class="nav-number">10.2.2.</span> <span class="nav-text">指定Bean Id方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%8D%E7%94%9F%E6%B3%A8%E8%A7%A3"><span class="nav-number">10.2.3.</span> <span class="nav-text">衍生注解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5-2"><span class="nav-number">10.3.</span> <span class="nav-text">依赖注入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D-1"><span class="nav-number">10.4.</span> <span class="nav-text">自动装配</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">10.5.</span> <span class="nav-text">作用域</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#IoC%E5%85%A8Java%E7%B1%BB%E9%85%8D%E7%BD%AE"><span class="nav-number">11.</span> <span class="nav-text">IoC全Java类配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Java%E6%9B%BF%E4%BB%A3XML"><span class="nav-number">11.1.</span> <span class="nav-text">Java替代XML</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Configuration"><span class="nav-number">11.1.1.</span> <span class="nav-text">@Configuration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bean"><span class="nav-number">11.1.2.</span> <span class="nav-text">@Bean</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Bean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">12.</span> <span class="nav-text">Bean的生命周期</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E8%A7%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">12.1.</span> <span class="nav-text">常规生命周期</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">12.1.1.</span> <span class="nav-text">生命周期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%94%E7%A4%BA%E4%BB%A3%E7%A0%81"><span class="nav-number">12.1.2.</span> <span class="nav-text">演示代码</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E5%90%8E%E7%BD%AE%E5%A4%84%E7%90%86%E5%99%A8"><span class="nav-number">12.2.</span> <span class="nav-text">添加后置处理器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F-1"><span class="nav-number">12.2.1.</span> <span class="nav-text">生命周期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="nav-number">12.2.2.</span> <span class="nav-text">示例代码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#FactoryBean"><span class="nav-number">13.</span> <span class="nav-text">FactoryBean</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">13.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B"><span class="nav-number">13.2.</span> <span class="nav-text">示例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#AOP%E7%90%86%E8%AE%BA"><span class="nav-number">14.</span> <span class="nav-text">AOP理论</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#AOP%E5%8E%9F%E7%90%86"><span class="nav-number">14.1.</span> <span class="nav-text">AOP原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E6%A6%82%E8%BF%B0"><span class="nav-number">14.2.</span> <span class="nav-text">代理模式概述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E4%BB%A3%E7%90%86"><span class="nav-number">14.2.1.</span> <span class="nav-text">静态代理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="nav-number">14.2.2.</span> <span class="nav-text">动态代理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0"><span class="nav-number">14.2.2.1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F"><span class="nav-number">14.2.2.2.</span> <span class="nav-text">实现方式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#jdk%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="nav-number">14.2.3.</span> <span class="nav-text">jdk实现动态代理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E6%80%A7%E5%88%86%E6%9E%90"><span class="nav-number">14.2.3.1.</span> <span class="nav-text">动态性分析</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Spring%E5%AE%9E%E7%8E%B0AOP"><span class="nav-number">15.</span> <span class="nav-text">Spring实现AOP</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#AOP%E6%A6%82%E8%BF%B0"><span class="nav-number">15.1.</span> <span class="nav-text">AOP概述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-1"><span class="nav-number">15.1.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AspectJ"><span class="nav-number">15.1.2.</span> <span class="nav-text">AspectJ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%93%E4%B8%9A%E6%9C%AF%E8%AF%AD"><span class="nav-number">15.1.3.</span> <span class="nav-text">专业术语</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A8%AA%E5%88%87%E5%85%B3%E6%B3%A8%E7%82%B9"><span class="nav-number">15.1.3.1.</span> <span class="nav-text">横切关注点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%87%E9%9D%A2"><span class="nav-number">15.1.3.2.</span> <span class="nav-text">切面</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%80%9A%E7%9F%A5"><span class="nav-number">15.1.3.2.1.</span> <span class="nav-text">通知</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%87%E7%82%B9"><span class="nav-number">15.1.3.2.2.</span> <span class="nav-text">切点</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5%E7%82%B9"><span class="nav-number">15.1.3.3.</span> <span class="nav-text">连接点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%87%E5%85%A5"><span class="nav-number">15.1.3.4.</span> <span class="nav-text">织入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%95%E5%85%A5"><span class="nav-number">15.1.3.5.</span> <span class="nav-text">引入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E5%B0%8F%E7%BB%93"><span class="nav-number">15.1.3.6.</span> <span class="nav-text">核心小结</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%87%E7%82%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">15.2.</span> <span class="nav-text">切点表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-2"><span class="nav-number">15.2.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95%E7%BB%93%E6%9E%84"><span class="nav-number">15.2.2.</span> <span class="nav-text">语法结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B"><span class="nav-number">15.2.3.</span> <span class="nav-text">案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E8%BE%BE%E5%BC%8F%E9%87%8D%E7%94%A8"><span class="nav-number">15.2.4.</span> <span class="nav-text">表达式重用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5%E7%BB%87%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="nav-number">15.3.</span> <span class="nav-text">导入织入依赖</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3%E9%80%9A%E7%9F%A5%E6%96%B9%E5%BC%8F"><span class="nav-number">15.4.</span> <span class="nav-text">接口通知方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#XML%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4"><span class="nav-number">15.4.1.</span> <span class="nav-text">XML命名空间</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E5%88%87%E9%9D%A2-%E9%80%9A%E7%9F%A5"><span class="nav-number">15.4.2.</span> <span class="nav-text">实现切面(通知)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%86%E5%A4%87%E4%BB%A3%E7%90%86%E6%8E%A5%E5%8F%A3"><span class="nav-number">15.4.2.1.</span> <span class="nav-text">准备代理接口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E9%80%9A%E7%9F%A5"><span class="nav-number">15.4.2.2.</span> <span class="nav-text">编写通知</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AOP%E9%85%8D%E7%BD%AE"><span class="nav-number">15.4.3.</span> <span class="nav-text">AOP配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A8%E5%86%8C%E7%9B%B8%E5%85%B3bean"><span class="nav-number">15.4.3.1.</span> <span class="nav-text">注册相关bean</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%88%87%E9%9D%A2"><span class="nav-number">15.4.3.2.</span> <span class="nav-text">配置切面</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E4%BB%A3%E7%90%86%E5%AF%B9%E8%B1%A1"><span class="nav-number">15.4.4.</span> <span class="nav-text">获取代理对象</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%88%87%E9%9D%A2%E6%96%B9%E5%BC%8F"><span class="nav-number">15.5.</span> <span class="nav-text">自定义切面方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F"><span class="nav-number">15.5.1.</span> <span class="nav-text">配置方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#XML%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4-1"><span class="nav-number">15.5.1.1.</span> <span class="nav-text">XML命名空间</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E5%88%87%E9%9D%A2"><span class="nav-number">15.5.1.2.</span> <span class="nav-text">定义切面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AOP%E9%85%8D%E7%BD%AE-1"><span class="nav-number">15.5.1.3.</span> <span class="nav-text">AOP配置</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B3%A8%E5%86%8C%E7%9B%B8%E5%85%B3bean-1"><span class="nav-number">15.5.1.3.1.</span> <span class="nav-text">注册相关bean</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%88%87%E9%9D%A2-1"><span class="nav-number">15.5.1.3.2.</span> <span class="nav-text">配置切面</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96Bean"><span class="nav-number">15.5.1.4.</span> <span class="nav-text">获取Bean</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F"><span class="nav-number">15.5.2.</span> <span class="nav-text">注解方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#XML%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4-2"><span class="nav-number">15.5.2.1.</span> <span class="nav-text">XML命名空间</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A8%E8%A7%A3%E5%AE%9A%E4%B9%89%E5%88%87%E9%9D%A2"><span class="nav-number">15.5.2.2.</span> <span class="nav-text">注解定义切面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95"><span class="nav-number">15.5.2.3.</span> <span class="nav-text">测试</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%87%E9%9D%A2%E4%BC%98%E5%85%88%E7%BA%A7%E8%AE%BE%E7%BD%AE"><span class="nav-number">15.6.</span> <span class="nav-text">切面优先级设置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E7%B1%BB%E5%90%AF%E7%94%A8AOP"><span class="nav-number">15.7.</span> <span class="nav-text">配置类启用AOP</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#JdbcTemplate"><span class="nav-number">16.</span> <span class="nav-text">JdbcTemplate</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-3"><span class="nav-number">16.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%9D%E8%B5%96jar%E5%8C%85"><span class="nav-number">16.2.</span> <span class="nav-text">依赖jar包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEJdbcTemplate%E5%AF%B9%E8%B1%A1"><span class="nav-number">16.3.</span> <span class="nav-text">配置JdbcTemplate对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0%E5%AF%B9%E8%B1%A1"><span class="nav-number">16.3.1.</span> <span class="nav-text">配置数据库连接池对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEJdbcTemplate"><span class="nav-number">16.3.2.</span> <span class="nav-text">配置JdbcTemplate</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E5%85%A5JdbcTemplate"><span class="nav-number">16.3.3.</span> <span class="nav-text">注入JdbcTemplate</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A2%9E%E5%88%A0%E6%94%B9%E6%93%8D%E4%BD%9C"><span class="nav-number">16.4.</span> <span class="nav-text">增删改操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C"><span class="nav-number">16.5.</span> <span class="nav-text">查询操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E6%9F%90%E4%B8%AA%E5%80%BC"><span class="nav-number">16.5.1.</span> <span class="nav-text">查询返回某个值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9Ebean"><span class="nav-number">16.5.2.</span> <span class="nav-text">查询返回bean</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E9%9B%86%E5%90%88"><span class="nav-number">16.5.3.</span> <span class="nav-text">查询返回集合</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9"><span class="nav-number">16.5.4.</span> <span class="nav-text">批量修改</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%B9%E9%87%8F%E5%A2%9E%E5%8A%A0%E7%A4%BA%E4%BE%8B"><span class="nav-number">16.5.4.1.</span> <span class="nav-text">批量增加示例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9%E7%A4%BA%E4%BE%8B"><span class="nav-number">16.5.4.2.</span> <span class="nav-text">批量修改示例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4%E7%A4%BA%E4%BE%8B"><span class="nav-number">16.5.4.3.</span> <span class="nav-text">批量删除示例</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Spring%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C"><span class="nav-number">17.</span> <span class="nav-text">Spring事务操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-4"><span class="nav-number">17.1.</span> <span class="nav-text">基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="nav-number">17.1.1.</span> <span class="nav-text">事务的概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="nav-number">17.1.2.</span> <span class="nav-text">Spring事务管理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E7%9B%B8%E5%85%B3API"><span class="nav-number">17.2.</span> <span class="nav-text">事务管理相关API</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%96%E7%A8%8B%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="nav-number">17.3.</span> <span class="nav-text">编程式事务管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A3%B0%E6%98%8E%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="nav-number">17.4.</span> <span class="nav-text">声明式事务管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E5%99%A8"><span class="nav-number">17.4.1.</span> <span class="nav-text">创建事务管理器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F-1"><span class="nav-number">17.4.2.</span> <span class="nav-text">注解方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Transactional"><span class="nav-number">17.4.2.1.</span> <span class="nav-text">@Transactional</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#propagation"><span class="nav-number">17.4.2.2.</span> <span class="nav-text">propagation</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-5"><span class="nav-number">17.4.2.2.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#REQUIRED"><span class="nav-number">17.4.2.2.2.</span> <span class="nav-text">REQUIRED</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#REQUIRED-NEW"><span class="nav-number">17.4.2.2.3.</span> <span class="nav-text">REQUIRED_NEW</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#isolation"><span class="nav-number">17.4.2.3.</span> <span class="nav-text">isolation</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B9%B6%E5%8F%91%E6%93%8D%E4%BD%9C%E5%B8%A6%E6%9D%A5%E7%9A%84%E6%95%B0%E6%8D%AE%E4%B8%8D%E4%B8%80%E8%87%B4%E6%80%A7"><span class="nav-number">17.4.2.3.1.</span> <span class="nav-text">并发操作带来的数据不一致性</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="nav-number">17.4.2.3.2.</span> <span class="nav-text">事务的隔离级别</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="nav-number">17.4.2.3.3.</span> <span class="nav-text">设置隔离级别</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#timeout"><span class="nav-number">17.4.2.4.</span> <span class="nav-text">timeout</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#readOnly"><span class="nav-number">17.4.2.5.</span> <span class="nav-text">readOnly</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rollbackFor"><span class="nav-number">17.4.2.6.</span> <span class="nav-text">rollbackFor</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#noRollbackFor"><span class="nav-number">17.4.2.7.</span> <span class="nav-text">noRollbackFor</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xml%E6%96%87%E4%BB%B6%E6%96%B9%E5%BC%8F"><span class="nav-number">17.4.3.</span> <span class="nav-text">xml文件方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E9%80%9A%E7%9F%A5%EF%BC%88%E4%BA%8B%E5%8A%A1%EF%BC%89"><span class="nav-number">17.4.3.1.</span> <span class="nav-text">配置通知（事务）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%88%87%E9%9D%A2-2"><span class="nav-number">17.4.3.2.</span> <span class="nav-text">配置切面</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E7%B1%BB%E5%90%AF%E7%94%A8%E4%BA%8B%E5%8A%A1"><span class="nav-number">17.4.4.</span> <span class="nav-text">配置类启用事务</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E6%96%B0%E7%89%B9%E6%80%A7"><span class="nav-number">18.</span> <span class="nav-text">核心新特性</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8EJDK8%E5%AE%9E%E7%8E%B0"><span class="nav-number">18.1.</span> <span class="nav-text">基于JDK8实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3"><span class="nav-number">18.2.</span> <span class="nav-text">日志相关</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%8B%E5%8A%A8%E6%95%B4%E5%90%88Log42"><span class="nav-number">18.2.1.</span> <span class="nav-text">手动整合Log42</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%95%E5%85%A5jar%E5%8C%85"><span class="nav-number">18.2.1.1.</span> <span class="nav-text">引入jar包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAlog4j2%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">18.2.1.2.</span> <span class="nav-text">创建log4j2配置文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97%E8%BE%93%E5%87%BA"><span class="nav-number">18.2.1.3.</span> <span class="nav-text">自定义日志输出</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nullable%E6%B3%A8%E8%A7%A3"><span class="nav-number">18.3.</span> <span class="nav-text">@Nullable注解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%94%AF%E6%8C%81%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B"><span class="nav-number">18.4.</span> <span class="nav-text">支持函数式编程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E6%96%B9%E9%9D%A2%E7%9A%84%E6%94%B9%E8%BF%9B"><span class="nav-number">18.5.</span> <span class="nav-text">测试方面的改进</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B4%E5%90%88junit4"><span class="nav-number">18.5.1.</span> <span class="nav-text">整合junit4</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%95%E5%85%A5%E6%B5%8B%E8%AF%95%E4%BE%9D%E8%B5%96"><span class="nav-number">18.5.1.1.</span> <span class="nav-text">引入测试依赖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%B3%A8%E8%A7%A3%E5%AE%8C%E6%88%90%E6%B5%8B%E8%AF%95"><span class="nav-number">18.5.1.2.</span> <span class="nav-text">使用注解完成测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B4%E5%90%88junit5"><span class="nav-number">18.5.2.</span> <span class="nav-text">整合junit5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%95%E5%85%A5%E6%B5%8B%E8%AF%95%E4%BE%9D%E8%B5%96-1"><span class="nav-number">18.5.3.</span> <span class="nav-text">引入测试依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%B3%A8%E8%A7%A3%E5%AE%8C%E6%88%90%E6%B5%8B%E8%AF%95-1"><span class="nav-number">18.5.4.</span> <span class="nav-text">使用注解完成测试</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SpringWebFlux"><span class="nav-number">18.6.</span> <span class="nav-text">SpringWebFlux</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#WebFlux%E6%A6%82%E8%BF%B0"><span class="nav-number">18.6.1.</span> <span class="nav-text">WebFlux概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B"><span class="nav-number">18.6.2.</span> <span class="nav-text">响应式编程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WebFlux%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-number">18.6.3.</span> <span class="nav-text">WebFlux的实现</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E5%A2%9E%E5%BC%BA"><span class="nav-number">18.7.</span> <span class="nav-text">其他增强</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">19.</span> <span class="nav-text">总结</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring%E6%A0%B8%E5%BF%83"><span class="nav-number">19.1.</span> <span class="nav-text">Spring核心</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C"><span class="nav-number">19.2.</span> <span class="nav-text">开发经验</span></a></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>



    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-copy.js"></script>




    
<script src="/js/lazyload.js"></script>



<div class="post-scripts">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>



</body>
</html>
