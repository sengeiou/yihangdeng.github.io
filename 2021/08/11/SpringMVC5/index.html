<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="yhd">
    
    <title>
        
            SpringMVC5 |
        
        DyhBlog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/MyLogo.svg">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"yoursite.com","root":"/","language":"en","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":false,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/avatar.jpg","favicon":"/images/MyLogo.svg","article_img_align":"left","left_side_width":"230px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.jpeg"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":false},"lazyload":{"enable":true},"version":"3.4.1"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 5.1.1"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            <a class="logo-title" href="/">
                DyhBlog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                TAGS
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">TAGS</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">SpringMVC5</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.jpg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">yhd</span>
                        
                            <span class="author-label">Lv4</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;2021-08-11 23:42:12
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/SpringMVC/">SpringMVC</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>21.8k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>94 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <p><strong>引言</strong>：SpringMVC是Spring的一个<strong>子项目</strong>，是<u>Spring的一个后续产品</u>SpringMVC 是 Spring 为<strong>表述层</strong>（表示层）开发提供的一整套完备的解决方案。本文以Maven工程为基础，介绍SpringMVC中常用注解，如@RequestMapping，如何获取请求参数，域对象得数据共享，视图概念。同时介绍了REST的架构风格，静态资源访问、HttpMessageConverter、文件上传下载、拦截器、异常处理器、纯配置类开发、以及SpringMVC底层执行过程的了解。</p>
<h1 id="SpringMVC概述">SpringMVC概述</h1>
<h2 id="MVC概念">MVC概念</h2>
<h3 id="基本概念">基本概念</h3>
<p>MVC是一种软件架构的思想，将软件按照<strong>模型、视图、控制器</strong>来划分</p>
<ul>
<li><strong>M：Model</strong>，模型层，指工程中的JavaBean，作用是处理数据
<ul>
<li>实体类Bean：专门存储业务数据的，如 Student、User 等</li>
<li>业务处理 Bean：指 <strong>Service</strong> 或 Dao 对象，专门用于处理<strong>业务逻辑</strong>和数据访问</li>
</ul>
</li>
<li><strong>V：View</strong>，视图层，指工程中的<u>html或jsp</u>等页面，作用是与用户进行交互，展示数据</li>
<li><strong>C：Controller</strong>，控制层，指工程中的Servlet，作用是接收请求和响应浏览器</li>
</ul>
<h3 id="工作流程">工作流程</h3>
<ol>
<li>用户通过视图层发送请求到服务器，在服务器中请求被Controller接收</li>
<li>Controller 调用相应的Model层处理请求，处理完毕将结果返回到Controller</li>
<li>Controller再根据请求处理的结果 找到相应的View视图，渲染数据后最终响应给浏览器</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210804202807.png"
                      alt=""
                ></p>
<blockquote>
<p>注：实际开发中，常将MVC重组为三层架构，表述(示)层（页面 + servlet）、业务逻辑层（service）、数据访问层（bean + dao）</p>
</blockquote>
<h2 id="SpringMVC概念">SpringMVC概念</h2>
<ul>
<li>SpringMVC是Spring的一个<strong>子项目</strong>，是<u>Spring的一个后续产品</u></li>
<li>SpringMVC 是 Spring 为<strong>表述层</strong>（表示层）开发提供的一整套完备的解决方案</li>
<li>表述层框架历经 Strust、WebWork、Strust2 等诸多产品的历代更迭之后，目前业界普遍选择了 SpringMVC 作为 Java EE 项目表述层开发的<strong>首选方案</strong></li>
</ul>
<blockquote>
<p>注：<strong>三层架构</strong>分为表述层（或表示层）、业务逻辑层、数据访问层</p>
</blockquote>
<h2 id="SpringMVC特点">SpringMVC特点</h2>
<ul>
<li><strong>Spring 家族原生产品</strong>，与 IOC 容器等基础设施<strong>无缝对接</strong>（<em>即整合Spring时无需任何配置与jar包</em>）</li>
<li><strong>基于原生的Servlet</strong>，通过了功能强大的<strong>前端控制器DispatcherServlet</strong>，对请求和响应进行统一处理</li>
<li>表述层各细分领域需要解决的问题<strong>全方位覆盖</strong>，提供<strong>全面解决方案</strong>（<em>如接收请求数据封装等公共操作</em>）</li>
<li><strong>代码清新简洁</strong>，大幅度提升开发效率</li>
<li>内部组件化程度高，可插拔式组件<strong>即插即用</strong>，想要什么功能配置相应组件即可（<em>通过配置组件实现功能</em>）</li>
<li><strong>性能卓著</strong>，尤其适合现代大型、超大型互联网项目要求</li>
</ul>
<h1 id="HelloWorld">HelloWorld</h1>
<h2 id="开发环境">开发环境</h2>
<ul>
<li>IDE：idea 2020.3</li>
<li>构建工具：maven-3.6.0</li>
<li>服务器：tomcat-9.0.44</li>
<li>Spring版本：5.3.9</li>
</ul>
<h2 id="创建maven工程">创建maven工程</h2>
<h3 id="设置打包方式">设置打包方式</h3>
<ul>
<li>在maven核心配置文件pom.xml中，将打包方式设置成war包，<code>&lt;packaging&gt;war&lt;/packaging&gt;</code></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>HelloWorld<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 设置打包方式，打包成war包 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意IDEA环境在pom.xml文件中添加新依赖时，需观察是否有点击maven类刷新（Load Maven Changes）的按钮，加载进来</p>
</blockquote>
<h3 id="导入依赖">导入依赖</h3>
<ul>
<li>
<p><strong>SpringMVC依赖</strong>（含Spring）：由于是Spring中的模块，maven将自动导入Spring相关依赖</p>
<blockquote>
<p>从中可以看出SpringMVC所依赖的Jar包<strong>都来自于Spring</strong>。表明SpringMVC就是Spring里面的东西</p>
</blockquote>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210804210504.png"
                      alt=""
                ></p>
</li>
<li>
<p><strong>日志依赖</strong></p>
</li>
<li>
<p><strong>Servlet API 依赖</strong></p>
</li>
<li>
<p><strong>Thymeleaf依赖</strong></p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- SpringMVC --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- logback日志 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ServletAPI --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 不参与打包，因为tomcat自带，避免引发冲突--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Spring5+Thymeleaf的整合包 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-spring5<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.12.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="构建web目录">构建web目录</h3>
<ul>
<li>众所周知，基于Servlet的JavaWeb有一套需遵循的web目录结构，也是web项目的标志</li>
<li>在IDE中，也称为快速创建web项目（eclipse）、添加web模块（IDEA）</li>
</ul>
<h4 id="IDEA快速添加">IDEA快速添加</h4>
<blockquote>
<p>版权声明：本文为CSDN博主「小跟班大智慧」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>
原文链接：<a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/czc9309/article/details/80304074" >https://blog.csdn.net/czc9309/article/details/80304074<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>
<h4 id="IDEA手动添加">IDEA手动添加</h4>
<h5 id="创建web目录">创建web目录</h5>
<ul>
<li>由于是基于maven构建项目，因此maven下的web目录是命名为webapp</li>
<li>maven源代码在<code>项目\src\main\</code>目录下，因此创建的web目录路径为<code>项目\src\main\webapp\</code></li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210804213029.png"
                      alt=""
                ></p>
<blockquote>
<p>注意创建webapp目录后观察有没有个小蓝点，有蓝点才被maven工程识别，否则刷新加载一下maven</p>
</blockquote>
<h5 id="IDEA生成web-xml">IDEA生成web.xml</h5>
<ul>
<li>进入<code>project structure</code>，定位到当前的<code>Modules</code></li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210804213658.png"
                      alt=""
                ></p>
<ul>
<li>在<code>Deployment Descriptors</code>栏目下点击<code>+</code>号，添加原始的web.xml文件</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210804214255.png"
                      alt=""
                ></p>
<ul>
<li>点击<code>OK</code>，再点击<code>apply</code>或<code>OK</code>，将自动创建web.xml，并坚持是否再规定路径下创建了web.xml文件（底部警告无需理会）</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210804214505.png"
                      alt=""
                ></p>
<h2 id="配置前端控制器">配置前端控制器</h2>
<ul>
<li>由于SpringMVC使采取“<strong>前端控制器DispatcherServlet</strong>”对请求和响应进行统一管理的</li>
<li>SpringMVC的“DispatcherServlet”<strong>本身就是一个Servlet</strong>，因此使用它必须像原生操作那样<strong>注册Servlet</strong></li>
</ul>
<blockquote>
<p>DispatcherServlet类似与自编写的反射请求分发的BaseServlet</p>
</blockquote>
<h3 id="xml配置方式">xml配置方式</h3>
<ul>
<li>在web.xml配置前端控制器有<strong>两种方式</strong>，均能实现，选其一即可</li>
</ul>
<h4 id="默认配置方式">默认配置方式</h4>
<ul>
<li><u><strong>不推荐在maven工程下使用</strong></u>该方式，因为SpringMVC的配置文件将会默认在WEB-INF目录下被自动创建</li>
<li>因为maven项目中，一般配置文件都希望在<code>项目\src\main\resources\</code>目录下创建</li>
</ul>
<h5 id="匹配路径设置">匹配路径设置</h5>
<ul>
<li>由于SpringMVC的机制使通过DispatcherServlet去<strong>统一管理所有请求和响应的</strong></li>
<li>因此将匹配的url设置成 <code>&quot;/&quot;</code> （除.jsp不能匹配外）</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li><code>&quot;/&quot;</code> 是不匹配.jsp结尾的请求，由于jsp本质是一种特殊的Servlet。若给予SpringMVC匹配，则会误将其当作一般的Servlet被DispatcherServlet处理，从而找不到相应的页面</li>
<li><code>&quot;/*&quot;</code> 是能够匹配所有请求，包括.jsp。若在使用过滤器时，若需要对所有请求进行过滤则使用</li>
</ul>
</blockquote>
<h5 id="SpringMVC配置文件">SpringMVC配置文件</h5>
<ul>
<li>上述的“默认配置方式”只在web.xml中进行了Servlet的注册，并没有创建或配置SpringMVC的配置文件</li>
<li>此时，SpringMVC的配置文件默认位于WEB-INF下，默认名称为<code>&lt;servlet-name&gt;-servlet.xml</code></li>
<li>例如，上述配置所对应SpringMVC的配置文件位于WEB-INF下，文件名为<code>springMVC-servlet.xml</code></li>
</ul>
<h4 id="扩展配置方式">扩展配置方式</h4>
<h5 id="创建配置文件">创建配置文件</h5>
<ul>
<li>基于maven工程，因此在<code>项目\src\main\resources\</code>下创建<strong>SpringMVC的配置文件</strong></li>
<li>由于SpringMVC就是Spring的其中一个模块，因此配置文件<strong>与Spring的配置文件内容一致</strong></li>
<li>可以选择IDEA一键创建Spring配置文件</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210804223347.png"
                      alt=""
                ></p>
<h5 id="定义配置文件的路径">定义配置文件的路径</h5>
<ul>
<li>
<p>在上述“默认配置方式”基础上，通过<code>&lt;init-param&gt;</code>标签设置<strong>SpringMVC配置文件的<u>位置和名称</u></strong></p>
</li>
<li>
<p>通过<code>&lt;load-on-startup&gt;</code>标签设置SpringMVC前端控制器<strong>DispatcherServlet的初始化时间</strong></p>
<blockquote>
<p>由于DispatcherServlet用于接管web中的所有请求和响应，默认的Servlet创建/初始化时机是该Servlet被第一次访问的时候。若不修改初始化时机为web启动时候，则会严重影响第一次访问web的响应速度</p>
</blockquote>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--- 选择classpath，指maven项目中的src\main\java和src\main\resources --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springMVC.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 将前端控制器DispatcherServlet的初始化时机提前到服务器启动时初始化 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>补充说明：maven中的<code>src\main\java\</code>和<code>src\main\resources\</code>目录下的内容都映射到类路径下，即classpath下
<ul>
<li>main：等价原生的Project（项目名称）</li>
<li>java/resources：等价原生的src目录</li>
</ul>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210804231525.png"
                      alt=""
                ></p>
<h3 id="注解方式">注解方式</h3>
<h2 id="创建请求控制器">创建请求控制器</h2>
<ul>
<li>前端控制器只是对所有请求进行了统一的处理，但具体不同的请求有不同的处理过程（类BaseServlet）
<ul>
<li>因此需要创建处理具体请求的<strong>类</strong>，即<strong>请求控制器</strong>。其中的每一个处理请求的<strong>方法</strong>称为<strong>控制器方法</strong></li>
</ul>
</li>
<li>SpringMVC的<strong>控制器</strong>定义为<strong>一个POJO</strong>（Plain Ordinary Java Object / <strong>普通Java类</strong>）
<ul>
<li><strong>控制器</strong>需将其标识为一个<u>控制层组件</u>，交给<u>Spring的IoC容器管理</u>后才能够被SrpingMVC识别控制器的存在</li>
<li>这里以通过注解的方式来实现控制器的声明操作，即使用<code>@Controller</code><strong>注解</strong></li>
</ul>
</li>
</ul>
<h3 id="开启组件扫描">开启组件扫描</h3>
<ul>
<li>在<strong>SpringMVC配置文件中</strong>（等价Spring配置文件）添加如下组件扫描代码（目的是扫描控制器所在位置）</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 开启组件扫描 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.company.mvc.controller&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="创建控制器">创建控制器</h3>
<ol>
<li><strong>创建控制器类</strong>
<ul>
<li>在maven项目的<code>项目名\src\main\java\</code>目录下创建控制器类</li>
<li>控制器包名，建议使用controller或handler命名</li>
</ul>
</li>
<li><strong>控制器类上添加<code>@Controller</code>的Spring注解</strong>，标识为一个Spring IoC中的一个组件，且为控制器标识</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company.mvc.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"><span class="doctag">@author</span> yhd</span></span><br><span class="line"><span class="comment"><span class="doctag">@create</span> 2021-08-05 11:29</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="配置Thymeleaf">配置Thymeleaf</h2>
<ul>
<li>由于本文使用Thymeleaf作为视图解析器，因此需要配置Thymeleaf</li>
</ul>
<h3 id="Thymeleaf简介">Thymeleaf简介</h3>
<ul>
<li>Thymeleaf是一个XML/XHTML/HTML5<strong>模板引擎</strong>，可用于Web与非Web环境中的应用开发</li>
<li>它是一个<strong>开源的Java库</strong>，基于Apache License 2.0许可，由Daniel Fernández创建，该作者还是Java加密库Jasypt的作者</li>
<li>因此Thymeleaf是独立于Spring家族的开源Java库，只是Spring系列框架大力推荐和支持使用Thymeleaf，而不推荐使用JSP</li>
</ul>
<h3 id="配置Thymeleaf-2">配置Thymeleaf</h3>
<ul>
<li>在<strong>SpringMVC的配置文件</strong>中配置视图解析器</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置Thymeleaf视图解析器属性（也可配置成JSP） --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;viewResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring5.view.ThymeleafViewResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 注入视图解析的优先级属性。也可看出允许配置多个视图解析器对象 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;order&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 注入解析视图（前端页面）所用的字符集编码属性 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 注入模板引擎属性 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateEngine&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring5.SpringTemplateEngine&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!-- 注入视图解析策略属性，只解析下述设置的视图 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateResolver&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring5.templateresolver.SpringResourceTemplateResolver&quot;</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!-- 视图前缀：当接收到视图名称时附加的前缀 --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/templates/&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment">&lt;!-- 视图后缀：接收到视图名称时附近的后缀 --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.html&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment">&lt;!-- 注入视图模板模型属性，只处理HTML5的页面 --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateMode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;HTML5&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment">&lt;!-- 注入字符集编码 --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="解析策略说明">解析策略说明</h3>
<ul>
<li>Thymeleaf模板引擎响应页面时，会要求响应页面的<strong>程序</strong>返回<strong>响应的视图名称</strong></li>
<li>视图解析器解析会为返回的<u>视图名称</u><strong>加上</strong>视图解析策略中的<strong>视图前缀和后缀</strong>，从而形成完整的访问路径</li>
<li>模板引擎得到<strong>完整的视图访问</strong>路径后，就可以访问（转发）到该页面，从而进行页面的渲染工作</li>
</ul>
<hr>
<ul>
<li>由于WEB-INF目录下的资源是<strong>不能够被用户直接访问到</strong>的，重定向也不行，只能通过请求的转发</li>
<li>为了<strong>保证所有页面都是通过Thymeleaf模板引擎渲染</strong>，因此一般将<strong>视图前缀设置在WEB-INF目录下</strong></li>
</ul>
<h2 id="首页访问测试">首页访问测试</h2>
<h3 id="创建页面">创建页面</h3>
<ul>
<li>
<p>由于当前thymeleaf设置的<strong>视图前缀</strong>为<code>/WEB-INF/templates/</code>，<strong>视图后缀</strong>为<code>.html</code>，<strong>视图模板属性</strong>为<code>HTM5</code></p>
</li>
<li>
<p>因此在<code>WEB-INF</code>目录下新建一个<code>templates</code>目录，并且在里面创建一个HTML5的index文件</p>
</li>
<li>
<p>在index.html文件上添加<strong>Thymeleaf的命名空间</strong>，<code>xmlns:th=&quot;http://www.thymeleaf.org&quot;</code></p>
<blockquote>
<p>若想使用Thymeleaf语法必须添加Thymeleaf命名空间</p>
</blockquote>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello SpringMVC _yhd<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>工程项目目录</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210805132117.png"
                      alt=""
                ></p>
<ul>
<li>(补充)，在IDEA中，可以通过设置创建文件的模板来实现每次创建HTML5文件时都自动添加上该命名空间</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210805120937.png"
                      alt=""
                ></p>
<h3 id="首页控制方法">首页控制方法</h3>
<h4 id="理论指导">理论指导</h4>
<ul>
<li>由于引入Themleaf模板引擎中设置的视图前缀在<code>WEB-INF</code>目录下，<strong>只能通过请求转发访问</strong></li>
<li>因此<strong>任何一个页面的访问都需要有一个控制方法对应</strong>，通过<strong>请求的转发</strong>到指定页面（或用视图控制器完成）</li>
</ul>
<blockquote>
<p>整合Themleaf模板引擎的环境下，控制方法只需要返回视图名称即可，Themleaf会拼凑视图前后缀进行页面的请求转发访问，包括渲染操作</p>
</blockquote>
<h4 id="响应流程">响应流程</h4>
<ol>
<li>
<p>浏览器通过URL发送请求<span id="jump_responseOrder"></span></p>
</li>
<li>
<p>服务器接收请求后，判断请求URL是否在前端控制器DispatcherServlet的受理范围内（即web.xml中的url-pattern设置）</p>
</li>
<li>
<p>前端控制器读取SpringMVC的核心配置文件，通过扫描组件找到控制器，将请求<strong>URL</strong>和控制器中的控制方法的**@RequestMapping注解的value属性值进行匹配**（因此控制方法名和URL请求无关）</p>
<ul>
<li><strong>若匹配成功</strong>，该控制器方法就是处理请求的方法，最后<strong>返回一个String类型的视图名称</strong>（页面文件名）</li>
<li>若匹配失败，则服务器返回404表示资源找不到</li>
</ul>
</li>
<li>
<p>视图名称会被视图解析器<strong>解析</strong>，即把视图名<strong>加上视图前后缀组成视图的完整访问路径</strong></p>
</li>
<li>
<p>通过视图完整路径<strong>找到目标视图</strong>后对其进行<strong>渲染</strong>，并通过<strong>请求转发展示出来</strong></p>
<blockquote>
<p>注：虽然点击页面后url是发生了改变，但这个改变只是SpringMVC制造的，实际还是请求的转发。因为最终url是没有变到视图的真实网络路径（WEB-INF/template/）下，而且WEB-INF也只有转发能访问得到</p>
</blockquote>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">welcome</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>@RequestMapping中，<code>&quot;/&quot;</code> 是被服务器所解析的，即标识web应用的根目录，即<code>协议://ip（域名）:端口号/项目名（上下文路径）/</code>，如<code>http://localhost:8080/01HelloWorld/</code>，在IDEA中的web应用对应的Tomcat设置中也叫Application Context（上下文路径），而且可任意配置</p>
</blockquote>
<h4 id="配置Tomcat">配置Tomcat</h4>
<ul>
<li>前提IDEA已经配置了Tomcat</li>
<li>在IDEA中创建Tomcat</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210805133911.png"
                      alt=""
                ></p>
<ul>
<li>引入测试项目</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210805133952.png"
                      alt=""
                ></p>
<h4 id="启动Tomcat测试">启动Tomcat测试</h4>
<ul>
<li>在IDEA中点击<kbd>Run</kbd>或者<kbd>Debug</kbd>按钮启动Tomcat和web应用</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210805134532.png"
                      alt=""
                ></p>
<ul>
<li>logback日志输出的相关请求响应信息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">13:36:19.953 [http-nio-8080-exec-4] DEBUG org.springframework.web.servlet.DispatcherServlet - GET &quot;&#x2F;01HelloWorld&#x2F;&quot;, parameters&#x3D;&#123;&#125;</span><br><span class="line">13:36:19.954 [http-nio-8080-exec-4] DEBUG org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping - Mapped to com.company.mvc.controller.HelloController#welcome()</span><br><span class="line">13:36:19.961 [http-nio-8080-exec-4] DEBUG org.springframework.web.servlet.DispatcherServlet - Completed 200 OK</span><br></pre></td></tr></table></figure>
<h2 id="访问页面测试">访问页面测试</h2>
<ul>
<li>需求描述：在上述的首页中添加一个超链接，点击后跳转到指定的页面</li>
</ul>
<h3 id="设置超链接">设置超链接</h3>
<ul>
<li>若想某个属性被Thymeleaf所解析（操作），则就在该属性名前添加<code>th:</code>前缀。此时就可以编写语法</li>
<li>当Thymeleaf检测到以<code>&quot;/&quot;</code>开头的绝对路径格式时候，就会自动为我们添加缺少的上下文路径</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello SpringMVC _yhd<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/target&#125;&quot;</span>&gt;</span>跳转到target页面<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="创建指定页面">创建指定页面</h3>
<ul>
<li>在指定Thymeleaf指定目录下创建一个新的页面，target.html</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Target Page Content<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="创建对应的控制方法">创建对应的控制方法</h3>
<ul>
<li>创建traget.html页面访问的控制方法toTraget()</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">welcome</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/target&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toTarget</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;target&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="测试">测试</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210805140325.png"
                      alt=""
                ></p>
<h2 id="响应流程总结">响应流程总结</h2>
<p><a href="#jump_responseOrder">响应流程总结</a></p>
<h1 id="RequestMapping">@RequestMapping</h1>
<h2 id="功能描述">功能描述</h2>
<ul>
<li>见名知意，@RequestMapping注解用于将请求的<strong>URL</strong>和对应的<strong>控制方法</strong><u>建立映射关系</u></li>
<li>当SpringMVC 接收到指定的请求，就会在这些映射关系中匹配到对应的控制器方法来处理请求</li>
<li>所有控制器的控制方法的**@ReuqestMapping的URL必须唯一**，即<u>不能存在一个URL对应多个控制方法</u>,否则<strong>直接报错</strong></li>
<li>@ReuqestMapping含有多个属性配置，value属性的url是必须配置的，还可以选择用method方式匹配，params请求参数匹配等等多种匹配请求的方式</li>
</ul>
<h2 id="注解可标识位置">注解可标识位置</h2>
<p>@RequestMapping可以标识在<strong>类</strong>（Class）和<strong>方法</strong>（Method）上</p>
<ul>
<li><strong>类</strong>：映射路径的<u>初始信息</u>（路径的<u>前缀部分</u>，常用区分不同访问/功能模块）</li>
<li><strong>方法</strong>：映射路径的<u>具体信息</u></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestMappingController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//此时请求映射所映射的请求的请求路径为：/test/testRequestMapping</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testRequestMapping&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testRequestMapping</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="value属性">value属性</h2>
<h3 id="属性说明">属性说明</h3>
<ul>
<li>value属性用于设置匹配的请求地址URL，且<strong>必须被设置</strong>（其他属性均属可选）</li>
<li>value属性是一个<strong>String[]类型</strong>，表示能够<strong>配置匹配多个请求地址</strong>（满足其一即可匹配）</li>
</ul>
<h3 id="示例代码">示例代码</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &#123;&quot;/testRequestMapping&quot;, &quot;/test&quot;&#125;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testRequestMapping</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ant风格路径">ant风格路径</h3>
<p>在配置value属性时，SpringMVC<strong>支持ant风格</strong>，相当于一种<strong>模糊匹配</strong>风格</p>
<table>
<thead>
<tr>
<th>ant风格字符</th>
<th>含义</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>？</strong></td>
<td>表示任意的单个字符</td>
<td>@RequestMapping(&quot;/a?a/testAnt&quot;)</td>
</tr>
<tr>
<td>*****</td>
<td>表示任意的0个或多个字符</td>
<td>@RequestMapping(&quot;/a*a/testAnt&quot;)</td>
</tr>
<tr>
<td>******</td>
<td>表示任意的0层或多层目录</td>
<td>@RequestMapping(&quot;/aa/**/testAnt&quot;)</td>
</tr>
</tbody>
</table>
<p><strong>注</strong>：在使用**时，只能使用 <code>&quot;/**/xxx&quot;</code> 的方式。<code>&quot;/a**a/xxx&quot;</code>讲认为路径就是两颗*</p>
<h3 id="占位符使用">占位符使用</h3>
<ul>
<li>在value属性设置中使用占位符，<strong>常用于REST风格架构中</strong>（先了解，rest下文有讲述）
<ul>
<li><strong>原始方式</strong>：<code>/deleteUser?id=1</code></li>
<li><strong>rest方式</strong>：<code>/deleteUser/1</code>，即请求参数按一定含义的顺序成为URL结构的一部分进行传输</li>
</ul>
</li>
</ul>
<h4 id="定义rest方式参数">定义rest方式参数</h4>
<p>由于rest方式的URL将请求参数值定义在了请求路径中，因此获取参数的前提需先<strong>定义参数的位置及其含义</strong></p>
<ol>
<li>定义请求参数的位置及其含义
<ol>
<li>将rest方式的完整的URL配置到<code>@RequestMapping</code>中</li>
<li>将<code>@RequestMapping</code>注解中的rest的URL参数部分用<code>&#123;参数名&#125;</code><strong>占位符替代</strong></li>
</ol>
</li>
<li>通过在控制方法添加形参，并在对应数据类型形参上使用<code>@PathVariable</code>注解<strong>绑定占位符中的参数名</strong></li>
</ol>
<h4 id="示例代码-2">示例代码</h4>
<h5 id="请求地址">请求地址</h5>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testRest/1/admin&#125;&quot;</span>&gt;</span>testRest<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="控制方法">控制方法</h5>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testRest/&#123;id&#125;/&#123;username&#125;&quot;)</span> 	<span class="comment">// &quot;/testRest/1/admin&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testRest</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> String id,<span class="meta">@PathVariable(&quot;username&quot;)</span> String username)</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;id: &quot;</span> + id + <span class="string">&quot;，username: &quot;</span> + username);<span class="comment">//1，admin</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注</strong>：rest风格的value属性，存在占位符则访问路径一定有占位符这么多层路径再能匹配到，否则均为404</p>
<ul>
<li><code>http://ip:port/projectName/testRest/</code>：404</li>
<li><code>http://ip:port/projectName/testRest/1/</code>：404</li>
<li><code>http://ip:port/projectName/testRest/1/admin</code>：正确</li>
</ul>
<h2 id="method属性">method属性</h2>
<h3 id="属性说明-2">属性说明</h3>
<ul>
<li>method属性用于设置请求方式匹配的请求映射（设置后即需满足url，又需满足请求方式）</li>
<li>method属性是一个<strong>RequestMethod[]的枚举类型数组</strong>，允许能够匹配多种请求方式的请求</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(</span></span><br><span class="line"><span class="meta">        value = &#123;&quot;/testRequestMapping&quot;, &quot;/test&quot;&#125;,</span></span><br><span class="line"><span class="meta">        method = &#123;RequestMethod.GET, RequestMethod.POST&#125;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testRequestMapping</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：若请求满足请求映射的value属性，但不满足method属性，则浏览器报错<strong>405</strong>：Request method ‘POST’ not supported，<u>表示当前请求类型不支持</u></p>
</blockquote>
<h3 id="派生注解">派生注解</h3>
<ul>
<li>对于处理指定请求方式的控制器方法，<strong>SpringMVC中提供</strong>了@RequestMapping的派生注解（复合注解）</li>
<li>这些派生注解等价于每一个匹配的method属性设置，且<u>能够在此注解上设置value属性</u></li>
</ul>
<table>
<thead>
<tr>
<th>method = RequestMethod.?</th>
<th>派生注解</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>GET</strong></td>
<td>@GetMapping</td>
</tr>
<tr>
<td><strong>POST</strong></td>
<td>@PostMapping</td>
</tr>
<tr>
<td><strong>PUT</strong></td>
<td>@PutMapping</td>
</tr>
<tr>
<td><strong>DELETE</strong></td>
<td>@DeleteMapping</td>
</tr>
<tr>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
<ul>
<li>即要求是GET请求，请求路径还得是 <code>/test</code>的请求示例</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(value = &quot;/test&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="其他请求方式">其他请求方式</h3>
<ul>
<li>常用的请求方式有get，post，put，delete，但目前浏览器只支持get和post</li>
<li>若在form表单提交时，设置了非GET和POST请求（如PUT或DELETE），则<strong>默认以GET方式处理</strong></li>
</ul>
<hr>
<ul>
<li>若要发送PUT和DELETE请求，则需要通过Spring提供的过滤器HiddenHttpMethodFilter，可通过在RESTful实现</li>
<li>此时可以通过对同一个请求资源实现4种不同的请求方式get，post，put，delete，从而达到同一请求资源实现4种不同的功能，如获取信息用get，增加信息用post，修改信息用put，删除信息用delete。其实这种就是<strong>REST架构风格</strong></li>
</ul>
<h2 id="params属性">params属性</h2>
<h3 id="属性含义">属性含义</h3>
<ul>
<li>params属性用于设置<strong>请求参数的名或名值</strong>的匹配映射条件</li>
<li>params属性是一个<strong>String[]类型</strong>，可通过<strong>4种表达式设置</strong>请求参数和请求映射的匹配关系</li>
<li>可以设置多个匹配关系，但与value、method属性不一样，<strong>多个匹配关系必须<u>同时满足</u></strong></li>
</ul>
<table>
<thead>
<tr>
<th>表达式类型</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&quot;param&quot;</code></td>
<td>请求必须<u>包含</u>param请求<strong>参数名</strong></td>
</tr>
<tr>
<td><code>&quot;!param&quot;</code></td>
<td>请求必须<u>不包含</u>param请求<strong>参数名</strong></td>
</tr>
<tr>
<td><code>&quot;param=value&quot;</code></td>
<td>请求必须包含param请求<strong>参数名</strong>且该请求<strong>参数值</strong><u>等于</u>value</td>
</tr>
<tr>
<td><code>&quot;param!=value&quot;</code></td>
<td>请求必须包含param请求<strong>参数名</strong>且该请求<strong>参数值</strong><u>不等于</u>value</td>
</tr>
</tbody>
</table>
<h3 id="示例代码-3">示例代码</h3>
<h4 id="页面请求">页面请求</h4>
<ul>
<li>在<strong>Thymeleaf命名空间下</strong>的HTML文件若使用常规的GET请求参数方式<strong>IDEA会提示错误</strong>，<strong>实际可以运行的</strong></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testParamsAndHeaders?username=admin&amp;password=123&#125;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>若不想看到IDEA的错误提示，可以<strong>改用Thymeleaf方式写</strong>
<ul>
<li>在在参数列表开始处添加一个<code>()</code>括号，把请求参数写入，多个请求参数用<code>,</code>逗号隔开</li>
<li>字符串类型需要用<code>''</code>括起来，数值类型直接书写即可</li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testParamsAndHeaders(username=&#x27;admin&#x27;,password=123)&#125;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="控制方法-2">控制方法</h4>
<ul>
<li>如下示例为：用户请求必须满足value、分别满足method其一，且满足包含username、password请求参数，且password请求参数值不能为123456</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(</span></span><br><span class="line"><span class="meta">        value = &#123;&quot;/testRequestMapping&quot;, &quot;/test&quot;&#125;</span></span><br><span class="line"><span class="meta">        ,method = &#123;RequestMethod.GET, RequestMethod.POST&#125;</span></span><br><span class="line"><span class="meta">        ,params = &#123;&quot;username&quot;,&quot;password!=123456&quot;&#125;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testRequestMapping</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：若当前请求满足@RequestMapping注解的value和method属性，但是不满足params属性，此时页面回报错<strong>400</strong>：Parameter conditions “username, password!=123456” not met for actual request parameters: username={admin}, password={123456}，<u>表示未满足实际请求参数的要求</u></p>
</blockquote>
<h2 id="headers属性">headers属性</h2>
<h3 id="属性说明-3">属性说明</h3>
<ul>
<li>headers属性通过<strong>HTTP请求头</strong>的<strong>键或键值对信息</strong>匹配请求映射（类似params属性的设置）</li>
<li>headers属性是一个<strong>String[]类型</strong>，可以通过<strong>4种表达式设置</strong>请求头信息和请求映射的匹配关系</li>
<li>可以设置多个匹配关系，类似params属性的设置，<strong>多个匹配关系必须<u>同时满足</u></strong></li>
</ul>
<table>
<thead>
<tr>
<th>表达式类型</th>
<th>具体含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&quot;header&quot;</code></td>
<td>请求必须携带header请求头信息</td>
</tr>
<tr>
<td>“!header”</td>
<td>请求必须不能携带header请求头信息</td>
</tr>
<tr>
<td><code>&quot;header=value&quot;</code></td>
<td>请求必须携带header请求头信息，请求头的值为value</td>
</tr>
<tr>
<td>“header!=value”</td>
<td>请求必须携带header请求头信息，请求头的值不为value</td>
</tr>
</tbody>
</table>
<h3 id="示例代码-4">示例代码</h3>
<ul>
<li>类似params属性的使用方式</li>
</ul>
<blockquote>
<p>注：若当前请求满足@RequestMapping注解的value和method属性，但是不满足headers属性，<u>表示此时页面显示404错误，即资源未找到</u></p>
</blockquote>
<h2 id="匹配异常小结">匹配异常小结</h2>
<table>
<thead>
<tr>
<th>匹配属性</th>
<th>状态码</th>
<th>主要异常</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>value</strong></td>
<td>404</td>
<td><strong>Not found</strong> on this server</td>
<td>不存在该资源</td>
</tr>
<tr>
<td><strong>method</strong></td>
<td>405</td>
<td><strong>Request method</strong> ‘[请求方式]’ <strong>not supported</strong></td>
<td>不支持当前请求方式</td>
</tr>
<tr>
<td><strong>params</strong></td>
<td>400</td>
<td><strong>not met for actual request parameters</strong></td>
<td>未满足实际请求参数的要求</td>
</tr>
<tr>
<td><strong>headers</strong></td>
<td>404</td>
<td>the requested resource is <strong>not available</strong></td>
<td>当前请求资源不可用</td>
</tr>
</tbody>
</table>
<h1 id="获取请求参数">获取请求参数</h1>
<h2 id="Servlet-API方式">Servlet-API方式</h2>
<ul>
<li>将HttpServletRequest作为控制器方法的形参，此时<strong>等价原生的Servlet</strong>获取参数方式</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testParam&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testParam</span><span class="params">(HttpServletRequest request)</span></span>&#123;</span><br><span class="line">    String username = request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">    String password = request.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;username:&quot;</span>+username+<span class="string">&quot;,password:&quot;</span>+password);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="同名映射匹配">同名映射匹配</h2>
<h3 id="单属性值">单属性值</h3>
<ul>
<li>在控制器方法的<strong>形参位置</strong>，设置和请求参数<strong>同名的形参</strong></li>
<li>当接收到请求时，DispatcherServlet会将<strong>请求参数赋值给<u>同名</u>的形参</strong></li>
</ul>
<hr>
<ul>
<li>测试的请求链接</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testParam(username=&#x27;admin&#x27;,password=123456)&#125;&quot;</span>&gt;</span>testParam<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>通过同名控制器形参自动匹配获取请求参数</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testParam&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testParam</span><span class="params">(String username, String password)</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;username:&quot;</span>+username+<span class="string">&quot;,password:&quot;</span>+password);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="多属性值">多属性值</h3>
<ul>
<li>像<code>type=checkbox</code>的多选框，同一个请求参数含有多个值的情况。同名匹配有两种获取方式</li>
</ul>
<h4 id="字符串类型获取">字符串类型获取</h4>
<ul>
<li>当将形参设置同名的String参数类型时（一般String类型），返回是以**<u>逗号相隔</u>的多个值拼凑的一个结果**</li>
<li>如：多选框<code>name=hobby</code>，请求链接为<code>hobby=A&amp;hobby=B&amp;hobby=C</code>，获取后的结果是<code>A,B,C</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testParam&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testParam</span><span class="params">(String hobby)</span></span>&#123;</span><br><span class="line">    System.out.println(hobby);<span class="comment">//&quot;A,B,C&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="数组类型获取">数组类型获取</h4>
<ul>
<li>当将同名方法设置为<strong>同名参数的数组类型时</strong>，返回的将时<strong>所有值构成的数组</strong></li>
<li>此时效果类似原生Servlet的<code>String[] getParameterValues(String name)</code>方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testParam&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testParam</span><span class="params">(String[] hobby)</span></span>&#123;</span><br><span class="line">    System.out.println(Arrays.toString(hobby));<span class="comment">//hobby:[A,B,C]</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="自映射匹配">自映射匹配</h2>
<ul>
<li>当像使用新参匹配请求参数方式，又不想被请求参数名约束形参变量名的设置</li>
<li>此时可以通过一些注解，将互不相同的请求参数名和新参参数名进行绑定，构成两者的映射关系</li>
</ul>
<h3 id="RequestParam">@RequestParam</h3>
<ul>
<li>可在控制方法的<u>请求参数形参</u>前使用<code>@RequestParam</code>注解来构建<u><strong>请求参数名</strong>和<strong>形参</strong>的映射关系</u></li>
<li>通过<strong>value或name属性</strong>（两者互为别名）设置<strong>前端请求的参数名</strong></li>
</ul>
<hr>
<ul>
<li><strong>前端测试代码</strong></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;user_name&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>后端测试代码</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testParam&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testParam</span><span class="params">(<span class="meta">@RequestParam(&quot;user_name&quot;)</span> String username)</span></span>&#123;</span><br><span class="line">    System.out.println(username);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="RequestHeader">@RequestHeader</h3>
<ul>
<li>可在控制方法的<u>请求参数形参</u>前使用<code>@RequestHeader</code>注解来构建<u><strong>HTTP请求头</strong>和<strong>形参</strong>的映射关系</u></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testParam&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testParam</span><span class="params">(String username,<span class="meta">@RequestHeader(&quot;Host&quot;)</span> String host)</span></span>&#123;</span><br><span class="line">    System.out.println(host);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="CookieValue">@CookieValue</h3>
<ul>
<li>可在控制方法的<u>请求参数形参</u>前使用<code>@RequestHeader</code>注解来构建<u><strong>Cookie名</strong>和<strong>形参</strong>的映射关系</u></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testParam&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testParam</span><span class="params">(String username,<span class="meta">@CookieValu(&quot;JSESSIONID&quot;)</span> String JSESSIONID)</span></span>&#123;</span><br><span class="line">    System.out.println(JSESSIONID);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="属性解析">属性解析</h3>
<ul>
<li>@ReuqestParam、@RequestHeader及@CookieValue三个注解的属性一样，含义共通</li>
</ul>
<h4 id="value-name">value&amp;name</h4>
<ul>
<li>两者都是设置前端请求参数的属性，两者效果等价，互为别名（@AliasFor）</li>
</ul>
<h4 id="required-defaultValue">required&amp;defaultValue</h4>
<ul>
<li>
<p>用于指定当前@RequestParam所映射的请求参数是否必须在请求中存在</p>
</li>
<li>
<p><strong>required默认为true</strong>，若请求参数不存在，且没有设置defaultValue属性，则报错</p>
<blockquote>
<p>若没有传输该请求参数，且没有设置defaultValue属性，则页面报错400：Required String parameter ‘xxx’ is not present</p>
</blockquote>
</li>
<li>
<p>当将其设置为false时，若请求中不含此请求参数，则使用defaultValue属性值，否则为null</p>
</li>
</ul>
<hr>
<ul>
<li><strong>defaultValue</strong>：不管required属性值为true或false，当value所指定的请求参数<strong>没有传输</strong>或<strong>传输的值为&quot;&quot;时</strong>（空串），均使用defaultValue为形参赋值</li>
</ul>
<table>
<thead>
<tr>
<th>请求参数</th>
<th>required</th>
<th>defaultValue</th>
<th>结果</th>
</tr>
</thead>
<tbody>
<tr>
<td>无</td>
<td><strong>true</strong>（默认）</td>
<td>无</td>
<td>404</td>
</tr>
<tr>
<td>无</td>
<td>true</td>
<td><strong>有</strong></td>
<td>defaultValue</td>
</tr>
<tr>
<td>无</td>
<td><strong>false</strong></td>
<td><strong>无</strong></td>
<td>null</td>
</tr>
<tr>
<td>无</td>
<td>false</td>
<td>有</td>
<td>defaultValue</td>
</tr>
<tr>
<td>有（<strong>空串</strong>）</td>
<td>true/false</td>
<td>有</td>
<td>defaultValue</td>
</tr>
</tbody>
</table>
<h2 id="对象属性映射匹配">对象属性映射匹配</h2>
<ul>
<li>若浏览器传输的<strong>请求参数名</strong>和实体类中的<strong>属性名</strong>一致</li>
<li>可以在控制器方法的形参位置设置一个实体类类型的形参，请求参数就会为此属性赋值并封装</li>
</ul>
<blockquote>
<p>框架中使用反射技术一般都是先用<strong>空参构造器</strong>创建实例，再调用<strong>setter方法</strong>进行属性设置</p>
</blockquote>
<hr>
<ul>
<li><strong>测试前端代码</strong></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/testpojo&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    性别：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;男&quot;</span>&gt;</span>男<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;女&quot;</span>&gt;</span>女<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    年龄：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    邮箱：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>测试bean结构</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//忽略空参构造器和getter setter方法...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>测试控制方法</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testpojo&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testPOJO</span><span class="params">(User user)</span></span>&#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//最终结果--&gt;User&#123;id=null, username=&#x27;张三&#x27;, password=&#x27;123&#x27;, age=23, sex=&#x27;男&#x27;, email=&#x27;123@qq.com&#x27;&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="请求参数的乱码">请求参数的乱码</h2>
<h3 id="GET请求乱码">GET请求乱码</h3>
<p>后端获取带中文的请求参数时，打印显示???，由于<strong>HTTP协议</strong>传输<strong>URL默认编码为iso-8859-1</strong>(兼容ASCII)</p>
<ul>
<li><strong>方案1</strong>：先正确解码，再对应编码</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;获取请求参数</span><br><span class="line">String username &#x3D; req.getParameter(&quot;username&quot;);</span><br><span class="line">&#x2F;&#x2F;先以iso8859-1 解码，再以utf-8进行编码</span><br><span class="line">username &#x3D; new String(username.getBytes(&quot;iso-8859-1&quot;), &quot;UTF-8&quot;);</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>方案2</strong>：修改tomcat收到请求时<strong>url参数的编码方式</strong>
<ul>
<li>打开tomcat安装目录中的<code>conf\server.xml</code>，修改成如下内容</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">connectionTimeout</span>=<span class="string">&quot;20000&quot;</span> <span class="attr">port</span>=<span class="string">&quot;8080&quot;</span> <span class="attr">protocol</span>=<span class="string">&quot;HTTP/1.1&quot;</span> <span class="attr">redirectPort</span>=<span class="string">&quot;8443&quot;</span> <span class="attr">URIEncoding</span>=<span class="string">&quot;UTF-8&quot;</span> <span class="attr">useBodyEncodingForURI</span>=<span class="string">&quot;true&quot;</span>/&gt;</span> </span><br></pre></td></tr></table></figure>
<h3 id="POST请求乱码">POST请求乱码</h3>
<h4 id="原生方法（无效）">原生方法（无效）</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//一定要在获取请求参数前设置，一旦获取了请求参数后设置无效</span></span><br><span class="line">request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>由于原生Servlet的方式解决POST请求乱码的前提是必须在<strong>获取请求参数前调用才生效</strong></li>
<li>SpringMVC的DispatcherServlet统一管理了所有请求和响应，已经把参数获取了，因此上述方法<strong>无法生效</strong></li>
</ul>
<blockquote>
<p>因此必须在DispatcherServlet执行前执行才有效，一般选用<strong>过滤器</strong></p>
</blockquote>
<h4 id="过滤器方式">过滤器方式</h4>
<ul>
<li>在SpringMVC中，只有监听器和过滤器会在DispatcherServlet之前执行，且过滤器能处理每个请求</li>
<li>同时SpringMVC已经提供了<strong>现成的</strong>基于过滤器实现的字符编码设置，只需要在SpringMVC中<strong>配置即可</strong></li>
</ul>
<h5 id="源码分析">源码分析</h5>
<ul>
<li>SpringMVC提供的编码过滤器为<code>org.springframework.web.filter.CharacterEncodingFilter</code></li>
<li>真正实现过滤器接口的是其间接抽象父类<code>GenericFilterBean</code>，直接父类<code>OncePerRequestFilter</code>实现<code>doFilter()</code>方法，且调用了<code>doFilterInternal()</code>方法</li>
<li><code>doFilterInternal()</code>方法由编码过滤器CharacterEncodingFilter重写，因此核心代码在此</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doFilterInternal</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取CharacterEncodingFilter的encoding属性，默认为null</span></span><br><span class="line">    String encoding = getEncoding();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//若没设置encoding属性，则直接放行，即按默认的字符编码集请求和响应</span></span><br><span class="line">    <span class="keyword">if</span> (encoding != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">//当设置了forceRequestEncoding(Boolean属性)，或encoding属性由被设置</span></span><br><span class="line">        <span class="comment">//就会触发设置【请求】编码字符集，且将encoding属性设置为编码集</span></span><br><span class="line">        <span class="keyword">if</span> (isForceRequestEncoding() || request.getCharacterEncoding() == <span class="keyword">null</span>) &#123;</span><br><span class="line">            request.setCharacterEncoding(encoding);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//只有设置forceResponseEncoding(Boolean属性)为true，且将encoding属性设置为编码集</span></span><br><span class="line">        <span class="keyword">if</span> (isForceResponseEncoding()) &#123;</span><br><span class="line">            <span class="comment">//设置相应编码字符集</span></span><br><span class="line">            response.setCharacterEncoding(encoding);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    filterChain.doFilter(request, response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>结论</strong>：
<ul>
<li>设置<strong>请求</strong>编码集：只需要设置encoding属性即可</li>
<li>设置<strong>响应编</strong>码集：需同时设置encoding属性和forceResponseEncoding=true</li>
</ul>
</li>
</ul>
<h5 id="设置编码过滤器">设置编码过滤器</h5>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置springMVC的编码过滤器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 设置请求编码 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 设置响应编码 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceResponseEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="域对象数据共享">域对象数据共享</h1>
<h2 id="Request域共享">Request域共享</h2>
<h3 id="原生Servlet方式">原生Servlet方式</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testServletAPI&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testServletAPI</span><span class="params">(HttpServletRequest request)</span></span>&#123;</span><br><span class="line">    request.setAttribute(<span class="string">&quot;testScope&quot;</span>, <span class="string">&quot;hello,servletAPI&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ModelAndView方式">ModelAndView方式</h3>
<ul>
<li>
<p>该方式属于<strong>自定义</strong>（<strong>创建</strong>）<strong>一个是ModelAndView对象返回</strong>。<strong>Model</strong>和<strong>View</strong>两个功能的<strong>结合体</strong></p>
<ul>
<li>Model（<strong>Object</strong>）：主要用于向请求域共享数据</li>
<li>View（<strong>ViewName</strong>）：主要用于设置视图，实现页面跳转</li>
</ul>
</li>
<li>
<p>以下的SpringMVC<strong>所有响应方式</strong>（含域数据共享）最终都将封装成<strong>ModelAndView</strong>对象响应</p>
</li>
</ul>
<hr>
<ol>
<li>使用<strong>ModelAndView</strong>需要将其类型作为<strong>控制方法的返回类型</strong></li>
<li>在控制方法中创建ModelAndView对象，并设置域对象数据和返回的视图名称数据</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testModelAndView&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">testModelAndView</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ModelAndView mav = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">    <span class="comment">//向request域设置共享数据</span></span><br><span class="line">    mav.addObject(<span class="string">&quot;testScope&quot;</span>, <span class="string">&quot;hello,ModelAndView&quot;</span>);</span><br><span class="line">    <span class="comment">//设置视图，实现页面跳转</span></span><br><span class="line">    mav.setViewName(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> mav;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>前端<strong>Thymeleaf</strong>获取request域（Thymeleaf对任何html属性修改都是在html属性前加<code>th:</code>前缀）</li>
<li>修改文本域对应html属性为text</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;testScope&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Map方式">Map方式</h3>
<ul>
<li>当DispatcherServlet检测到控制方法的<strong>形参为Map类型</strong>时统一<strong>让BindingAwareModelMap作为其实现类</strong></li>
<li>用户可以选择BindingAwareModelMap的<strong>不同形态</strong>（多态）<strong>去接收其实现类</strong>，来进行请求域数据的添加</li>
<li>常用的接收BindingAwareModelMap实现类的上层结构有，<strong>Map、Model接口和ModelMap间接父类</strong></li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/BindingAwareModelMap-API-Tree.png"
                      alt=""
                ></p>
<h4 id="Model方式">Model方式</h4>
<ul>
<li>传入实现类均为BindingAwareModelMap</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testModel&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testModel</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line">    model.addAttribute(<span class="string">&quot;testScope&quot;</span>, <span class="string">&quot;hello,Model&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Map方式-2">Map方式</h4>
<ul>
<li>传入实现类均为BindingAwareModelMap</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testMap&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testMap</span><span class="params">(Map&lt;String, Object&gt; map)</span></span>&#123;</span><br><span class="line">    map.put(<span class="string">&quot;testScope&quot;</span>, <span class="string">&quot;hello,Map&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ModelMap方式">ModelMap方式</h4>
<ul>
<li>传入实现类均为BindingAwareModelMap</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testModelMap&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testModelMap</span><span class="params">(ModelMap modelMap)</span></span>&#123;</span><br><span class="line">    modelMap.addAttribute(<span class="string">&quot;testScope&quot;</span>, <span class="string">&quot;hello,ModelMap&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Session域共享">Session域共享</h2>
<ul>
<li>SpringMVC提供了一个<code>@SessionAttribute</code>注解使用session，但<strong>建议使用</strong>形参引入HttpSession对象方式</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testSession&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testSession</span><span class="params">(HttpSession session)</span></span>&#123;</span><br><span class="line">    session.setAttribute(<span class="string">&quot;testSessionScope&quot;</span>, <span class="string">&quot;hello,session&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Thymeleaf方式获取session域对象数据</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;session.testSessionScope&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Application域共享">Application域共享</h2>
<ul>
<li>获取<strong>Application域对象就是ServletContext对象</strong>，获取<strong>方式很多</strong>（下述为session对象中获取）
<ul>
<li>request、session对象获取</li>
<li>servletConfig对象获取</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testApplication&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testApplication</span><span class="params">(HttpSession session)</span></span>&#123;</span><br><span class="line">	ServletContext application = session.getServletContext();</span><br><span class="line">    application.setAttribute(<span class="string">&quot;testApplicationScope&quot;</span>, <span class="string">&quot;hello,application&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="SpringMVC视图">SpringMVC视图</h1>
<ul>
<li>
<p>SpringMVC中的视图是View接口，视图的作用渲染数据，将模型Model中的数据展示给用户</p>
</li>
<li>
<p>SpringMVC视图的种类很多，默认有转发视图和重定向视图</p>
<ul>
<li><strong>转发视图</strong>：InternalResourceView（返回视图名称含<code>forward</code>）</li>
<li><strong>重定向视图</strong>：RedirectView（返回视图名称含<code>redirect</code>）</li>
<li><strong>使用JSTL技术</strong>：JstlView将会成为转发视图InternalResourceView的实现对象</li>
<li><strong>使用Thymeleaf技术</strong>：配置的Thymeleaf视图解析器解析之后得到的是ThymeleafView（无前缀时）</li>
</ul>
</li>
</ul>
<h2 id="ThymeleafView">ThymeleafView</h2>
<h3 id="基本原理">基本原理</h3>
<ul>
<li>当控制器方法中所设置的视图名称<strong>没有任何前缀时</strong></li>
<li>此时的<strong>视图名称</strong>会直接被SpringMVC配置文件中所配置的<strong>视图解析器解析</strong></li>
<li>视图名称拼接视图前缀和视图后缀所得到的最终路径，会通过**<u>请求转发</u>的方式实现跳转**</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testHello&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testHello</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>返回Dispatcher返回的是<strong>ThymeleafView对象</strong></li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/img002.png"
                      alt=""
                ></p>
<h3 id="解析过程">解析过程</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210807212924.png"
                      alt=""
                ></p>
<h2 id="转发视图">转发视图</h2>
<h3 id="基本原理-2">基本原理</h3>
<ul>
<li>
<p>SpringMVC中默认的<strong>转发视图</strong>是<strong>InternalResourceView</strong>（正确来说成为内部资源访问视图）</p>
</li>
<li>
<p>当控制器方法中所设置的视图名称以&quot;<code>forward:</code>&quot;为<strong>前缀时</strong>，创建InternalResourceView视图</p>
</li>
<li>
<p>此时视图名称<strong>不会被视图解析器解析</strong>，而是<strong>内部进行</strong>一次请求<strong>转发操作</strong>，<u>再一次被前端控制器处理</u></p>
</li>
<li>
<p>响应时会将前缀&quot;<code>forward:</code>&quot;<strong>去掉</strong>，<strong>剩余部分作为最终路径</strong>（不用进行视图前后缀拼接）且通过转发的方式实现跳转</p>
<hr>
</li>
<li>
<p><strong>应用场景</strong>：这种转发一般不用于转发页面，<strong><u>常用于转发到另一个Servlet</u></strong>（控制方法）上</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testForward&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testForward</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;forward:/testHello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>返回InternalResourceView对象</strong></li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/img003.png"
                      alt=""
                ></p>
<h3 id="解析过程-2">解析过程</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210807213020.png"
                      alt=""
                ></p>
<h2 id="重定向视图">重定向视图</h2>
<h3 id="基本原理-3">基本原理</h3>
<ul>
<li>
<p>SpringMVC中默认的重定向视图是<strong>RedirectView</strong></p>
</li>
<li>
<p>当控制器方法中所设置的视图名称以&quot;<code>redirect:</code>&quot;为前缀时，创建RedirectView视图</p>
</li>
<li>
<p>此时的视图名称<strong>不会被</strong>配置文件中所配置的<strong>视图解析器解析</strong>，而是直接重定向浏览器，让浏览器发球第二个请求</p>
</li>
<li>
<p>而是会将前缀&quot;<code>redirect:</code>&quot;<strong>去掉</strong>，<strong>剩余部分作为最终路径</strong>（不用进行视图前后缀拼接）通过转发的方式实现跳转</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testRedirect&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testRedirect</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/testHello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>返回RedirectView对象</strong></li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/img004.png"
                      alt=""
                ></p>
<h3 id="解析过程-3">解析过程</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210807213114.png"
                      alt=""
                ></p>
<h2 id="归纳与总结">归纳与总结</h2>
<h3 id="归纳">归纳</h3>
<ul>
<li>
<p><strong>ThymeleafView</strong></p>
<ul>
<li><strong>出现背景</strong>：视图名称不含任何前缀时（<code>forward:</code>、<code>redirect:</code>），仅表示视图名称</li>
<li><strong>解析过程</strong>：响应时，将视图名称<u>直接提交给视图解析器</u>，<u>拼接视图前后缀</u>得出最终访问路径，随后通过<u>转发访问</u></li>
<li><strong>应用场景</strong>：请求<strong>转发</strong>的<u>目标是<strong>页面</strong></u></li>
</ul>
</li>
<li>
<p><strong>InternalResourceView</strong></p>
<ul>
<li><strong>出现背景</strong>：视图名称含<code>forward:</code>前缀，此时前缀后面就是转发访问的最终路径</li>
<li><strong>解析过程</strong>：响应时，去除视图名称的<code>forward:</code>前缀，将剩余部分直接作为最终路径转发访问</li>
<li><strong>应用场景</strong>：请求<strong>转发</strong>的<u>目标是<strong>下一个请求/页面</strong></u>（Servlet、控制方法、链接等）</li>
</ul>
<blockquote>
<p>其实能访问下一个请求，就等同于能访问页面，因为SpringMVC中使用Thymeleaf作为视图解析器的所有页面都需要有对应的控制方法才能内部转发访问得到（WEB-INF）</p>
</blockquote>
</li>
<li>
<p><strong>RedirectView</strong></p>
<ul>
<li><strong>出现背景</strong>：视图名称含<code>redirect:</code>前缀，此时前缀后面就是转发访问的最终路径</li>
<li><strong>解析过程</strong>：响应时，去除视图名称的<code>redirect:</code>前缀，将剩余部分直接作为最终路径转发访问</li>
<li><strong>应用场景</strong>：请求<strong>重定向</strong>的<u>目标是<strong>下一个请求/页面</strong></u>（Servlet、控制方法、链接等）</li>
</ul>
<blockquote>
<p>同理请求等价于页面，由于SpringMVC中使用Thymeleaf作为视图解析器的所有页面都需要有对应的控制方法（请求）才能内部转发访问得到（WEB-INF）</p>
</blockquote>
</li>
</ul>
<table>
<thead>
<tr>
<th>视图名称</th>
<th>请求类型</th>
<th>下一跳（响应后）</th>
<th>最终访问路径</th>
</tr>
</thead>
<tbody>
<tr>
<td>viewName</td>
<td>转发</td>
<td>视图解析器</td>
<td>视图前缀 + viewName + 视图后缀</td>
</tr>
<tr>
<td>forward:/absPath</td>
<td>转发</td>
<td>前端控制器</td>
<td>/（web根目录）+ absPath</td>
</tr>
<tr>
<td>redirect:/absPath</td>
<td>重定向</td>
<td>浏览器</td>
<td>/（web根目录）+ absPath</td>
</tr>
</tbody>
</table>
<h3 id="总结">总结</h3>
<ul>
<li>请求<strong>转发</strong>到<strong>页面</strong>，不加前缀</li>
<li>请求<strong>转发</strong>到<strong>下一个请求</strong>，加<code>forward:</code>前缀，并再后面添加要访问<strong>请求的绝对路径</strong></li>
<li>请求<strong>重定向</strong>，加<code>redirect:</code>前缀，并再后面添加要访问<strong>重定向的绝对路径</strong></li>
</ul>
<h2 id="视图控制器">视图控制器</h2>
<ul>
<li>
<p>当没有任何请求处理，只完成页面映射功能时候，可通过配置的方式在视图控制器上设置视图名称</p>
</li>
<li>
<p>在SpringMVC中配置视图控制器时需要引入<code>mvc</code>的<strong>XML命名空间</strong></p>
</li>
<li>
<p>注意在使用视图控制器时，一般需要<strong>开启MVC的注解驱动</strong>，否则所配置页面上所有链接请求将失效</p>
<blockquote>
<p>开启mvc注解驱动除上述功能外还有：对静态资源的访问、java转换json对象等都需要</p>
</blockquote>
</li>
</ul>
<hr>
<ul>
<li>将首页访问通过视图控制器配置</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	path：设置处理的请求地址</span></span><br><span class="line"><span class="comment">	view-name：设置请求地址所对应的视图名称</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:view-controller</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">view-name</span>=<span class="string">&quot;index&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:view-controller</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 开启MVC的注解驱动，否则视图控制器配置的访问页上所有链接请求将失效 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="JSP引入示例">JSP引入示例</h2>
<h3 id="配置JSP视图解析器">配置JSP视图解析器</h3>
<ul>
<li>JSP被SpringMVC处理时<u>无论有没有转发前缀，都是内部再发起一次请求</u>转发的效果</li>
<li>因此配置JSP视图解析器，<strong>只需要配置InternalResourcesView即可</strong>（在SpringMVC配置中设置）</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/templates/&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tomcat默认启动访问 index.html、index.htm、index.jsp</p>
</blockquote>
<h1 id="RESTFul">RESTFul</h1>
<h2 id="REST简介">REST简介</h2>
<ul>
<li><strong>REST</strong>，<strong>Re</strong>presentational <strong>S</strong>tate <strong>T</strong>ransfer，称为<strong>表现层资源状态转移</strong>，是一种软件架构的风格</li>
<li><strong>RESTFul</strong>，译未”Rest的…“表示，基于REST构建的API，或叫遵守了REST原则的web服务</li>
</ul>
<h3 id="资源">资源</h3>
<p>（未理解）资源是一种看待服务器的方式，即，将服务器看作是由很多离散的资源组成。每个资源是服务器上一个可命名的抽象概念。因为资源是一个抽象的概念，所以它不仅仅能代表服务器文件系统中的一个文件、数据库中的一张表等等具体的东西，可以将资源设计的要多抽象有多抽象，只要想象力允许而且客户端应用开发者能够理解。与面向对象设计类似，资源是以名词为核心来组织的，首先关注的是名词。一个资源可以由一个或多个URI来标识。URI既是资源的名称，也是资源在Web上的地址。对某个资源感兴趣的客户端应用，可以通过资源的URI与其进行交互。</p>
<h3 id="资源表述">资源表述</h3>
<p>（未理解）资源的表述是一段对于资源在某个特定时刻的状态的描述。可以在客户端-服务器端之间转移（交换）。资源的表述可以有多种格式，例如HTML/XML/JSON/纯文本/图片/视频/音频等等。资源的表述格式可以通过协商机制来确定。请求-响应方向的表述通常使用不同的格式。</p>
<h3 id="状态转移">状态转移</h3>
<p>（未理解）状态转移说的是：在客户端和服务器端之间转移（transfer）代表资源状态的表述。通过转移和操作资源的表述，来间接实现操作资源的目的。</p>
<h2 id="RestFul的实现">RestFul的实现</h2>
<h3 id="参数传递">参数传递</h3>
<p>REST 风格提倡 URL 地址使用统一的风格设计</p>
<ul>
<li>URL个参数值使用斜杠分开，不使用问号键值对方式携带请求参数</li>
<li>将要发送给服务器的数据作为URL 地址的一部分，以保证整体风格的一致性</li>
</ul>
<h3 id="操作方式">操作方式</h3>
<p>HTTP协议中，分别表示4种基本操作的请求方式：<strong>GET、POST、PUT、DELETE</strong></p>
<ul>
<li>GET：用来获取资源</li>
<li>POST：用来新建资源</li>
<li>PUT： 用来更新资源</li>
<li>DELETE： 用来删除资源</li>
</ul>
<table>
<thead>
<tr>
<th>操作</th>
<th>传统方式（URL）</th>
<th>REST风格（URL）</th>
</tr>
</thead>
<tbody>
<tr>
<td>查询操作</td>
<td>getUserById?id=1</td>
<td>user/1（GET请求方式）</td>
</tr>
<tr>
<td>保存操作</td>
<td>saveUser</td>
<td>user（POST请求方式）</td>
</tr>
<tr>
<td>删除操作</td>
<td>deleteUser?id=1</td>
<td>user/1（DELETE请求方式）</td>
</tr>
<tr>
<td>更新操作</td>
<td>updateUser</td>
<td>user（PUT请求方式）</td>
</tr>
</tbody>
</table>
<h3 id="请求方式实现">请求方式实现</h3>
<ul>
<li>
<p>由于目前浏览器只支持发送GET和POST方式的请求，那么该如何发送PUT和DELETE请求呢？</p>
</li>
<li>
<p>SpringMVC 提供 <strong>HiddenHttpMethodFilter过滤器</strong> 实现将<strong>POST请求</strong>转换为<strong>DELETE 或PUT</strong>请求</p>
</li>
</ul>
<h4 id="源码分析-2">源码分析</h4>
<ul>
<li><strong>HiddenHttpMethodFilter</strong>过滤器执行过滤的方法体doFilterInternal()源码分析</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doFilterInternal</span><span class="params">(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">    HttpServletRequest requestToUse = request;<span class="comment">//将当前被拦截的HTTP请求对象暂存</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//如果当前拦截的请求方式是POST，且xxx（忽略、保证==null，默认就为true）</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;POST&quot;</span>.equals(request.getMethod()) &amp;&amp; </span><br><span class="line">        request.getAttribute(WebUtils.ERROR_EXCEPTION_ATTRIBUTE) == <span class="keyword">null</span>) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//尝试获取请求参数名为methodParam（&quot;_method&quot;）的值（一般输入其他请求方式）</span></span><br><span class="line">        String paramValue = request.getParameter(<span class="keyword">this</span>.methodParam);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//hasLength()函数，表示如果存在长度，即该字符串若不为空</span></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.hasLength(paramValue)) &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//将请求参数名为&quot;_method&quot;的值（其他请求方式，如PUT、DELETE）转换为大写</span></span><br><span class="line">            String method = paramValue.toUpperCase(Locale.ENGLISH);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//如果请求方式字符串，包含在ALLOWED_METHODS内（List、含PUT、DELETE、PATCH）</span></span><br><span class="line">            <span class="keyword">if</span> (ALLOWED_METHODS.contains(method)) &#123;</span><br><span class="line">                <span class="comment">//则使用HttpMethodRequestWrapper重新包装请求方式（请求对象不变）</span></span><br><span class="line">                requestToUse = <span class="keyword">new</span> HttpMethodRequestWrapper(request, method);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//使用新的requestToUse作为请求参数对象传入</span></span><br><span class="line">    filterChain.doFilter(requestToUse, response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>HttpMethodRequestWrapper</strong>源码分析（<strong>妙</strong>，有设计上的学习价值）</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//继承的父类HttpServletRequestWrapper是Servlet-API提供的</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpMethodRequestWrapper</span> <span class="keyword">extends</span> <span class="title">HttpServletRequestWrapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String method;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//这里妙在，通过继承 + 重写的方式，实现了即不用改变对象类型，又实现了方法定制的效果</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HttpMethodRequestWrapper</span><span class="params">(HttpServletRequest request, String method)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(request);</span><br><span class="line">        <span class="keyword">this</span>.method = method;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//仅对getMethod()方法进行重写，因此后来的request对象都调用该重写的方法</span></span><br><span class="line">    <span class="comment">//实现了调用getMethod重写方法时，调用的是HttpMethodRequestWrapper传入的method值</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.method;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="使用总结">使用总结</h4>
<p>HiddenHttpMethodFilter过滤器使用PUT、DELETE等非GET/POST请求总结</p>
<ol>
<li>发起的请求类型必须是POST</li>
<li>在POST请求参数中添加<u>请求参数</u><strong>名</strong>为&quot;<strong>_method</strong>&quot;，<strong>值</strong>为后端真正处理时的请求方式（不分大小写）</li>
<li>在web.xml中配置<strong>受理所有请求</strong>的HiddenHttpMethodFilter过滤器</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="PUT方式">PUT方式</h5>
<ul>
<li>前端页面，POST请求目前一般只能由form表单和ajax这些异步请求自定义发起请求方式实现</li>
<li>因此一般使用form表单，并将<code>_method</code>属性设置称为<strong>隐藏域</strong></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/testPut&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    put：username: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;_method&quot;</span> <span class="attr">value</span>=<span class="string">&quot;PUT&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="DELETE方式">DELETE方式</h5>
<ul>
<li>由于一般删除操作都是超链接，但使用隐藏请求方式又需要发起POST请求</li>
<li>因此采取的策略是：通过超链接事件去控制一个外部的form表单并且使其提交即可</li>
</ul>
<h3 id="编码过滤器优先">编码过滤器优先</h3>
<ul>
<li>若项目中<strong>同时设置</strong>了<u>编码过滤器</u>（CharacterEncodingFilter）和<u>HiddenHttpMethodFilter过滤器</u></li>
<li>则必须让编码过滤器先执行，即在web.xml中，编码过滤器的<strong>编码配置需在前</strong></li>
</ul>
<blockquote>
<p>XX原因在于：HiddenHttpMethodFilter内部调用了request.getParameter()方法，会使编码过滤器的设置失效</p>
</blockquote>
<h2 id="RESTFul案例">RESTFul案例</h2>
<h3 id="功能清单">功能清单</h3>
<table>
<thead>
<tr>
<th>功能</th>
<th>URL 地址</th>
<th>请求方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>访问首页√</td>
<td>/</td>
<td>GET</td>
</tr>
<tr>
<td>查询全部数据√</td>
<td>/employee</td>
<td>GET</td>
</tr>
<tr>
<td>删除√</td>
<td>/employee/2</td>
<td>DELETE</td>
</tr>
<tr>
<td>跳转到添加数据页面√</td>
<td>/toAdd</td>
<td>GET</td>
</tr>
<tr>
<td>执行保存√</td>
<td>/employee</td>
<td>POST</td>
</tr>
<tr>
<td>跳转到更新数据页面√</td>
<td>/employee/2</td>
<td>GET</td>
</tr>
<tr>
<td>执行更新√</td>
<td>/employee</td>
<td>PUT</td>
</tr>
</tbody>
</table>
<h3 id="基本架构">基本架构</h3>
<h4 id="数据访问层">数据访问层</h4>
<h5 id="实体bean">实体bean</h5>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.mvc.bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> Integer id;</span><br><span class="line">   <span class="keyword">private</span> String lastName;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> String email;</span><br><span class="line">   <span class="comment">//1 male, 0 female</span></span><br><span class="line">   <span class="keyword">private</span> Integer gender;</span><br><span class="line">     </span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">(Integer id, String lastName, String email, Integer gender)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">super</span>();</span><br><span class="line">      <span class="keyword">this</span>.id = id;</span><br><span class="line">      <span class="keyword">this</span>.lastName = lastName;</span><br><span class="line">      <span class="keyword">this</span>.email = email;</span><br><span class="line">      <span class="keyword">this</span>.gender = gender;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//此处省略getter和setter方法，以及toString方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="DAO及数据模拟">DAO及数据模拟</h5>
<ul>
<li>创建对应DAO对象及其在内部模拟数据库数据</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//数据模拟部分</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;Integer, Employee&gt; employees = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        employees = <span class="keyword">new</span> HashMap&lt;Integer, Employee&gt;();</span><br><span class="line"></span><br><span class="line">        employees.put(<span class="number">1001</span>, <span class="keyword">new</span> Employee(<span class="number">1001</span>, <span class="string">&quot;E-AA&quot;</span>, <span class="string">&quot;aa@163.com&quot;</span>, <span class="number">1</span>));</span><br><span class="line">        employees.put(<span class="number">1002</span>, <span class="keyword">new</span> Employee(<span class="number">1002</span>, <span class="string">&quot;E-BB&quot;</span>, <span class="string">&quot;bb@163.com&quot;</span>, <span class="number">1</span>));</span><br><span class="line">        employees.put(<span class="number">1003</span>, <span class="keyword">new</span> Employee(<span class="number">1003</span>, <span class="string">&quot;E-CC&quot;</span>, <span class="string">&quot;cc@163.com&quot;</span>, <span class="number">0</span>));</span><br><span class="line">        employees.put(<span class="number">1004</span>, <span class="keyword">new</span> Employee(<span class="number">1004</span>, <span class="string">&quot;E-DD&quot;</span>, <span class="string">&quot;dd@163.com&quot;</span>, <span class="number">0</span>));</span><br><span class="line">        employees.put(<span class="number">1005</span>, <span class="keyword">new</span> Employee(<span class="number">1005</span>, <span class="string">&quot;E-EE&quot;</span>, <span class="string">&quot;ee@163.com&quot;</span>, <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Integer initId = <span class="number">1006</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//DAO部分</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(Employee employee)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(employee.getId() == <span class="keyword">null</span>)&#123;</span><br><span class="line">            employee.setId(initId++);</span><br><span class="line">        &#125;</span><br><span class="line">        employees.put(employee.getId(), employee);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection&lt;Employee&gt; <span class="title">getAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> employees.values();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Employee <span class="title">get</span><span class="params">(Integer id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> employees.get(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Integer id)</span></span>&#123;</span><br><span class="line">        employees.remove(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="业务逻辑层">业务逻辑层</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmployeeDao employeeDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//各种业务对应的控制方法...</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="首页访问">首页访问</h3>
<ul>
<li>直接使用视图控制器配置即可</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:view-controller</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">view-name</span>=<span class="string">&quot;index&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 仅需添加一次 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="查询所有员工数据">查询所有员工数据</h3>
<h4 id="前端代码">前端代码</h4>
<h5 id="发起请求">发起请求</h5>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/employee&#125;&quot;</span>&gt;</span>查看所有数据<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="数据展示页">数据展示页</h5>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thyemleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>employee_list<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;5&quot;</span>&gt;</span>Employee Info<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>id<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>lastName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>option<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">&quot;employee : $&#123;employeeList&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;employee.id&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;employee.lastName&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;employee.email&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;employee.gender&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>delete<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>update<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="控制器代码">控制器代码</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/employee&quot;,method = RequestMethod.GET)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">getAllEmployee</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Collection&lt;Employee&gt; employeeList = employeeDao.getAll();</span><br><span class="line">    ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">    modelAndView.addObject(<span class="string">&quot;employeeList&quot;</span>,employeeList);</span><br><span class="line">    modelAndView.setViewName(<span class="string">&quot;employee_list&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> modelAndView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="删除操作">删除操作</h3>
<h4 id="发起请求代码">发起请求代码</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">&quot;employee : $&#123;employeeList&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;employee.id&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;employee.lastName&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;employee.email&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;employee.gender&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- vue方式绑定点击事件 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> @<span class="attr">click</span>=<span class="string">&quot;deleteEmployee&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/employee/&#125;+$&#123;employee.id&#125;&quot;</span>&gt;</span>delete<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">		方式2（带单引号嵌入）：&lt;a th:href=&quot;@&#123;&#x27;/employee/&#x27;+$&#123;employee.id&#125;&#125;&quot;&gt;delete&lt;/a&gt;</span></span><br><span class="line"><span class="comment">		--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>update<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="vue实现表单提交">vue实现表单提交</h4>
<h5 id="引入vue-js资源">引入vue.js资源</h5>
<ul>
<li><a href="#jump_staticResources">SpringMVC静态资源引入过程</a></li>
</ul>
<h5 id="编写事件代码">编写事件代码</h5>
<ul>
<li>配合SpringMVC的HiddenHttpMethodFilter设置超链接触发提交的隐含请求转换的post请求表单</li>
<li>实际是向后端<strong>发起delete请求</strong></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 用于超链接触发的form表单提交 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;deleteForm&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;_method&quot;</span> <span class="attr">value</span>=<span class="string">&quot;delete&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>vue实现超链接触发表单提交请求</strong>
<ul>
<li>为table标签添加id属性：<code>&lt;table id=&quot;dataTable&quot;&gt;</code></li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 使用vue.js实现、使用javascript也行 --&gt;</span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span> th:src=<span class="string">&quot;@&#123;/static/js/vue.js&#125;&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    <span class="keyword">var</span> vue = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el:<span class="string">&quot;#dataTable&quot;</span>,    <span class="comment">//设置容器</span></span><br><span class="line">        methods:&#123;</span><br><span class="line">            deleteEmployee:<span class="function"><span class="keyword">function</span> (<span class="params">event</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">var</span> deleteForm = <span class="built_in">document</span>.getElementById(<span class="string">&quot;deleteForm&quot;</span>);</span><br><span class="line">                <span class="comment">//将事件的超链接href属性设置到form表单中</span></span><br><span class="line">                deleteForm.action = event.target.href;</span><br><span class="line">                deleteForm.submit();<span class="comment">//通过submit方法提交表单</span></span><br><span class="line">                event.preventDefault();<span class="comment">//取消超链接的默认行为</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h4 id="控制方法-3">控制方法</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping(&quot;/employee/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">deleteEmployee</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span>&#123;</span><br><span class="line">    employeeDao.delete(id);</span><br><span class="line">    <span class="comment">//通过重定向视图回访到员工页面（实际需调用请求加载数据）</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/employee&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="保存操作">保存操作</h3>
<h4 id="添加页面">添加页面</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thyemleaf.org&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>employee_add<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/employee&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">            lastName: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;lastName&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            email: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            gender: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span>male</span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span>&gt;</span>female <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;add&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="跳转到添加页">跳转到添加页</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:view-controller</span> <span class="attr">path</span>=<span class="string">&quot;/toAdd&quot;</span> <span class="attr">view-name</span>=<span class="string">&quot;employee_add&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="执行保存">执行保存</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/employee&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">addEmployee</span><span class="params">(Employee employee)</span></span>&#123;</span><br><span class="line">    employeeDao.save(employee);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/employee&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="更新操作">更新操作</h3>
<h4 id="更新页面">更新页面</h4>
<ul>
<li>含一般数据显示，单选按钮选择<code>th:field</code>，此时值为1或true会自定添加<code>checked</code>属性被选中</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thyemleaf.org&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>employee_update<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/employee&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;_method&quot;</span> <span class="attr">value</span>=<span class="string">&quot;put&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;employee.id&#125;&quot;</span>&gt;</span></span><br><span class="line">            lastName: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;lastName&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;employee.lastName&#125;&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            email: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;employee.email&#125;&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            gender: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> <span class="attr">th:field</span>=<span class="string">&quot;$&#123;employee.gender&#125;&quot;</span>&gt;</span>male</span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> <span class="attr">th:field</span>=<span class="string">&quot;$&#123;employee.gender&#125;&quot;</span>&gt;</span>female <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;update&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="跳转到更新页">跳转到更新页</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/employee/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getEmployee</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id, Model model)</span></span>&#123;</span><br><span class="line">    Employee employee = employeeDao.get(id);</span><br><span class="line">    model.addAttribute(<span class="string">&quot;employee&quot;</span>,employee);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;employee_update.html&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="执行更新">执行更新</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PutMapping(&quot;/employee&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">updateEmployee</span><span class="params">(Employee employee)</span></span>&#123;</span><br><span class="line">    employeeDao.save(employee);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/employee&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="静态资源访问">静态资源访问</h1>
<p>SpringMVC中引用静态资源需要一些相关设置，如下以引入vue.js静态资源为例说明<span id="jump_staticResources"></span></p>
<h2 id="检查资源部署">检查资源部署</h2>
<ul>
<li>
<p>注意启动前检查一下新增的静态资源加载到打包目录下没有</p>
</li>
<li>
<p>重新启动项目未必能更新，需要<strong>重新打包</strong>（package）web项目才能更新</p>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210810121205.png"
                      alt=""
                ></p>
<ul>
<li>重新打包后在web项目生成的字节码文件中则会出现对应的静态资源目录</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210810121518.png"
                      alt=""
                ></p>
<h2 id="开启静态资源访问">开启静态资源访问</h2>
<ul>
<li>由于SpringMVC中设置了使用<strong>前端控制器</strong>处理所有请求和响应</li>
<li>当系统或用户访问静态资源时、即默认发起了GET请求。</li>
<li>此时前端控制器会率先接管，尝试去所有控制器中匹配这个请求的URL，试图寻找对应的控制方法</li>
<li>当然，对于用户来说静态资源不会设有控制方法，自然SpringMVC就报错，表示找不到对应映射方法</li>
<li><u>此时需要在SpringMVC配置文件中开启静态资源访问，如下标签所示</u></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 开放对静态资源的访问 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>开启静态资源访问工作原理：</p>
<ol>
<li>所有请求还是被前端控制器率先受理</li>
<li>当前端控制器<strong>匹配不到控制方法</strong>的请求链接（如静态资源），则<strong>不报错，且交付个DefaultServlet处理</strong>（DefaultServlet是Servlet-API中处理静态资源的Servlet）</li>
</ol>
</blockquote>
<h1 id="HttpMessageConverter">HttpMessageConverter</h1>
<h2 id="简介">简介</h2>
<ul>
<li>HttpMessageConverter，<strong>报文信息转换器</strong>，将<u>请求报文</u>转换为<u>Java数据/对象</u>，或将<u>Java数据/对象</u>转换为<u>响应报文</u></li>
<li>HttpMessageConverter提供了<strong>两个注解</strong>和<strong>两个类型</strong>：@RequestBody，@ResponseBody，RequestEntity，ResponseEntity</li>
</ul>
<h2 id="RequestBody">@RequestBody</h2>
<ul>
<li>@RequestBody可以<strong>获取请求体</strong>，需要在控制器方法设置一个形参接收</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testRequestBody&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testRequestBody</span><span class="params">(<span class="meta">@RequestBody</span> String requestBody)</span></span>&#123;</span><br><span class="line">    System.out.println(requestBody);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>测试前端</strong></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/testRequestBody&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>输出结果：requestBody</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;admin&amp;password&#x3D;123456</span><br></pre></td></tr></table></figure>
<h2 id="RequestEntity">RequestEntity</h2>
<ul>
<li>RequestEntity是请求报文封装的一种类型，直接在控制器方法的形参中设置即可</li>
<li>请求报文会赋值给该形参，可通过<code>getHeaders()</code>获取<strong>请求头</strong>信息，通过<code>getBody()</code>获取<strong>请求体</strong>信息</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testRequestEntity&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testRequestEntity</span><span class="params">(RequestEntity&lt;String&gt; requestEntity)</span></span>&#123;</span><br><span class="line">    System.out.println(requestEntity.getHeaders());</span><br><span class="line">    System.out.println(requestEntity.getBody());</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>测试前端</strong></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/testRequestBody&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>输出结果：requestHeader</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[host:&quot;localhost:8080&quot;, connection:&quot;keep-alive&quot;, content-length:&quot;27&quot;, cache-control:&quot;max-age&#x3D;0&quot;, sec-ch-ua:&quot;&quot; Not A;Brand&quot;;v&#x3D;&quot;99&quot;, &quot;Chromium&quot;;v&#x3D;&quot;90&quot;, &quot;Google Chrome&quot;;v&#x3D;&quot;90&quot;&quot;, sec-ch-ua-mobile:&quot;?0&quot;, upgrade-insecure-requests:&quot;1&quot;, origin:&quot;http:&#x2F;&#x2F;localhost:8080&quot;, user-agent:&quot;Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;90.0.4430.93 Safari&#x2F;537.36&quot;]</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>输出结果：requestBody</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">requestBody:username&#x3D;admin&amp;password&#x3D;123</span><br></pre></td></tr></table></figure>
<h2 id="ResponseBody">@ResponseBody</h2>
<h3 id="原生方式">原生方式</h3>
<ul>
<li>使用Servlet-API的response获取输出流，使用<code>print()</code>或<code>writer()</code>列方法输出数据</li>
<li>不响应页面或请求，需控制方法设置为<strong>无返回值方法</strong>，或返回null</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testResponse&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testResponse</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">    response.getWriter().print(<span class="string">&quot;hello,response&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="注解方式-2">注解方式</h3>
<ul>
<li>@ResponseBody用于标识一个控制方法</li>
<li>使控制方法的<strong>返回值以<u>字符串的方式</u>作为响应报文</strong>响应到浏览器。（常用与字符串数据接口编写-json）</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testResponseBody&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testResponseBody</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>输出结果</strong>：浏览器空白页面显示success字样</li>
</ul>
<h3 id="处理JSON数据小结">处理JSON数据小结</h3>
<h4 id="引入jackson依赖">引入jackson依赖</h4>
<ul>
<li>引入json第三方库jackson</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="开启MVC注解驱动">开启MVC注解驱动</h4>
<ul>
<li>在SpringMVC的核心配置文件中开启mvc的注解驱动</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>此时在HandlerAdaptor中会自动装配一个消息转换器：MappingJackson2HttpMessageConverter，可以将响应到浏览器的Java对象转换为Json格式的字符串</p>
</blockquote>
<h4 id="返回JSON数据">返回JSON数据</h4>
<ul>
<li>在处理器方法上<strong>使用@ResponseBody注解</strong>进行标识</li>
<li>将<strong>Java对象</strong>直接作为控制器方法的<strong>返回值返回</strong>，就会<strong>自动转换为Json格式的字符串</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testResponseUser&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">testResponseUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> User(<span class="number">1001</span>,<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;123456&quot;</span>,<span class="number">23</span>,<span class="string">&quot;男&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>输出结果</strong>：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;id&quot;:1001,&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;123456&quot;,&quot;age&quot;:23,&quot;sex&quot;:&quot;男&quot;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="RestController">@RestController</h3>
<ul>
<li>由于随着基于Spring家族的JavaWeb开发不断发展，json数据交互已经成为主流</li>
<li>其中<u>@ResponseBody注解被大量使用</u>，为了减少编码冗余，推出了一个派生注解（<strong>复合注解</strong>）</li>
<li><strong>@RestController</strong>是一个<strong>派生注解</strong>，等价于将该<u><strong>类</strong>添加@Controller注解</u>和其中的<u><strong>每个控制方法</strong>添加了@ResponseBody注解</u></li>
</ul>
<h2 id="ResponseEntity">ResponseEntity</h2>
<ul>
<li>ResponseEntity类可封装一个完整的HTTP响应报文。包含响应体、响应头、响应状态码</li>
<li>将ResponseEntity作为<strong>控制器方法</strong>的<strong>返回值类型</strong>，此时即为浏览器的<strong>响应报文</strong>。</li>
<li>即提供了一个<u>自定义响应报文的操作</u>（常用于文件下载、将响应体设置为字节）</li>
</ul>
<h1 id="文件上传和下载">文件上传和下载</h1>
<ul>
<li>使用ResponseEntity实现下载文件的功能（了解）</li>
</ul>
<h2 id="文件下载">文件下载</h2>
<h3 id="前端页面">前端页面</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testDown&#125;&quot;</span>&gt;</span>下载1.jpg<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="控制器方法">控制器方法</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testDown&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt;<span class="keyword">byte</span>[]&gt; testResponseEntity(HttpSession session) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="comment">//获取ServletContext对象</span></span><br><span class="line">    ServletContext servletContext = session.getServletContext();</span><br><span class="line">    <span class="comment">//获取服务器中文件的真实路径</span></span><br><span class="line">    String realPath = servletContext.getRealPath(<span class="string">&quot;/static/img/1.jpg&quot;</span>);</span><br><span class="line">    <span class="comment">//创建输入流</span></span><br><span class="line">    InputStream is = <span class="keyword">new</span> FileInputStream(realPath);</span><br><span class="line">    <span class="comment">//创建字节数组（available()方法是获取输入流is所代表的文件的所有字节，即文件大小）</span></span><br><span class="line">    <span class="keyword">byte</span>[] bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[is.available()];</span><br><span class="line">    <span class="comment">//一次读完，将流读到字节数组中（配合上一句代码，使用最简单的编码方式，让底层自动完成分段传输）</span></span><br><span class="line">    is.read(bytes);</span><br><span class="line">    <span class="comment">//创建HttpHeaders对象设置响应头信息</span></span><br><span class="line">    MultiValueMap&lt;String, String&gt; headers = <span class="keyword">new</span> HttpHeaders();</span><br><span class="line">    <span class="comment">//设置要下载方式以及下载文件的名字（attachment以附件的方式下载、下载文件的默认名）</span></span><br><span class="line">    headers.add(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment;filename=1.jpg&quot;</span>);</span><br><span class="line">    <span class="comment">//设置响应状态码（OK == 200）</span></span><br><span class="line">    HttpStatus statusCode = HttpStatus.OK;</span><br><span class="line">    <span class="comment">//创建ResponseEntity对象分别是：[响应体]、[响应体]、[响应状态码]</span></span><br><span class="line">    ResponseEntity&lt;<span class="keyword">byte</span>[]&gt; responseEntity = <span class="keyword">new</span> ResponseEntity&lt;&gt;(bytes, headers, statusCode);</span><br><span class="line">    <span class="comment">//关闭输入流</span></span><br><span class="line">    is.close();</span><br><span class="line">    <span class="keyword">return</span> responseEntity;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="文件上传">文件上传</h2>
<h3 id="上传页面">上传页面</h3>
<ul>
<li>文件上传要求form表单的<strong>请求方式</strong>必须为<strong>post</strong>，并且<strong>添加属性</strong><code>enctype=&quot;multipart/form-data&quot;</code></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>测试文件上传和下载<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/testUp&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">    头像：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;photo&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;上传&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="引入数据解析库">引入数据解析库</h3>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/commons-fileupload/commons-fileupload --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="控制器方法-2">控制器方法</h3>
<ul>
<li>
<p><em>原生Servlet-API中，获取上传文件的数据是</em><code>req.getInputStream();</code></p>
</li>
<li>
<p><strong>在SpringMVC中</strong>将上传的文件<strong>封装到MultipartFile对象中</strong>，此对象封装了上传文件数据及其一般操作</p>
</li>
<li>
<p>注意，SpringMVC中MultipartFile是当作请求参数<strong>名值对</strong>的，即该<strong>形参名</strong>需对应<code>type=file</code>的<strong>name属性</strong></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testUp&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testUp</span><span class="params">(MultipartFile photo, HttpSession session)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="comment">//1、获取上传的文件的文件名</span></span><br><span class="line">    String fileName = photo.getOriginalFilename();</span><br><span class="line">    </span><br><span class="line">   	<span class="comment">//2、在服务器中准备文件上传后存放的位置（解决文件存放路径和文件重名问题）</span></span><br><span class="line">    <span class="comment">//处理文件重名问题（使用UUID作为唯一随机名）</span></span><br><span class="line">    String suffixName = fileName.substring(fileName.lastIndexOf(<span class="string">&quot;.&quot;</span>));<span class="comment">//获取文件后缀</span></span><br><span class="line">    fileName = UUID.randomUUID().toString() + suffixName;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//获取服务器中photo目录的路径</span></span><br><span class="line">    ServletContext servletContext = session.getServletContext();</span><br><span class="line">    String photoPath = servletContext.getRealPath(<span class="string">&quot;photo&quot;</span>);</span><br><span class="line">    File file = <span class="keyword">new</span> File(photoPath);</span><br><span class="line">    <span class="keyword">if</span>(!file.exists())&#123;</span><br><span class="line">        file.mkdir();</span><br><span class="line">    &#125;</span><br><span class="line">    String finalPath = photoPath + File.separator + fileName;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//3、实现上传功能，直接使用封装好的方法一键上传</span></span><br><span class="line">    photo.transferTo(<span class="keyword">new</span> File(finalPath));<span class="comment">//可传String或File类型</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>UUID是指在一台机器上生成的数字，它保证对在同一时空中的所有机器都是唯一的。通常平台会提供生成的API。按照<a class="link"   target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%BC%80%E6%94%BE%E8%BD%AF%E4%BB%B6%E5%9F%BA%E9%87%91%E4%BC%9A" >开放软件基金会<i class="fas fa-external-link-alt"></i></a>(OSF)制定的标准计算，<u>用到了以太网卡地址、纳秒级时间、芯片ID码和随机数</u></p>
</blockquote>
<h3 id="文件上传解析器">文件上传解析器</h3>
<ul>
<li>
<p>注意，目前上传的文件还不能直接转换成为SpringMVC中的MultipartFile类型</p>
</li>
<li>
<p>需在<strong>SpringMVC配置</strong>文件中配置一个<strong>文件上传解析器</strong>（配置的是MultipartResolver的实现类）</p>
</li>
<li>
<p>文件上传解析器是提供给SpringMVC所调用的，<strong>bean id必须设置成</strong><code>&quot;multipartResolver&quot;</code></p>
<blockquote>
<p>SpringMVC获取文件上传解析器只通过byId获取</p>
</blockquote>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--必须通过文件解析器的解析才能将文件转换为MultipartFile对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;multipartResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="拦截器">拦截器</h1>
<h2 id="基本概念-2">基本概念</h2>
<ul>
<li>SpringMVC提供一种<u>拦截器机制</u>（Interceptor），用于拦截<strong>控制器方法</strong>的执行</li>
<li>与过滤器不同，拦截器具体工作在<u>控制器方法执行</u>的<strong>前后</strong>、以及<strong>渲染视图后</strong>执行</li>
</ul>
<h2 id="实现拦截器">实现拦截器</h2>
<h3 id="实现HandlerInterceptor接口">实现HandlerInterceptor接口</h3>
<h4 id="默认方法说明">默认方法说明</h4>
<ul>
<li><strong>preHandle</strong>：在控制器方法执行前执行，返回布尔类型决定是否放行（true放行、false拦截）</li>
<li><strong>postHandle</strong>：在控制器方法执行后执行</li>
<li><strong>afterCompletion</strong>：在视图完成渲染后执行</li>
</ul>
<h4 id="代码示例">代码示例</h4>
<ul>
<li>实现HandlerInterceptor接口（由于定义都为默认方法，需手动重写，IDEA可通Ctrl+O快捷键）</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yhd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2021-08-11 10:34</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FirstInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;FirstInterceptor——&gt;preHandle&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;FirstInterceptor——&gt;postHandle&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;FirstInterceptor——&gt;afterCompletion&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="配置拦截器">配置拦截器</h3>
<ul>
<li>在SpringMVC的配置文件中进行配置，一般分为两类配置方式</li>
</ul>
<h4 id="全拦截配置">全拦截配置</h4>
<ul>
<li>在<code>&lt;mvc:interceptors&gt;</code>标签内配置拦截器的<code>&lt;bean&gt;</code>、或引入外部拦截器的bean<code>&lt;ref&gt;</code></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.company.rest.interceptors.FirstInterceptor&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;ref bean=&quot;firstInterceptor&quot;&gt;&lt;/ref&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="自定义拦截配置">自定义拦截配置</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置拦截器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 配置拦截规则（ant风格），下述表示拦截上下文及其任意层级任意目录 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/**&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 配置不拦截规则（ant风格），下述表示根目录（首页）不拦截 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:exclude-mapping</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 通过bean或ref配置拦截器实体类 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.company.rest.interceptors.FirstInterceptor&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="多拦截器执行">多拦截器执行</h2>
<p>执行顺序与拦截器在<strong>配置文件的配置顺序有关</strong>（类过滤器）</p>
<ul>
<li>
<p><strong>均成功放行</strong>：若每个拦截器的preHandle()都返回true</p>
<ul>
<li>preHandle()会按照配置的<strong>顺序执行</strong>（顺序遍历并记录List集合中的索引，interceptorIndex）</li>
<li>postHandle()按配置顺序<strong>反序执行</strong>（反序List遍历）</li>
<li>afterComplation()会按照配置的<strong>反序执行</strong>（反序interceptorIndex索引遍历）</li>
</ul>
</li>
<li>
<p><strong>中途拦截</strong>：若某个拦截器的preHandle()返回了false</p>
<ul>
<li>preHandle()<strong>返回false和它之前</strong>的拦截器的preHandle（并记录放行过的interceptorIndex索引）</li>
<li>postHandle()<strong>都不执行</strong>（interceptorList中出现拦截，<u>即返回false，被return</u>）</li>
<li>返回<strong>false之前</strong>的拦截器的afterComplation()<strong>执行</strong>（<u>反序interceptorIndex索引遍历</u>）</li>
</ul>
</li>
</ul>
<blockquote>
<p>源码模仿出函数调用栈的执行逻辑</p>
</blockquote>
<hr>
<ul>
<li>部分核心源码</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">   	<span class="comment">//....</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//执行所有的preHandle（如果返回false，则直接return，postHandle将得不到执行）</span></span><br><span class="line">    <span class="keyword">if</span> (!mappedHandler.applyPreHandle(processedRequest, response)) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//执行控制器方法，返回mv对象(ModulAndView)</span></span><br><span class="line">    mv = ha.handle(processedRequest, response, mappedHandler.getHandler());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (asyncManager.isConcurrentHandlingStarted()) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//执行所有的postHandle</span></span><br><span class="line">    applyDefaultViewName(processedRequest, mv);</span><br><span class="line">    mappedHandler.applyPostHandle(processedRequest, response, mv);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="异常处理器">异常处理器</h1>
<h2 id="基本概念-3">基本概念</h2>
<ul>
<li>异常处理器用于在控制方法执行过程中的检测、抛出、某种异常，以及设置异常跳转到的页面</li>
<li>SpringMVC提供了一个处理<u>控制器方法</u>执行过程中所出现的异常的<strong>接口</strong>：HandlerExceptionResolver</li>
<li>HandlerExceptionResolver接口的<strong>实现类</strong>有：DefaultHandlerExceptionResolver（默认）和SimpleMappingExceptionResolver</li>
<li>SpringMVC提供了<strong>自定义的异常处理</strong>器SimpleMappingExceptionResolver（如指定某种异常跳转页面）</li>
</ul>
<blockquote>
<p>主要就是使用自定义异常处理器SimpleMappingExceptionResolver去设置某种异常的跳转页面</p>
</blockquote>
<h2 id="配置异常处理器">配置异常处理器</h2>
<ul>
<li>默认的异常处理器是DefaultHandlerExceptionResolver无需配置，配置的都是自定义异常处理器SimpleMappingExceptionResolver</li>
</ul>
<h3 id="xml方式">xml方式</h3>
<ol>
<li>配置<strong>SimpleMappingExceptionResolver</strong>的bean</li>
<li>注入Properties类型的<strong>exceptionMappings</strong>属性
<ul>
<li><strong>properties的键key</strong>：表示处理器方法执行过程中出现的<u>异常的全类名</u></li>
<li><strong>properties的value</strong>：表示若出现指定异常时，设置跳转页面的<u>视图名称</u>。可以设置forward等前缀，视图生成类型和调用逻辑与控制方法使用一致</li>
</ul>
</li>
<li>（可选）可选择注入<strong>exceptionAttribute</strong>属性的一个值，该值表示与<u>异常处理页共享的请求域</u>数据的键（名），存储Java异常的全类名。配置后可直接在前端页面上以请求域方式输出其键，则输出当前异常的全类名</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 自定义异常处理器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.handler.SimpleMappingExceptionResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;exceptionMappings&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;java.lang.ArithmeticException&quot;</span>&gt;</span>error<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 设置将异常信息共享到请求域中的键 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;exceptionAttribute&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="注解方式-3">注解方式</h3>
<ol>
<li>使用**@ControllerAdvice注解**将当前类标识为异常处理的组件（@Component或@Controller派生注解）</li>
<li>编写异常跳转控制方法，并在此方法上添加**@ExceptionHandler注解**，该注解的value是一个异常Class[]类型，用于写入待匹配的异常</li>
<li>（可选）异常控制方法在控制方法的基础上还提供了一个专有的<strong>异常传入形参</strong>Exception，获取当前请求处理中出现的异常对象</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExceptionController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ExceptionHandler(ArithmeticException.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">handleArithmeticException</span><span class="params">(Exception ex, Model model)</span></span>&#123;</span><br><span class="line">        <span class="comment">//等价于xml中配置注入exceptionAttribute属性效果</span></span><br><span class="line">        model.addAttribute(<span class="string">&quot;ex&quot;</span>, ex);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;error&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="无配置文件开发">无配置文件开发</h1>
<ul>
<li>无配置文件开发指，拟使用配置类和注解替代web.xml、Spring、SpringMVC的3个配置文件</li>
<li>注意，无配置文件开发，只是配置文件不用创建，其余的任何web结构都不能省</li>
</ul>
<table>
<thead>
<tr>
<th>配置文件</th>
<th>类或注解开发</th>
</tr>
</thead>
<tbody>
<tr>
<td>spring.xml</td>
<td>创建配置类、使用@Configuration注解</td>
</tr>
<tr>
<td>springMVC.xml</td>
<td>创建配置类、使用@Configuration注解</td>
</tr>
<tr>
<td>web.xml</td>
<td>继承AbstractAnnotationConfigDispatcherServletInitializer</td>
</tr>
</tbody>
</table>
<h2 id="Spring配置类">Spring配置类</h2>
<ul>
<li>创建一个类，并添加@Configuration注解作为Spring的配置类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ssm整合之后，spring的配置信息写在此类中</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>由于当前开发环境未进行ssm整合，因此Spring配置文件没有配置其他内容，如开启组件扫描等等…</p>
<p>当进行Spring整合后，这些功能应有Spring配置类完成</p>
</blockquote>
<h2 id="SpringMVC配置类">SpringMVC配置类</h2>
<ul>
<li>创建一个类，并添加@Configuration注解作为SpringMVC的配置类</li>
<li><strong>SpringMVC常见配置内容</strong>：扫描组件、视图解析器(Thymeleaf)、视图控制器(view-controller)、mvc注解驱动、文件上传解析器、拦截器…
<ul>
<li><strong>xml中bean相关配置</strong>：直接在配置类中配置bean的方式实现</li>
<li><strong>xml中其他标签配置</strong>（非bean）：对于这种<strong>非bean配置</strong>一般需<strong>实现WebMvcConfigurer接口</strong>，选择配置对应的方法重写</li>
</ul>
</li>
</ul>
<h3 id="基本结构">基本结构</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>  <span class="comment">//标识为配置类</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.company.mvc&quot;)</span>   <span class="comment">//开启注解扫描</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span>   <span class="comment">//开启MVC注解驱动</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>当前没有整合SSM框架，只使用SpringMVC，像扫描组件这些配置应再Spring中统一配置</p>
</blockquote>
<h3 id="配置Thymeleaf-3">配置Thymeleaf</h3>
<ul>
<li>类似这种在配置文件中<strong>属于bean的配置</strong>，直接在<strong>如同Spring配置类</strong>中<strong>配置对应的bean</strong>即可</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>  <span class="comment">//标识为配置类</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.company.mvc&quot;)</span>   <span class="comment">//开启注解扫描</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span>   <span class="comment">//开启MVC注解驱动</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//配置视图解析器（Thymeleaf），以xml从里到外配置（当前代码是复制的）</span></span><br><span class="line">    <span class="comment">//配置生成模板解析器（@Bean，Spring的注解，返回类型作为IoC中的bean）</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ITemplateResolver <span class="title">templateResolver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        WebApplicationContext webApplicationContext = ContextLoader.getCurrentWebApplicationContext();</span><br><span class="line">        <span class="comment">// ServletContextTemplateResolver需要一个ServletContext作为构造参数，可通过WebApplicationContext 的方法获得</span></span><br><span class="line">        ServletContextTemplateResolver templateResolver = <span class="keyword">new</span> ServletContextTemplateResolver(</span><br><span class="line">            webApplicationContext.getServletContext());</span><br><span class="line">        templateResolver.setPrefix(<span class="string">&quot;/WEB-INF/templates/&quot;</span>);</span><br><span class="line">        templateResolver.setSuffix(<span class="string">&quot;.html&quot;</span>);</span><br><span class="line">        templateResolver.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        templateResolver.setTemplateMode(TemplateMode.HTML);</span><br><span class="line">        <span class="keyword">return</span> templateResolver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//生成模板引擎并为模板引擎注入模板解析器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SpringTemplateEngine <span class="title">templateEngine</span><span class="params">(ITemplateResolver templateResolver)</span> </span>&#123;</span><br><span class="line">        SpringTemplateEngine templateEngine = <span class="keyword">new</span> SpringTemplateEngine();</span><br><span class="line">        templateEngine.setTemplateResolver(templateResolver);</span><br><span class="line">        <span class="keyword">return</span> templateEngine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//生成视图解析器并未解析器注入模板引擎</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ViewResolver <span class="title">viewResolver</span><span class="params">(SpringTemplateEngine templateEngine)</span> </span>&#123;</span><br><span class="line">        ThymeleafViewResolver viewResolver = <span class="keyword">new</span> ThymeleafViewResolver();</span><br><span class="line">        viewResolver.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        viewResolver.setTemplateEngine(templateEngine);</span><br><span class="line">        <span class="keyword">return</span> viewResolver;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="配置文件上传解析器">配置文件上传解析器</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//配置文件上传解析器</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> MultipartResolver <span class="title">multipartResolver</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> CommonsMultipartResolver();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="开启静态资源访问-2">开启静态资源访问</h3>
<ul>
<li>即实现<code>&lt;mvc:default-servlet-handler/&gt;</code>配置</li>
<li>其中开启静态资源访问需重写接口的<code>configureDefaultServletHandling()</code>方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.company.mvc&quot;)</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">configureDefaultServletHandling</span><span class="params">(DefaultServletHandlerConfigurer configurer)</span> </span>&#123;</span><br><span class="line">        configurer.enable();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="配置拦截器-2">配置拦截器</h3>
<ul>
<li>其中配置拦截器需重写WebMvcConfigurer接口的<code>addInterceptors()</code>方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.company.mvc&quot;)</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="comment">//配置拦截器</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//实例化拦截器</span></span><br><span class="line">        FirstInterceptor firstInterceptor = <span class="keyword">new</span> FirstInterceptor();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//配置拦截规则，可配置一个或多个，对应重载方法（或配置不拦截规则）</span></span><br><span class="line">        registry.addInterceptor(firstInterceptor).addPathPatterns(<span class="string">&quot;/**&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="配置视图控制器">配置视图控制器</h3>
<ul>
<li>其中配置视图控制器需重写WebMvcConfigurer接口的<code>addInterceptors()</code>方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.company.mvc&quot;)</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//分别设置【映射路径】、与【视图名称】</span></span><br><span class="line">        registry.addViewController(<span class="string">&quot;/&quot;</span>).setViewName(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="配置异常解析器">配置异常解析器</h3>
<ul>
<li>配置异常解析器除了配置bean的方式实现，还可以通过重写<strong>WebMvcConfigurer</strong>接口方法实现</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.company.mvc&quot;)</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="comment">//配置异常映射</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">configureHandlerExceptionResolvers</span><span class="params">(List&lt;HandlerExceptionResolver&gt; resolvers)</span> </span>&#123;</span><br><span class="line">        SimpleMappingExceptionResolver exceptionResolver = <span class="keyword">new</span> SimpleMappingExceptionResolver();</span><br><span class="line"></span><br><span class="line">        Properties prop = <span class="keyword">new</span> Properties();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置异常映射</span></span><br><span class="line">        prop.setProperty(<span class="string">&quot;java.lang.ArithmeticException&quot;</span>, <span class="string">&quot;error&quot;</span>);</span><br><span class="line">        exceptionResolver.setExceptionMappings(prop);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置共享异常信息的键</span></span><br><span class="line">        exceptionResolver.setExceptionAttribute(<span class="string">&quot;ex&quot;</span>);</span><br><span class="line">        resolvers.add(exceptionResolver);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Servlet初始化类">Servlet初始化类</h2>
<p>Servlet初始化类用于最后<strong>整合并加载Spring、SpringMVC配置类</strong>，以及<strong>替代web.xml配置文件</strong>。</p>
<h3 id="基本概念-4">基本概念</h3>
<ul>
<li>在<strong>Servlet3.0</strong>环境中，容器会在<strong>类路径中查找</strong>实现javax.servlet.<strong>ServletContainerInitializer接口</strong>的类，如果找到的话就用它来配置Servlet容器。</li>
<li><strong>Spring提供</strong>了这个接口的<strong>实现</strong>，名为<strong>SpringServletContainerInitializer</strong>。Spring再利用这个类又会查找实现<strong>WebApplicationInitializer接口</strong>的类并将配置的任务交给它们（Spring）来完成。</li>
<li>最后<strong>Spring3.2</strong>引入了一个便利的WebApplicationInitializer<strong>基础实现</strong>，名为<strong>AbstractAnnotationConfigDispatcherServletInitializer</strong>，当我们的类<strong>继承</strong>AbstractAnnotationConfigDispatcherServletInitializer并将其部署到**Servlet3.0<u>容器</u>**的时候，<u>容器会自动发现它，并用它来配置Servlet上下文</u>。</li>
</ul>
<blockquote>
<p>即在Servlet原生环境下：提供javax.servlet.ServletContainerInitializer接口实现类</p>
<p>Spring环境下：提供WebApplicationInitializer接口实现类（官方提供了基础实现类，用户继承后使用）</p>
</blockquote>
<h3 id="配置初始化类">配置初始化类</h3>
<ol>
<li>整合Spring、SpringMVC配置文件以及设置DispatcherServlet的匹配规则</li>
<li>调用<strong>父类提供的各种方法</strong>对应设置web.xml可设置的内容（如、过滤器、监听器、初始化参数等…），创建、设置并返回对应配置的对象即可</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company.rest.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.filter.CharacterEncodingFilter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.filter.HiddenHttpMethodFilter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.support.AbstractAnnotationConfigDispatcherServletInitializer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.Filter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yhd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2021-08-11 16:46</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebInit</span> <span class="keyword">extends</span> <span class="title">AbstractAnnotationConfigDispatcherServletInitializer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1、整合Spring、SpringMVC配置文件以及设置DispatcherServlet的匹配规则</span></span><br><span class="line">    <span class="comment">//指定根配置类（Spring配置类），可配置多个</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt;[] getRootConfigClasses() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Class[]&#123;SpringConfig.class&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//指定SpringMVC的配置类，可配置多个</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt;[] getServletConfigClasses() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Class[]&#123;WebConfig.class&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//指定DispatcherServlet的匹配规则，即xml中的url-pattern，可配置多个</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> String[] getServletMappings() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String[]&#123;<span class="string">&quot;/&quot;</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2、通过父类提供的方法配置相当web.xml的内容，需配置什么就调用对应方法，返回配置内容对象即可</span></span><br><span class="line">    <span class="comment">//配置过滤器：返回需要配置的过滤器对象，返回数组类型，可配置多个</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Filter[] getServletFilters() &#123;</span><br><span class="line">        <span class="comment">//配置编码过滤器</span></span><br><span class="line">        CharacterEncodingFilter characterEncodingFilter = <span class="keyword">new</span> CharacterEncodingFilter();</span><br><span class="line">        characterEncodingFilter.setEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        characterEncodingFilter.setForceResponseEncoding(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置隐藏HTTP请求方式过滤器</span></span><br><span class="line">        HiddenHttpMethodFilter hiddenHttpMethodFilter = <span class="keyword">new</span> HiddenHttpMethodFilter();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Filter[]&#123;characterEncodingFilter,hiddenHttpMethodFilter&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="SpringMVC执行过程">SpringMVC执行过程</h1>
<h2 id="常用组件">常用组件</h2>
<ul>
<li>
<p><em><strong>DispatcherServlet</strong></em>：<strong>前端控制器</strong>，不需要工程师开发，由框架提供</p>
<ul>
<li>作用：统一处理请求和响应，整个流程控制的中心，由它调用其它组件处理用户的请求</li>
</ul>
</li>
<li>
<p><em><strong>HandlerMapping</strong></em>：<strong>处理器映射器</strong>，不需要工程师开发，由框架提供</p>
<ul>
<li>作用：根据请求的url、method等信息查找Handler，即控制器方法</li>
</ul>
</li>
<li>
<p><em><strong>Handler</strong></em>（Controller）：<strong>处理器</strong>，需要工程师开发</p>
<ul>
<li>作用：在DispatcherServlet的控制下Handler对具体的用户请求进行处理</li>
</ul>
</li>
<li>
<p><em><strong>HandlerAdapter</strong></em>：<strong>处理器适配器</strong>，不需要工程师开发，由框架提供</p>
<ul>
<li>作用：通过HandlerAdapter对调用处理器（控制器方法）进行执行</li>
</ul>
</li>
<li>
<p><em><strong>ViewResolver</strong></em>：<strong>视图解析器</strong>，不需要工程师开发，由框架提供</p>
<ul>
<li>作用：进行视图解析，得到相应的视图，如：ThymeleafView、InternalResourceView、RedirectView</li>
</ul>
</li>
<li>
<p><em><strong>View</strong></em>：<strong>视图</strong></p>
<ul>
<li>作用：将模型数据通过页面展示给用户</li>
</ul>
</li>
</ul>
<h2 id="DispatcherServlet初始化过程">DispatcherServlet初始化过程</h2>
<p>本章节只观察DispatcherServlet的初始化过程，<strong>仅包含init调用的相关部分</strong></p>
<ul>
<li>DispatcherServlet 本质上是一个 Servlet，因此严格遵循 Servlet 的生命周期</li>
<li>整个初始化过程宏观上是 Servlet 生命周期来进行调度</li>
</ul>
<h3 id="init调度过程">init调度过程</h3>
<ul>
<li>从Servlet-API的<strong>init</strong>()方法开始，最终调用到<strong>initWebApplicationContext</strong>()方法</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/img005.png"
                      alt=""
                ></p>
<h3 id="initWebApplicationContext方法解析">initWebApplicationContext方法解析</h3>
<ul>
<li>该方法主要用于<strong>创建WebApplicationContext对象</strong>（即Spring在Web环境的IoC对象）</li>
<li>所在类：org.springframework.web.servlet.FrameworkServlet</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> WebApplicationContext <span class="title">initWebApplicationContext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    WebApplicationContext rootContext =</span><br><span class="line">        WebApplicationContextUtils.getWebApplicationContext(getServletContext());</span><br><span class="line">    WebApplicationContext wac = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//首次执行为null，不执行</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.webApplicationContext != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// A context instance was injected at construction time -&gt; use it</span></span><br><span class="line">        wac = <span class="keyword">this</span>.webApplicationContext;</span><br><span class="line">        <span class="keyword">if</span> (wac <span class="keyword">instanceof</span> ConfigurableWebApplicationContext) &#123;</span><br><span class="line">            ConfigurableWebApplicationContext cwac = (ConfigurableWebApplicationContext) wac;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (!cwac.isActive()) &#123;</span><br><span class="line">                <span class="keyword">if</span> (cwac.getParent() == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    cwac.setParent(rootContext);</span><br><span class="line">                &#125;</span><br><span class="line">                configureAndRefreshWebApplicationContext(cwac);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (wac == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">//一开始也找不到，也不执行</span></span><br><span class="line">        wac = findWebApplicationContext();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (wac == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// 创建WebApplicationContext（下述介绍）</span></span><br><span class="line">        wac = createWebApplicationContext(rootContext);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.refreshEventReceived) &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>.onRefreshMonitor) &#123;</span><br><span class="line">            <span class="comment">// 刷新WebApplicationContext（调用了子类DispatcherServlet的初始化策略）</span></span><br><span class="line">            onRefresh(wac);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.publishContext) &#123;</span><br><span class="line">        String attrName = getServletContextAttributeName();</span><br><span class="line">        <span class="comment">// 将IOC容器（WebApplicationContext）对象在应用域共享</span></span><br><span class="line">        getServletContext().setAttribute(attrName, wac);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wac;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="createWebApplicationContext-方法解析">createWebApplicationContext()方法解析</h3>
<ul>
<li>createWebApplicationContext()方法是真正实现创建WebApplicationContext对象的方法</li>
<li>所在类：org.springframework.web.servlet.FrameworkServlet</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> WebApplicationContext <span class="title">createWebApplicationContext</span><span class="params">(<span class="meta">@Nullable</span> ApplicationContext parent)</span> </span>&#123;</span><br><span class="line">    Class&lt;?&gt; contextClass = getContextClass();</span><br><span class="line">    <span class="keyword">if</span> (!ConfigurableWebApplicationContext.class.isAssignableFrom(contextClass)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ApplicationContextException(</span><br><span class="line">            <span class="string">&quot;Fatal initialization error in servlet with name &#x27;&quot;</span> + getServletName() +</span><br><span class="line">            <span class="string">&quot;&#x27;: custom WebApplicationContext class [&quot;</span> + contextClass.getName() +</span><br><span class="line">            <span class="string">&quot;] is not of type ConfigurableWebApplicationContext&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 通过反射创建 IOC 容器对象</span></span><br><span class="line">    ConfigurableWebApplicationContext wac =</span><br><span class="line">        (ConfigurableWebApplicationContext) BeanUtils.instantiateClass(contextClass);</span><br><span class="line"></span><br><span class="line">    wac.setEnvironment(getEnvironment());</span><br><span class="line">    <span class="comment">// 设置父容器（若SSM中SS需分开整合，则需两个IoC容器，Spring的IoC作为父容器）</span></span><br><span class="line">    wac.setParent(parent);</span><br><span class="line">    String configLocation = getContextConfigLocation();</span><br><span class="line">    <span class="keyword">if</span> (configLocation != <span class="keyword">null</span>) &#123;</span><br><span class="line">        wac.setConfigLocation(configLocation);</span><br><span class="line">    &#125;</span><br><span class="line">    configureAndRefreshWebApplicationContext(wac);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wac;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="DispatcherServlet初始化策略">DispatcherServlet初始化策略</h3>
<ul>
<li>FrameworkServlet创建WebApplicationContext后，刷新容器，调用onRefresh(wac)</li>
<li>此方法在DispatcherServlet中进行了重写，调用了initStrategies(context)方法</li>
<li>该方法表示调用初始化策略，即<strong>初始化DispatcherServlet的各个组件</strong></li>
<li>所在类：org.springframework.web.servlet.DispatcherServlet</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">initStrategies</span><span class="params">(ApplicationContext context)</span> </span>&#123;</span><br><span class="line">   initMultipartResolver(context);<span class="comment">//上传文件解析器</span></span><br><span class="line">   initLocaleResolver(context);</span><br><span class="line">   initThemeResolver(context);</span><br><span class="line">   initHandlerMappings(context);<span class="comment">//处理器映射器（匹配控制器方法）</span></span><br><span class="line">   initHandlerAdapters(context);<span class="comment">//初始化处理器适配器（调用被匹配的控制器方法）</span></span><br><span class="line">   initHandlerExceptionResolvers(context);<span class="comment">//初始异常处理器</span></span><br><span class="line">   initRequestToViewNameTranslator(context);</span><br><span class="line">   initViewResolvers(context);<span class="comment">//初始化视图解析器</span></span><br><span class="line">   initFlashMapManager(context);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="DispatcherServlet调用组件处理请求">DispatcherServlet调用组件处理请求</h2>
<h3 id="service">service()</h3>
<ul>
<li>同理init 方法，DispatcherServlet处理请求也应从Servlet-API的service方法看起</li>
<li>FrameworkServlet重写HttpServlet中的service()和doXxx()，这些方法<strong>最终都调用了processRequest</strong>(request, response)</li>
<li>所在类：org.springframework.web.servlet.FrameworkServlet</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">		<span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">	HttpMethod httpMethod = HttpMethod.resolve(request.getMethod());</span><br><span class="line">	<span class="keyword">if</span> (httpMethod == HttpMethod.PATCH || httpMethod == <span class="keyword">null</span>) &#123;</span><br><span class="line">		processRequest(request, response);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">           <span class="comment">//当调用父类的service方法，再调用对应的doXxx方法时，</span></span><br><span class="line">           <span class="comment">//这些doXxxx方法又被FrameworkServlet重写且调用</span></span><br><span class="line">           <span class="comment">//processRequest(request, response)方法</span></span><br><span class="line">		<span class="keyword">super</span>.service(request, response);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="processRequest">processRequest()</h3>
<ul>
<li>所在类：org.springframework.web.servlet.FrameworkServlet</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">processRequest</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">long</span> startTime = System.currentTimeMillis();</span><br><span class="line">    Throwable failureCause = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    LocaleContext previousLocaleContext = LocaleContextHolder.getLocaleContext();</span><br><span class="line">    LocaleContext localeContext = buildLocaleContext(request);</span><br><span class="line"></span><br><span class="line">    RequestAttributes previousAttributes = RequestContextHolder.getRequestAttributes();</span><br><span class="line">    ServletRequestAttributes requestAttributes = buildRequestAttributes(request, response, previousAttributes);</span><br><span class="line"></span><br><span class="line">    WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request);</span><br><span class="line">    asyncManager.registerCallableInterceptor(FrameworkServlet.class.getName(), <span class="keyword">new</span> RequestBindingInterceptor());</span><br><span class="line"></span><br><span class="line">    initContextHolders(request, localeContext, requestAttributes);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 执行服务，doService()是一个抽象方法，在DispatcherServlet中进行了重写</span></span><br><span class="line">        doService(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (ServletException | IOException ex) &#123;</span><br><span class="line">        failureCause = ex;</span><br><span class="line">        <span class="keyword">throw</span> ex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">        failureCause = ex;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NestedServletException(<span class="string">&quot;Request processing failed&quot;</span>, ex);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">        resetContextHolders(request, previousLocaleContext, previousAttributes);</span><br><span class="line">        <span class="keyword">if</span> (requestAttributes != <span class="keyword">null</span>) &#123;</span><br><span class="line">            requestAttributes.requestCompleted();</span><br><span class="line">        &#125;</span><br><span class="line">        logResult(request, response, failureCause, asyncManager);</span><br><span class="line">        publishRequestHandledEvent(request, response, startTime, failureCause);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="doService">doService()</h3>
<ul>
<li>所在类：org.springframework.web.servlet.DispatcherServlet</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doService</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    logRequest(request);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Keep a snapshot of the request attributes in case of an include,</span></span><br><span class="line">    <span class="comment">// to be able to restore the original attributes after the include.</span></span><br><span class="line">    Map&lt;String, Object&gt; attributesSnapshot = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (WebUtils.isIncludeRequest(request)) &#123;</span><br><span class="line">        attributesSnapshot = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        Enumeration&lt;?&gt; attrNames = request.getAttributeNames();</span><br><span class="line">        <span class="keyword">while</span> (attrNames.hasMoreElements()) &#123;</span><br><span class="line">            String attrName = (String) attrNames.nextElement();</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.cleanupAfterInclude || attrName.startsWith(DEFAULT_STRATEGIES_PREFIX)) &#123;</span><br><span class="line">                attributesSnapshot.put(attrName, request.getAttribute(attrName));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Make framework objects available to handlers and view objects.</span></span><br><span class="line">    request.setAttribute(WEB_APPLICATION_CONTEXT_ATTRIBUTE, getWebApplicationContext());</span><br><span class="line">    request.setAttribute(LOCALE_RESOLVER_ATTRIBUTE, <span class="keyword">this</span>.localeResolver);</span><br><span class="line">    request.setAttribute(THEME_RESOLVER_ATTRIBUTE, <span class="keyword">this</span>.themeResolver);</span><br><span class="line">    request.setAttribute(THEME_SOURCE_ATTRIBUTE, getThemeSource());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.flashMapManager != <span class="keyword">null</span>) &#123;</span><br><span class="line">        FlashMap inputFlashMap = <span class="keyword">this</span>.flashMapManager.retrieveAndUpdate(request, response);</span><br><span class="line">        <span class="keyword">if</span> (inputFlashMap != <span class="keyword">null</span>) &#123;</span><br><span class="line">            request.setAttribute(INPUT_FLASH_MAP_ATTRIBUTE, Collections.unmodifiableMap(inputFlashMap));</span><br><span class="line">        &#125;</span><br><span class="line">        request.setAttribute(OUTPUT_FLASH_MAP_ATTRIBUTE, <span class="keyword">new</span> FlashMap());</span><br><span class="line">        request.setAttribute(FLASH_MAP_MANAGER_ATTRIBUTE, <span class="keyword">this</span>.flashMapManager);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    RequestPath requestPath = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.parseRequestPath &amp;&amp; !ServletRequestPathUtils.hasParsedRequestPath(request)) &#123;</span><br><span class="line">        requestPath = ServletRequestPathUtils.parseAndCache(request);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 调用处理请求和响应最终方法</span></span><br><span class="line">        doDispatch(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!WebAsyncUtils.getAsyncManager(request).isConcurrentHandlingStarted()) &#123;</span><br><span class="line">            <span class="comment">// Restore the original attribute snapshot, in case of an include.</span></span><br><span class="line">            <span class="keyword">if</span> (attributesSnapshot != <span class="keyword">null</span>) &#123;</span><br><span class="line">                restoreAttributesAfterInclude(request, attributesSnapshot);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (requestPath != <span class="keyword">null</span>) &#123;</span><br><span class="line">            ServletRequestPathUtils.clearParsedRequestPath(request);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="doDispatch">doDispatch()</h3>
<ul>
<li>真正调用控制方法，处理请求得出响应的主要函数，包含拦截器工作</li>
<li>所在类：org.springframework.web.servlet.DispatcherServlet</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doDispatch</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    HttpServletRequest processedRequest = request;</span><br><span class="line">    HandlerExecutionChain mappedHandler = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">boolean</span> multipartRequestParsed = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        ModelAndView mv = <span class="keyword">null</span>;</span><br><span class="line">        Exception dispatchException = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            processedRequest = checkMultipart(request);</span><br><span class="line">            multipartRequestParsed = (processedRequest != request);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Determine handler for the current request.</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            	mappedHandler：调用链，由三部分组成（封装被执行的控制方法和拦截器）</span></span><br><span class="line"><span class="comment">            	 - handler：浏览器发送的请求所匹配的控制器方法</span></span><br><span class="line"><span class="comment">            	 - interceptorList：处理控制器方法的所有拦截器集合</span></span><br><span class="line"><span class="comment">            	 - interceptorIndex：拦截器索引，控制拦截器afterCompletion()的执行</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            mappedHandler = getHandler(processedRequest);</span><br><span class="line">            <span class="keyword">if</span> (mappedHandler == <span class="keyword">null</span>) &#123;</span><br><span class="line">                noHandlerFound(processedRequest, response);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Determine handler adapter for the current request.</span></span><br><span class="line">            <span class="comment">// 通过控制器方法创建相应的处理器适配器，用于调用所对应的控制器方法</span></span><br><span class="line">            HandlerAdapter ha = getHandlerAdapter(mappedHandler.getHandler());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Process last-modified header, if supported by the handler.</span></span><br><span class="line">            String method = request.getMethod();</span><br><span class="line">            <span class="keyword">boolean</span> isGet = <span class="string">&quot;GET&quot;</span>.equals(method);</span><br><span class="line">            <span class="keyword">if</span> (isGet || <span class="string">&quot;HEAD&quot;</span>.equals(method)) &#123;</span><br><span class="line">                <span class="keyword">long</span> lastModified = ha.getLastModified(request, mappedHandler.getHandler());</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">new</span> ServletWebRequest(request, response).checkNotModified(lastModified) &amp;&amp; isGet) &#123;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 调用拦截器的preHandle()</span></span><br><span class="line">            <span class="keyword">if</span> (!mappedHandler.applyPreHandle(processedRequest, response)) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Actually invoke the handler.</span></span><br><span class="line">            <span class="comment">// 由处理器适配器调用具体的控制器方法，最终获得ModelAndView对象</span></span><br><span class="line">            <span class="comment">// 这个方法完成了编写控制方法的用户所受益的所有SpringMVC自动操作</span></span><br><span class="line">            mv = ha.handle(processedRequest, response, mappedHandler.getHandler());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (asyncManager.isConcurrentHandlingStarted()) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            applyDefaultViewName(processedRequest, mv);</span><br><span class="line">            <span class="comment">// 调用拦截器的postHandle()</span></span><br><span class="line">            mappedHandler.applyPostHandle(processedRequest, response, mv);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            dispatchException = ex;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Throwable err) &#123;</span><br><span class="line">            <span class="comment">// As of 4.3, we&#x27;re processing Errors thrown from handler methods as well,</span></span><br><span class="line">            <span class="comment">// making them available for @ExceptionHandler methods and other scenarios.</span></span><br><span class="line">            dispatchException = <span class="keyword">new</span> NestedServletException(<span class="string">&quot;Handler dispatch failed&quot;</span>, err);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 后续处理：处理模型数据和渲染视图</span></span><br><span class="line">        processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">        triggerAfterCompletion(processedRequest, response, mappedHandler, ex);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Throwable err) &#123;</span><br><span class="line">        triggerAfterCompletion(processedRequest, response, mappedHandler,</span><br><span class="line">                               <span class="keyword">new</span> NestedServletException(<span class="string">&quot;Handler processing failed&quot;</span>, err));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (asyncManager.isConcurrentHandlingStarted()) &#123;</span><br><span class="line">            <span class="comment">// Instead of postHandle and afterCompletion</span></span><br><span class="line">            <span class="keyword">if</span> (mappedHandler != <span class="keyword">null</span>) &#123;</span><br><span class="line">                mappedHandler.applyAfterConcurrentHandlingStarted(processedRequest, response);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Clean up any resources used by a multipart request.</span></span><br><span class="line">            <span class="keyword">if</span> (multipartRequestParsed) &#123;</span><br><span class="line">                cleanupMultipart(processedRequest);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="processDispatchResult">processDispatchResult()</h3>
<ul>
<li>后续处理：处理模型数据和渲染视图</li>
<li>所在类：org.springframework.web.servlet.DispatcherServlet</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">processDispatchResult</span><span class="params">(HttpServletRequest request, HttpServletResponse response,</span></span></span><br><span class="line"><span class="function"><span class="params">                                   <span class="meta">@Nullable</span> HandlerExecutionChain mappedHandler, <span class="meta">@Nullable</span> ModelAndView mv,</span></span></span><br><span class="line"><span class="function"><span class="params">                                   <span class="meta">@Nullable</span> Exception exception)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">boolean</span> errorView = <span class="keyword">false</span>;</span><br><span class="line">	<span class="comment">//存在异常才执行</span></span><br><span class="line">    <span class="keyword">if</span> (exception != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (exception <span class="keyword">instanceof</span> ModelAndViewDefiningException) &#123;</span><br><span class="line">            logger.debug(<span class="string">&quot;ModelAndViewDefiningException encountered&quot;</span>, exception);</span><br><span class="line">            mv = ((ModelAndViewDefiningException) exception).getModelAndView();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            Object handler = (mappedHandler != <span class="keyword">null</span> ? mappedHandler.getHandler() : <span class="keyword">null</span>);</span><br><span class="line">            mv = processHandlerException(request, response, handler, exception);</span><br><span class="line">            errorView = (mv != <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Did the handler return a view to render?</span></span><br><span class="line">    <span class="keyword">if</span> (mv != <span class="keyword">null</span> &amp;&amp; !mv.wasCleared()) &#123;</span><br><span class="line">        <span class="comment">// 处理模型数据和渲染视图方法</span></span><br><span class="line">        render(mv, request, response);</span><br><span class="line">        <span class="keyword">if</span> (errorView) &#123;</span><br><span class="line">            WebUtils.clearErrorRequestAttributes(request);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (logger.isTraceEnabled()) &#123;</span><br><span class="line">            logger.trace(<span class="string">&quot;No view rendering, null ModelAndView returned.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (WebAsyncUtils.getAsyncManager(request).isConcurrentHandlingStarted()) &#123;</span><br><span class="line">        <span class="comment">// Concurrent handling started during a forward</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mappedHandler != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// Exception (if any) is already handled..</span></span><br><span class="line">        <span class="comment">// 调用拦截器的afterCompletion()</span></span><br><span class="line">        mappedHandler.triggerAfterCompletion(request, response, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="完整执行流程">完整执行流程</h2>
<ol>
<li>
<p>用户向服务器发送请求，请求被SpringMVC前端控制器 DispatcherServlet捕获。</p>
</li>
<li>
<p>DispatcherServlet对请求URL进行解析，得到请求资源标识符（URI），尝试匹配请求URI对应的映射</p>
<ol>
<li>不存在
<ol>
<li>再判断是否配置了mvc:default-servlet-handler（访问静态资源）</li>
<li>如果没配置，则控制台报映射查找不到，客户端展示404错误</li>
<li>如果有配置，则访问目标资源（一般为静态资源），找不到客户端也会展示404错误</li>
</ol>
</li>
<li>存在</li>
</ol>
</li>
<li>
<p>根据该URI，调用HandlerMapping获得该Handler配置的所有相关的对象，即HandlerExecutionChain执行链对象的形式返回。（包括Handler对象以及Handler对象对应的拦截器）</p>
</li>
<li>
<p>DispatcherServlet 根据获得的Handler，选择一个合适的HandlerAdapter</p>
<blockquote>
<p>由于HandlerAdapter也有各种类型，如处理请求的RequestHandlerAdapter</p>
</blockquote>
</li>
<li>
<p>如果成功获得HandlerAdapter，此时将开始执行拦截器的preHandler(…)方法【正向】</p>
</li>
<li>
<p>提取Request中的模型数据，填充Handler入参（形参），开始执行Handler（Controller)方法，处理请求。在填充Handler的入参过程中，根据你的配置，Spring将帮你做一些额外的工作：</p>
</li>
<li>
<p>HttpMessageConveter： 将请求消息（如Json、xml等数据）转换成一个对象，将对象转换为指定的响应信息</p>
</li>
<li>
<p>数据转换：对请求消息进行数据转换。如String转换成Integer、Double等</p>
</li>
<li>
<p>数据格式化：对请求消息进行数据格式化。 如将字符串转换成格式化数字或格式化日期等</p>
</li>
<li>
<p>数据验证： 验证数据的有效性（长度、格式等），验证结果存储到BindingResult或Error中</p>
</li>
<li>
<p>Handler执行完成后，向DispatcherServlet 返回一个ModelAndView对象。</p>
</li>
<li>
<p>此时将开始执行拦截器的postHandle(…)方法【逆向】。</p>
</li>
<li>
<p>根据返回的ModelAndView（此时会判断是否存在异常：如果存在异常，则执行HandlerExceptionResolver进行异常处理）选择一个适合的ViewResolver进行视图解析（三种类型视图），根据Model和View，来渲染视图。</p>
</li>
<li>
<p>渲染视图完毕执行拦截器的afterCompletion(…)方法【逆向】。</p>
</li>
<li>
<p>将渲染结果返回给客户端。</p>
</li>
</ol>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>Post title：SpringMVC5</li>
        <li>Post author：yhd</li>
        <li>Create time：2021-08-11 23:42:12</li>
        <li>
            Post link：https://keep.xpoet.cn/2021/08/11/SpringMVC5/
        </li>
        <li>
            Copyright Notice：All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.
        </li>
    </ul>
</div>

            </div>
        

        
            <div class="article-nav">
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2021/08/04/Spring5%E5%9F%BA%E7%A1%80/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Spring5基础</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>&nbsp;-&nbsp;
            
            2021&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">yhd</a>
        </div>
        
            <script async  src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.1</a>
        </div>
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#SpringMVC%E6%A6%82%E8%BF%B0"><span class="nav-number">1.</span> <span class="nav-text">SpringMVC概述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#MVC%E6%A6%82%E5%BF%B5"><span class="nav-number">1.1.</span> <span class="nav-text">MVC概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">1.1.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="nav-number">1.1.2.</span> <span class="nav-text">工作流程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SpringMVC%E6%A6%82%E5%BF%B5"><span class="nav-number">1.2.</span> <span class="nav-text">SpringMVC概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SpringMVC%E7%89%B9%E7%82%B9"><span class="nav-number">1.3.</span> <span class="nav-text">SpringMVC特点</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HelloWorld"><span class="nav-number">2.</span> <span class="nav-text">HelloWorld</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="nav-number">2.1.</span> <span class="nav-text">开发环境</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAmaven%E5%B7%A5%E7%A8%8B"><span class="nav-number">2.2.</span> <span class="nav-text">创建maven工程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E6%89%93%E5%8C%85%E6%96%B9%E5%BC%8F"><span class="nav-number">2.2.1.</span> <span class="nav-text">设置打包方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="nav-number">2.2.2.</span> <span class="nav-text">导入依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%84%E5%BB%BAweb%E7%9B%AE%E5%BD%95"><span class="nav-number">2.2.3.</span> <span class="nav-text">构建web目录</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#IDEA%E5%BF%AB%E9%80%9F%E6%B7%BB%E5%8A%A0"><span class="nav-number">2.2.3.1.</span> <span class="nav-text">IDEA快速添加</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IDEA%E6%89%8B%E5%8A%A8%E6%B7%BB%E5%8A%A0"><span class="nav-number">2.2.3.2.</span> <span class="nav-text">IDEA手动添加</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAweb%E7%9B%AE%E5%BD%95"><span class="nav-number">2.2.3.2.1.</span> <span class="nav-text">创建web目录</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#IDEA%E7%94%9F%E6%88%90web-xml"><span class="nav-number">2.2.3.2.2.</span> <span class="nav-text">IDEA生成web.xml</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%89%8D%E7%AB%AF%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="nav-number">2.3.</span> <span class="nav-text">配置前端控制器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#xml%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F"><span class="nav-number">2.3.1.</span> <span class="nav-text">xml配置方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F"><span class="nav-number">2.3.1.1.</span> <span class="nav-text">默认配置方式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E8%B7%AF%E5%BE%84%E8%AE%BE%E7%BD%AE"><span class="nav-number">2.3.1.1.1.</span> <span class="nav-text">匹配路径设置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SpringMVC%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">2.3.1.1.2.</span> <span class="nav-text">SpringMVC配置文件</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%A9%E5%B1%95%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F"><span class="nav-number">2.3.1.2.</span> <span class="nav-text">扩展配置方式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">2.3.1.2.1.</span> <span class="nav-text">创建配置文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E8%B7%AF%E5%BE%84"><span class="nav-number">2.3.1.2.2.</span> <span class="nav-text">定义配置文件的路径</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F"><span class="nav-number">2.3.2.</span> <span class="nav-text">注解方式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%AF%B7%E6%B1%82%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="nav-number">2.4.</span> <span class="nav-text">创建请求控制器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%80%E5%90%AF%E7%BB%84%E4%BB%B6%E6%89%AB%E6%8F%8F"><span class="nav-number">2.4.1.</span> <span class="nav-text">开启组件扫描</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="nav-number">2.4.2.</span> <span class="nav-text">创建控制器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEThymeleaf"><span class="nav-number">2.5.</span> <span class="nav-text">配置Thymeleaf</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Thymeleaf%E7%AE%80%E4%BB%8B"><span class="nav-number">2.5.1.</span> <span class="nav-text">Thymeleaf简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEThymeleaf-2"><span class="nav-number">2.5.2.</span> <span class="nav-text">配置Thymeleaf</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E6%9E%90%E7%AD%96%E7%95%A5%E8%AF%B4%E6%98%8E"><span class="nav-number">2.5.3.</span> <span class="nav-text">解析策略说明</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A6%96%E9%A1%B5%E8%AE%BF%E9%97%AE%E6%B5%8B%E8%AF%95"><span class="nav-number">2.6.</span> <span class="nav-text">首页访问测试</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E9%A1%B5%E9%9D%A2"><span class="nav-number">2.6.1.</span> <span class="nav-text">创建页面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A6%96%E9%A1%B5%E6%8E%A7%E5%88%B6%E6%96%B9%E6%B3%95"><span class="nav-number">2.6.2.</span> <span class="nav-text">首页控制方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%90%86%E8%AE%BA%E6%8C%87%E5%AF%BC"><span class="nav-number">2.6.2.1.</span> <span class="nav-text">理论指导</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%93%8D%E5%BA%94%E6%B5%81%E7%A8%8B"><span class="nav-number">2.6.2.2.</span> <span class="nav-text">响应流程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AETomcat"><span class="nav-number">2.6.2.3.</span> <span class="nav-text">配置Tomcat</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8Tomcat%E6%B5%8B%E8%AF%95"><span class="nav-number">2.6.2.4.</span> <span class="nav-text">启动Tomcat测试</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BF%E9%97%AE%E9%A1%B5%E9%9D%A2%E6%B5%8B%E8%AF%95"><span class="nav-number">2.7.</span> <span class="nav-text">访问页面测试</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E8%B6%85%E9%93%BE%E6%8E%A5"><span class="nav-number">2.7.1.</span> <span class="nav-text">设置超链接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%8C%87%E5%AE%9A%E9%A1%B5%E9%9D%A2"><span class="nav-number">2.7.2.</span> <span class="nav-text">创建指定页面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%AF%B9%E5%BA%94%E7%9A%84%E6%8E%A7%E5%88%B6%E6%96%B9%E6%B3%95"><span class="nav-number">2.7.3.</span> <span class="nav-text">创建对应的控制方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95"><span class="nav-number">2.7.4.</span> <span class="nav-text">测试</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%93%8D%E5%BA%94%E6%B5%81%E7%A8%8B%E6%80%BB%E7%BB%93"><span class="nav-number">2.8.</span> <span class="nav-text">响应流程总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#RequestMapping"><span class="nav-number">3.</span> <span class="nav-text">@RequestMapping</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%9F%E8%83%BD%E6%8F%8F%E8%BF%B0"><span class="nav-number">3.1.</span> <span class="nav-text">功能描述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%A8%E8%A7%A3%E5%8F%AF%E6%A0%87%E8%AF%86%E4%BD%8D%E7%BD%AE"><span class="nav-number">3.2.</span> <span class="nav-text">注解可标识位置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#value%E5%B1%9E%E6%80%A7"><span class="nav-number">3.3.</span> <span class="nav-text">value属性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E8%AF%B4%E6%98%8E"><span class="nav-number">3.3.1.</span> <span class="nav-text">属性说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="nav-number">3.3.2.</span> <span class="nav-text">示例代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ant%E9%A3%8E%E6%A0%BC%E8%B7%AF%E5%BE%84"><span class="nav-number">3.3.3.</span> <span class="nav-text">ant风格路径</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%A0%E4%BD%8D%E7%AC%A6%E4%BD%BF%E7%94%A8"><span class="nav-number">3.3.4.</span> <span class="nav-text">占位符使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89rest%E6%96%B9%E5%BC%8F%E5%8F%82%E6%95%B0"><span class="nav-number">3.3.4.1.</span> <span class="nav-text">定义rest方式参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81-2"><span class="nav-number">3.3.4.2.</span> <span class="nav-text">示例代码</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E5%9C%B0%E5%9D%80"><span class="nav-number">3.3.4.2.1.</span> <span class="nav-text">请求地址</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E6%96%B9%E6%B3%95"><span class="nav-number">3.3.4.2.2.</span> <span class="nav-text">控制方法</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#method%E5%B1%9E%E6%80%A7"><span class="nav-number">3.4.</span> <span class="nav-text">method属性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E8%AF%B4%E6%98%8E-2"><span class="nav-number">3.4.1.</span> <span class="nav-text">属性说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B4%BE%E7%94%9F%E6%B3%A8%E8%A7%A3"><span class="nav-number">3.4.2.</span> <span class="nav-text">派生注解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F"><span class="nav-number">3.4.3.</span> <span class="nav-text">其他请求方式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#params%E5%B1%9E%E6%80%A7"><span class="nav-number">3.5.</span> <span class="nav-text">params属性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E5%90%AB%E4%B9%89"><span class="nav-number">3.5.1.</span> <span class="nav-text">属性含义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81-3"><span class="nav-number">3.5.2.</span> <span class="nav-text">示例代码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%B5%E9%9D%A2%E8%AF%B7%E6%B1%82"><span class="nav-number">3.5.2.1.</span> <span class="nav-text">页面请求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E6%96%B9%E6%B3%95-2"><span class="nav-number">3.5.2.2.</span> <span class="nav-text">控制方法</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#headers%E5%B1%9E%E6%80%A7"><span class="nav-number">3.6.</span> <span class="nav-text">headers属性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E8%AF%B4%E6%98%8E-3"><span class="nav-number">3.6.1.</span> <span class="nav-text">属性说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81-4"><span class="nav-number">3.6.2.</span> <span class="nav-text">示例代码</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E5%BC%82%E5%B8%B8%E5%B0%8F%E7%BB%93"><span class="nav-number">3.7.</span> <span class="nav-text">匹配异常小结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"><span class="nav-number">4.</span> <span class="nav-text">获取请求参数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Servlet-API%E6%96%B9%E5%BC%8F"><span class="nav-number">4.1.</span> <span class="nav-text">Servlet-API方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%8C%E5%90%8D%E6%98%A0%E5%B0%84%E5%8C%B9%E9%85%8D"><span class="nav-number">4.2.</span> <span class="nav-text">同名映射匹配</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E5%B1%9E%E6%80%A7%E5%80%BC"><span class="nav-number">4.2.1.</span> <span class="nav-text">单属性值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E5%B1%9E%E6%80%A7%E5%80%BC"><span class="nav-number">4.2.2.</span> <span class="nav-text">多属性值</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B%E8%8E%B7%E5%8F%96"><span class="nav-number">4.2.2.1.</span> <span class="nav-text">字符串类型获取</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E7%B1%BB%E5%9E%8B%E8%8E%B7%E5%8F%96"><span class="nav-number">4.2.2.2.</span> <span class="nav-text">数组类型获取</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E6%98%A0%E5%B0%84%E5%8C%B9%E9%85%8D"><span class="nav-number">4.3.</span> <span class="nav-text">自映射匹配</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#RequestParam"><span class="nav-number">4.3.1.</span> <span class="nav-text">@RequestParam</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RequestHeader"><span class="nav-number">4.3.2.</span> <span class="nav-text">@RequestHeader</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CookieValue"><span class="nav-number">4.3.3.</span> <span class="nav-text">@CookieValue</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E8%A7%A3%E6%9E%90"><span class="nav-number">4.3.4.</span> <span class="nav-text">属性解析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#value-name"><span class="nav-number">4.3.4.1.</span> <span class="nav-text">value&amp;name</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#required-defaultValue"><span class="nav-number">4.3.4.2.</span> <span class="nav-text">required&amp;defaultValue</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E6%98%A0%E5%B0%84%E5%8C%B9%E9%85%8D"><span class="nav-number">4.4.</span> <span class="nav-text">对象属性映射匹配</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E7%9A%84%E4%B9%B1%E7%A0%81"><span class="nav-number">4.5.</span> <span class="nav-text">请求参数的乱码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GET%E8%AF%B7%E6%B1%82%E4%B9%B1%E7%A0%81"><span class="nav-number">4.5.1.</span> <span class="nav-text">GET请求乱码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#POST%E8%AF%B7%E6%B1%82%E4%B9%B1%E7%A0%81"><span class="nav-number">4.5.2.</span> <span class="nav-text">POST请求乱码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%9F%E7%94%9F%E6%96%B9%E6%B3%95%EF%BC%88%E6%97%A0%E6%95%88%EF%BC%89"><span class="nav-number">4.5.2.1.</span> <span class="nav-text">原生方法（无效）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8%E6%96%B9%E5%BC%8F"><span class="nav-number">4.5.2.2.</span> <span class="nav-text">过滤器方式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="nav-number">4.5.2.2.1.</span> <span class="nav-text">源码分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E7%BC%96%E7%A0%81%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="nav-number">4.5.2.2.2.</span> <span class="nav-text">设置编码过滤器</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9F%9F%E5%AF%B9%E8%B1%A1%E6%95%B0%E6%8D%AE%E5%85%B1%E4%BA%AB"><span class="nav-number">5.</span> <span class="nav-text">域对象数据共享</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Request%E5%9F%9F%E5%85%B1%E4%BA%AB"><span class="nav-number">5.1.</span> <span class="nav-text">Request域共享</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E7%94%9FServlet%E6%96%B9%E5%BC%8F"><span class="nav-number">5.1.1.</span> <span class="nav-text">原生Servlet方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ModelAndView%E6%96%B9%E5%BC%8F"><span class="nav-number">5.1.2.</span> <span class="nav-text">ModelAndView方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Map%E6%96%B9%E5%BC%8F"><span class="nav-number">5.1.3.</span> <span class="nav-text">Map方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Model%E6%96%B9%E5%BC%8F"><span class="nav-number">5.1.3.1.</span> <span class="nav-text">Model方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Map%E6%96%B9%E5%BC%8F-2"><span class="nav-number">5.1.3.2.</span> <span class="nav-text">Map方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ModelMap%E6%96%B9%E5%BC%8F"><span class="nav-number">5.1.3.3.</span> <span class="nav-text">ModelMap方式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Session%E5%9F%9F%E5%85%B1%E4%BA%AB"><span class="nav-number">5.2.</span> <span class="nav-text">Session域共享</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Application%E5%9F%9F%E5%85%B1%E4%BA%AB"><span class="nav-number">5.3.</span> <span class="nav-text">Application域共享</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SpringMVC%E8%A7%86%E5%9B%BE"><span class="nav-number">6.</span> <span class="nav-text">SpringMVC视图</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ThymeleafView"><span class="nav-number">6.1.</span> <span class="nav-text">ThymeleafView</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="nav-number">6.1.1.</span> <span class="nav-text">基本原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B"><span class="nav-number">6.1.2.</span> <span class="nav-text">解析过程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BD%AC%E5%8F%91%E8%A7%86%E5%9B%BE"><span class="nav-number">6.2.</span> <span class="nav-text">转发视图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86-2"><span class="nav-number">6.2.1.</span> <span class="nav-text">基本原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B-2"><span class="nav-number">6.2.2.</span> <span class="nav-text">解析过程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%87%8D%E5%AE%9A%E5%90%91%E8%A7%86%E5%9B%BE"><span class="nav-number">6.3.</span> <span class="nav-text">重定向视图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86-3"><span class="nav-number">6.3.1.</span> <span class="nav-text">基本原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B-3"><span class="nav-number">6.3.2.</span> <span class="nav-text">解析过程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%92%E7%BA%B3%E4%B8%8E%E6%80%BB%E7%BB%93"><span class="nav-number">6.4.</span> <span class="nav-text">归纳与总结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BD%92%E7%BA%B3"><span class="nav-number">6.4.1.</span> <span class="nav-text">归纳</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">6.4.2.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="nav-number">6.5.</span> <span class="nav-text">视图控制器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JSP%E5%BC%95%E5%85%A5%E7%A4%BA%E4%BE%8B"><span class="nav-number">6.6.</span> <span class="nav-text">JSP引入示例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEJSP%E8%A7%86%E5%9B%BE%E8%A7%A3%E6%9E%90%E5%99%A8"><span class="nav-number">6.6.1.</span> <span class="nav-text">配置JSP视图解析器</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#RESTFul"><span class="nav-number">7.</span> <span class="nav-text">RESTFul</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#REST%E7%AE%80%E4%BB%8B"><span class="nav-number">7.1.</span> <span class="nav-text">REST简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B5%84%E6%BA%90"><span class="nav-number">7.1.1.</span> <span class="nav-text">资源</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B5%84%E6%BA%90%E8%A1%A8%E8%BF%B0"><span class="nav-number">7.1.2.</span> <span class="nav-text">资源表述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8A%B6%E6%80%81%E8%BD%AC%E7%A7%BB"><span class="nav-number">7.1.3.</span> <span class="nav-text">状态转移</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RestFul%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-number">7.2.</span> <span class="nav-text">RestFul的实现</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92"><span class="nav-number">7.2.1.</span> <span class="nav-text">参数传递</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E6%96%B9%E5%BC%8F"><span class="nav-number">7.2.2.</span> <span class="nav-text">操作方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F%E5%AE%9E%E7%8E%B0"><span class="nav-number">7.2.3.</span> <span class="nav-text">请求方式实现</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-2"><span class="nav-number">7.2.3.1.</span> <span class="nav-text">源码分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93"><span class="nav-number">7.2.3.2.</span> <span class="nav-text">使用总结</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#PUT%E6%96%B9%E5%BC%8F"><span class="nav-number">7.2.3.2.1.</span> <span class="nav-text">PUT方式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#DELETE%E6%96%B9%E5%BC%8F"><span class="nav-number">7.2.3.2.2.</span> <span class="nav-text">DELETE方式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E7%A0%81%E8%BF%87%E6%BB%A4%E5%99%A8%E4%BC%98%E5%85%88"><span class="nav-number">7.2.4.</span> <span class="nav-text">编码过滤器优先</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RESTFul%E6%A1%88%E4%BE%8B"><span class="nav-number">7.3.</span> <span class="nav-text">RESTFul案例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%9F%E8%83%BD%E6%B8%85%E5%8D%95"><span class="nav-number">7.3.1.</span> <span class="nav-text">功能清单</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84"><span class="nav-number">7.3.2.</span> <span class="nav-text">基本架构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E5%B1%82"><span class="nav-number">7.3.2.1.</span> <span class="nav-text">数据访问层</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E4%BD%93bean"><span class="nav-number">7.3.2.1.1.</span> <span class="nav-text">实体bean</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#DAO%E5%8F%8A%E6%95%B0%E6%8D%AE%E6%A8%A1%E6%8B%9F"><span class="nav-number">7.3.2.1.2.</span> <span class="nav-text">DAO及数据模拟</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E5%B1%82"><span class="nav-number">7.3.2.2.</span> <span class="nav-text">业务逻辑层</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A6%96%E9%A1%B5%E8%AE%BF%E9%97%AE"><span class="nav-number">7.3.3.</span> <span class="nav-text">首页访问</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E6%89%80%E6%9C%89%E5%91%98%E5%B7%A5%E6%95%B0%E6%8D%AE"><span class="nav-number">7.3.4.</span> <span class="nav-text">查询所有员工数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%AB%AF%E4%BB%A3%E7%A0%81"><span class="nav-number">7.3.4.1.</span> <span class="nav-text">前端代码</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%91%E8%B5%B7%E8%AF%B7%E6%B1%82"><span class="nav-number">7.3.4.1.1.</span> <span class="nav-text">发起请求</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA%E9%A1%B5"><span class="nav-number">7.3.4.1.2.</span> <span class="nav-text">数据展示页</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E5%99%A8%E4%BB%A3%E7%A0%81"><span class="nav-number">7.3.4.2.</span> <span class="nav-text">控制器代码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E6%93%8D%E4%BD%9C"><span class="nav-number">7.3.5.</span> <span class="nav-text">删除操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%91%E8%B5%B7%E8%AF%B7%E6%B1%82%E4%BB%A3%E7%A0%81"><span class="nav-number">7.3.5.1.</span> <span class="nav-text">发起请求代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#vue%E5%AE%9E%E7%8E%B0%E8%A1%A8%E5%8D%95%E6%8F%90%E4%BA%A4"><span class="nav-number">7.3.5.2.</span> <span class="nav-text">vue实现表单提交</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BC%95%E5%85%A5vue-js%E8%B5%84%E6%BA%90"><span class="nav-number">7.3.5.2.1.</span> <span class="nav-text">引入vue.js资源</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E4%BA%8B%E4%BB%B6%E4%BB%A3%E7%A0%81"><span class="nav-number">7.3.5.2.2.</span> <span class="nav-text">编写事件代码</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E6%96%B9%E6%B3%95-3"><span class="nav-number">7.3.5.3.</span> <span class="nav-text">控制方法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%9D%E5%AD%98%E6%93%8D%E4%BD%9C"><span class="nav-number">7.3.6.</span> <span class="nav-text">保存操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E9%A1%B5%E9%9D%A2"><span class="nav-number">7.3.6.1.</span> <span class="nav-text">添加页面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%B3%E8%BD%AC%E5%88%B0%E6%B7%BB%E5%8A%A0%E9%A1%B5"><span class="nav-number">7.3.6.2.</span> <span class="nav-text">跳转到添加页</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E4%BF%9D%E5%AD%98"><span class="nav-number">7.3.6.3.</span> <span class="nav-text">执行保存</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E6%93%8D%E4%BD%9C"><span class="nav-number">7.3.7.</span> <span class="nav-text">更新操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E9%A1%B5%E9%9D%A2"><span class="nav-number">7.3.7.1.</span> <span class="nav-text">更新页面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%B3%E8%BD%AC%E5%88%B0%E6%9B%B4%E6%96%B0%E9%A1%B5"><span class="nav-number">7.3.7.2.</span> <span class="nav-text">跳转到更新页</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E6%9B%B4%E6%96%B0"><span class="nav-number">7.3.7.3.</span> <span class="nav-text">执行更新</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE"><span class="nav-number">8.</span> <span class="nav-text">静态资源访问</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5%E8%B5%84%E6%BA%90%E9%83%A8%E7%BD%B2"><span class="nav-number">8.1.</span> <span class="nav-text">检查资源部署</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%80%E5%90%AF%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE"><span class="nav-number">8.2.</span> <span class="nav-text">开启静态资源访问</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HttpMessageConverter"><span class="nav-number">9.</span> <span class="nav-text">HttpMessageConverter</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">9.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RequestBody"><span class="nav-number">9.2.</span> <span class="nav-text">@RequestBody</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RequestEntity"><span class="nav-number">9.3.</span> <span class="nav-text">RequestEntity</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ResponseBody"><span class="nav-number">9.4.</span> <span class="nav-text">@ResponseBody</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E7%94%9F%E6%96%B9%E5%BC%8F"><span class="nav-number">9.4.1.</span> <span class="nav-text">原生方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F-2"><span class="nav-number">9.4.2.</span> <span class="nav-text">注解方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%84%E7%90%86JSON%E6%95%B0%E6%8D%AE%E5%B0%8F%E7%BB%93"><span class="nav-number">9.4.3.</span> <span class="nav-text">处理JSON数据小结</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%95%E5%85%A5jackson%E4%BE%9D%E8%B5%96"><span class="nav-number">9.4.3.1.</span> <span class="nav-text">引入jackson依赖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%80%E5%90%AFMVC%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8"><span class="nav-number">9.4.3.2.</span> <span class="nav-text">开启MVC注解驱动</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%94%E5%9B%9EJSON%E6%95%B0%E6%8D%AE"><span class="nav-number">9.4.3.3.</span> <span class="nav-text">返回JSON数据</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RestController"><span class="nav-number">9.4.4.</span> <span class="nav-text">@RestController</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ResponseEntity"><span class="nav-number">9.5.</span> <span class="nav-text">ResponseEntity</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD"><span class="nav-number">10.</span> <span class="nav-text">文件上传和下载</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="nav-number">10.1.</span> <span class="nav-text">文件下载</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2"><span class="nav-number">10.1.1.</span> <span class="nav-text">前端页面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E5%99%A8%E6%96%B9%E6%B3%95"><span class="nav-number">10.1.2.</span> <span class="nav-text">控制器方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="nav-number">10.2.</span> <span class="nav-text">文件上传</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8A%E4%BC%A0%E9%A1%B5%E9%9D%A2"><span class="nav-number">10.2.1.</span> <span class="nav-text">上传页面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%95%E5%85%A5%E6%95%B0%E6%8D%AE%E8%A7%A3%E6%9E%90%E5%BA%93"><span class="nav-number">10.2.2.</span> <span class="nav-text">引入数据解析库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E5%99%A8%E6%96%B9%E6%B3%95-2"><span class="nav-number">10.2.3.</span> <span class="nav-text">控制器方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90%E5%99%A8"><span class="nav-number">10.2.4.</span> <span class="nav-text">文件上传解析器</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="nav-number">11.</span> <span class="nav-text">拦截器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-2"><span class="nav-number">11.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="nav-number">11.2.</span> <span class="nav-text">实现拦截器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0HandlerInterceptor%E6%8E%A5%E5%8F%A3"><span class="nav-number">11.2.1.</span> <span class="nav-text">实现HandlerInterceptor接口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E6%96%B9%E6%B3%95%E8%AF%B4%E6%98%8E"><span class="nav-number">11.2.1.1.</span> <span class="nav-text">默认方法说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B"><span class="nav-number">11.2.1.2.</span> <span class="nav-text">代码示例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="nav-number">11.2.2.</span> <span class="nav-text">配置拦截器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%A8%E6%8B%A6%E6%88%AA%E9%85%8D%E7%BD%AE"><span class="nav-number">11.2.2.1.</span> <span class="nav-text">全拦截配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8B%A6%E6%88%AA%E9%85%8D%E7%BD%AE"><span class="nav-number">11.2.2.2.</span> <span class="nav-text">自定义拦截配置</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E6%8B%A6%E6%88%AA%E5%99%A8%E6%89%A7%E8%A1%8C"><span class="nav-number">11.3.</span> <span class="nav-text">多拦截器执行</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8"><span class="nav-number">12.</span> <span class="nav-text">异常处理器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-3"><span class="nav-number">12.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8"><span class="nav-number">12.2.</span> <span class="nav-text">配置异常处理器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#xml%E6%96%B9%E5%BC%8F"><span class="nav-number">12.2.1.</span> <span class="nav-text">xml方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F-3"><span class="nav-number">12.2.2.</span> <span class="nav-text">注解方式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%97%A0%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%BC%80%E5%8F%91"><span class="nav-number">13.</span> <span class="nav-text">无配置文件开发</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="nav-number">13.1.</span> <span class="nav-text">Spring配置类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SpringMVC%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="nav-number">13.2.</span> <span class="nav-text">SpringMVC配置类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="nav-number">13.2.1.</span> <span class="nav-text">基本结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEThymeleaf-3"><span class="nav-number">13.2.2.</span> <span class="nav-text">配置Thymeleaf</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90%E5%99%A8"><span class="nav-number">13.2.3.</span> <span class="nav-text">配置文件上传解析器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%80%E5%90%AF%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE-2"><span class="nav-number">13.2.4.</span> <span class="nav-text">开启静态资源访问</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%8B%A6%E6%88%AA%E5%99%A8-2"><span class="nav-number">13.2.5.</span> <span class="nav-text">配置拦截器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E8%A7%86%E5%9B%BE%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="nav-number">13.2.6.</span> <span class="nav-text">配置视图控制器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%BC%82%E5%B8%B8%E8%A7%A3%E6%9E%90%E5%99%A8"><span class="nav-number">13.2.7.</span> <span class="nav-text">配置异常解析器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Servlet%E5%88%9D%E5%A7%8B%E5%8C%96%E7%B1%BB"><span class="nav-number">13.3.</span> <span class="nav-text">Servlet初始化类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-4"><span class="nav-number">13.3.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%88%9D%E5%A7%8B%E5%8C%96%E7%B1%BB"><span class="nav-number">13.3.2.</span> <span class="nav-text">配置初始化类</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SpringMVC%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B"><span class="nav-number">14.</span> <span class="nav-text">SpringMVC执行过程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6"><span class="nav-number">14.1.</span> <span class="nav-text">常用组件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DispatcherServlet%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%87%E7%A8%8B"><span class="nav-number">14.2.</span> <span class="nav-text">DispatcherServlet初始化过程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#init%E8%B0%83%E5%BA%A6%E8%BF%87%E7%A8%8B"><span class="nav-number">14.2.1.</span> <span class="nav-text">init调度过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#initWebApplicationContext%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="nav-number">14.2.2.</span> <span class="nav-text">initWebApplicationContext方法解析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#createWebApplicationContext-%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="nav-number">14.2.3.</span> <span class="nav-text">createWebApplicationContext()方法解析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DispatcherServlet%E5%88%9D%E5%A7%8B%E5%8C%96%E7%AD%96%E7%95%A5"><span class="nav-number">14.2.4.</span> <span class="nav-text">DispatcherServlet初始化策略</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DispatcherServlet%E8%B0%83%E7%94%A8%E7%BB%84%E4%BB%B6%E5%A4%84%E7%90%86%E8%AF%B7%E6%B1%82"><span class="nav-number">14.3.</span> <span class="nav-text">DispatcherServlet调用组件处理请求</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#service"><span class="nav-number">14.3.1.</span> <span class="nav-text">service()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#processRequest"><span class="nav-number">14.3.2.</span> <span class="nav-text">processRequest()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#doService"><span class="nav-number">14.3.3.</span> <span class="nav-text">doService()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#doDispatch"><span class="nav-number">14.3.4.</span> <span class="nav-text">doDispatch()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#processDispatchResult"><span class="nav-number">14.3.5.</span> <span class="nav-text">processDispatchResult()</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%8C%E6%95%B4%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="nav-number">14.4.</span> <span class="nav-text">完整执行流程</span></a></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>



    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-copy.js"></script>




    
<script src="/js/lazyload.js"></script>



<div class="post-scripts">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>



</body>
</html>
