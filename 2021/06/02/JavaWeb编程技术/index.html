<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="yhd">
    
    <title>
        
            JavaWeb编程技术 |
        
        DyhBlog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/MyLogo.svg">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"yoursite.com","root":"/","language":"en","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":false,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/avatar.jpg","favicon":"/images/MyLogo.svg","article_img_align":"left","left_side_width":"230px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.jpeg"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":false},"lazyload":{"enable":true},"version":"3.4.1"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 5.1.1"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            <a class="logo-title" href="/">
                DyhBlog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                TAGS
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">TAGS</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">JavaWeb编程技术</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.jpg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">yhd</span>
                        
                            <span class="author-label">Lv4</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;2021-06-02 19:54:32
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/JavaWeb/">JavaWeb</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>31.6k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>136 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h1 id="JavaWeb技术概述">JavaWeb技术概述</h1>
<h2 id="万维网">万维网</h2>
<ul>
<li><strong>WWW</strong>是World Wide Web简称，目的为了实现全世界能利用<strong>因特网进行文档交换</strong>，是一个大规模、分布式、联机式的信息储藏所。</li>
<li>Web是基于客户/服务器的一种B/S体系结构，其基本工作原理为，客户使用浏览器向Web服务器发出请求，服务器响应客户请求，向客户送回所请求的网页，客户在浏览器窗口上显示网页的内容。</li>
<li>组成Web体系的<strong>三大结构</strong>
<ul>
<li><strong>Web服务器</strong></li>
<li><strong>Web客户端</strong></li>
<li><strong>通信协议</strong></li>
</ul>
</li>
</ul>
<h3 id="Web服务器">Web服务器</h3>
<h4 id="基本概念">基本概念</h4>
<ul>
<li>Web服务器是向浏览器提供服务器的程序</li>
<li>Web服务器<strong>应用层使用HTTP协议</strong>，<strong>信息内容采用HTML</strong>，<strong>信息定位使用URL</strong></li>
<li>最常用的Web服务器是<strong>Apache</strong>服务器，开源、免费、Linux/Windows。另一种较为流行的Web服务器为Microsoft公司专门为Windows平台开发的<strong>IIS</strong>服务器</li>
<li><strong>Tomcat</strong>也是一种常用的<strong>Web服务器</strong>，它具有<strong>Web服务器</strong>功能同时<strong>也是Web容器</strong>，可允许Servlet和JSP</li>
</ul>
<h4 id="Tomcat-Sevlet-JSP-JDK版本对应关系">Tomcat&amp;Sevlet/JSP/JDK版本对应关系</h4>
<ul>
<li>当前企业常用Tomcati的版本 7、8</li>
<li><strong>Servlet2.5</strong>版本是现在世面使用最多的版本**(xml 配置**)</li>
<li><strong>Servlet3.0</strong> 之后就是<strong>注解</strong>版本的 Servlet 使用。</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210324223805.png"
                      alt=""
                ></p>
<hr>
<h4 id="其他Web服务器">其他Web服务器</h4>
<ul>
<li><strong>Jboss</strong>：是一个遵从 JavaEE 规范的、开放源代码的、纯 Java 的 EJB 服务器，它支持所有的 JavaEE 规范（免费）学习门槛高，不适合入门</li>
<li><strong>GlassFish</strong>： 由 Oracle 公司开发的一款 JavaWeb 服务器，是一款强健的商业(<strong>收费</strong>)服务器，达到产品级质量（应用很少）</li>
<li><strong>Resin</strong>：是 CAUCHO 公司的产品，是一个非常流行的服务器，对 servlet 和 JSP 提供了良好的支持， 性能也比较优良，resin 自身采用 JAVA 语言开发（<strong>收费</strong>，应用比较多）。</li>
<li><strong>WebLogic</strong>：是 Oracle 公司的产品，是目前应用<strong>最广泛的 Web</strong> 服务器，支持 JavaEE 规范， 而且不断的完善以适应新的开发要求，适合大型项目（<strong>收费</strong>，用的不多，适合大公司）</li>
</ul>
<h3 id="Web客户端">Web客户端</h3>
<p>​	浏览器主要功能想服务器发送请求与对响应信息进行解析、并正确显示出来</p>
<h3 id="通讯协议">通讯协议</h3>
<h4 id="HTTP">HTTP</h4>
<ul>
<li>HTTP协议成为<strong>超文本传输协议</strong>，规定了Web客户与服务器之间<strong>如何通信</strong></li>
<li>是一个基于<strong>请求-响应</strong>的协议，是无状态的</li>
<li>主要<strong>通信流程</strong>
<ol>
<li>在浏览器输入网址，按下Enter键</li>
<li>浏览器建立一个<strong>HTTP</strong>请求信息，使用<strong>DNS</strong>获得网址的<strong>IP</strong>地址</li>
<li>通过IP地址与服务器建立一条<strong>TCP</strong>连接</li>
<li>通过这条TCP连接将<strong>HTTP信息</strong>发送给服务器，并从服务器接收回一条信息</li>
</ol>
</li>
</ul>
<h4 id="URL-URI">URL&amp;URI</h4>
<p><strong>URL</strong>称为统一资源定位符，用于在Internet中定位某个主机的资源，主要四部分组成</p>
<ol>
<li><strong>协议名称</strong>：如HTTP、FTP、TELNET、MAIL等</li>
<li><strong>主机域名或IP地址</strong>：<a class="link"   target="_blank" rel="noopener" href="http://www.baidu.com" >www.baidu.com<i class="fas fa-external-link-alt"></i></a>、localhos、127.0.0.1等</li>
<li>[<strong>端口号</strong>]：Web应用的80端口等，可忽略不写</li>
<li><strong>资源名称</strong>：资源在服务器上的相对路径和名称，如/index.html</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.baidu.com&#x2F;</span><br><span class="line">https:&#x2F;&#x2F;www.baidu.com&#x2F;helloweb&#x2F;hello.jsp</span><br></pre></td></tr></table></figure>
<ul>
<li>URI，URN
<ul>
<li>URL：<code>https://www.baidu.com/helloweb/hello.jsp</code></li>
<li>URI：<code>helloweb/hello.jsp</code></li>
</ul>
</li>
</ul>
<h4 id="状态码">状态码</h4>
<table>
<thead>
<tr>
<th>状态码范围</th>
<th>含义</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td>1**</td>
<td>表示信息</td>
<td>100表示服务器同意处理客户的请求</td>
</tr>
<tr>
<td>2**</td>
<td>表示请求成功</td>
<td>200表示请求成功，204表示内容不存在</td>
</tr>
<tr>
<td>3**</td>
<td>表示重定向</td>
<td>301表示页面移走了，304表示缓存的页面仍然有效</td>
</tr>
<tr>
<td>4**</td>
<td>表示客户的错误</td>
<td>403表示禁止的页面，404表示页面没有找到</td>
</tr>
<tr>
<td>5**</td>
<td>表示服务器的错误</td>
<td>500表示服务器内部错误，503表示以后再试</td>
</tr>
</tbody>
</table>
<h2 id="服务器资源">服务器资源</h2>
<h3 id="资源类型">资源类型</h3>
<p>Web服务器处理客户端请求有两种方式</p>
<ol>
<li><strong>静态</strong>请求：客户端所需请求的资源<strong>不需要进行任何处理</strong>，直接作为HTTP响应返回。对应的资源称之为<strong>静态资源</strong></li>
<li><strong>动态</strong>请求：客户端所需请求的资源需要在服务器<strong>委托</strong>给一些服务器端技术<strong>进行处理</strong>，如CGI、JSP、ASP等，然后将处理结果作为HTTP响应返回，对应地也成为<strong>动态资源</strong></li>
</ol>
<h3 id="动态文档技术">动态文档技术</h3>
<p>动态文档是指文档的内容可根据需要动态生成，同时又分以下两种技术：</p>
<ul>
<li>
<p><strong>服务器端</strong>动态文档技术：</p>
<ul>
<li><strong>模块化</strong>技术：<strong>CGI</strong>、<strong>Servlet</strong>—java解决方案</li>
<li>Web文档<strong>嵌入式脚本</strong>：<strong>ASP</strong>、<strong>PHP</strong>、<strong>JSP</strong></li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210325111711.png"
                      style="zoom:80%;" /
                >
</li>
<li>
<p><strong>客户端</strong>动态文档技术</p>
<ul>
<li><strong>JavaScript</strong></li>
</ul>
</li>
</ul>
<h1 id="Tomcat">Tomcat</h1>
<h2 id="安装">安装</h2>
<ol>
<li>
<p>下载Tomcat，<a class="link"   target="_blank" rel="noopener" href="https://tomcat.apache.org/" >官方链接<i class="fas fa-external-link-alt"></i></a></p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210325100045.png"
                      style="zoom:80%;" /
                >
</li>
<li>
<p>将下载的安装包<strong>直接解压到</strong>指定目录即可</p>
</li>
<li>
<p>找到Tomcat目录下的<strong>bin目录</strong>，双击<strong>startup.bat</strong>文件即可启动</p>
</li>
<li>
<p>在浏览器输入输入地址 <a class="link"   target="_blank" rel="noopener" href="http://localhost:8080" >http://localhost:8080<i class="fas fa-external-link-alt"></i></a> ，若出现tomcat首页则表示安装成功</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210327204432.png"
                      alt=""
                ></p>
</li>
</ol>
<h2 id="目录介绍">目录介绍</h2>
<ul>
<li><strong>bin</strong>：用与存放Tomcat 服务器的<strong>可执行程序</strong></li>
<li><strong>conf</strong>：用与存放Tocmat 服务器的配置文件</li>
<li><strong>lib</strong>：用与存放Tomcat 服务器的<strong>jar 包</strong>，对应javaEE的实现规范的实现类</li>
<li><strong>logs</strong> ：用与存放Tomcat 服务器运行时输出的<strong>日志信息</strong></li>
<li><strong>temp</strong>：用与存放Tomcdat 运行时产生的<strong>临时数据</strong></li>
<li><strong>webapps</strong>：用与存放<strong>部署的Web</strong>工程，根目录下，<strong>一个文件夹一个Web工程</strong></li>
<li><strong>work</strong>：是Tomcat<strong>工作时的目录</strong>，用来存放 Tomcat 运行时 <strong>jsp 翻译为 Servlet 的源码</strong>，和 Session 钝化的目录</li>
</ul>
<h2 id="启动与关闭">启动与关闭</h2>
<h3 id="启动方式">启动方式</h3>
<ol>
<li>Tomcat目录下的<strong>bin目录</strong>，双击<strong>startup.bat</strong>文件即可启动，或以<strong>命令行方式</strong>在路径下执行命令<code>startup</code></li>
<li>用<strong>命令行方式</strong>在路径下执行命令<code>catalina run</code></li>
</ol>
<hr>
<ul>
<li>
<p>startup命令的源码解析：为了可以在任意目录下启动 Tomcat 服务器，可以选择把bin目录添加到 path下，此时在任意目录下通过startup命令启动Tomcat服务器会提示如下错误，即<strong>要求设置 CATALINA_HOME 这个环境变量</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">The CATALINA_HOME environment variable is not defined correctly</span><br><span class="line">This environment variable is needed to run this program</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>阅读startup.bat批处理文件源码可知，<strong>CATALINA_HOME环境变量</strong>指向为Tomcat安装的根目录(bin目录的上一级目录)</p>
</li>
<li>
<p>startup.bat 文件，实际调用的是<strong>catalina.bat</strong>文件</p>
</li>
<li>
<p>通过命令行窗口直接输入catalina, 提示如下，表示<code>catalina</code>命令的可选参数</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">commands:</span></span><br><span class="line"><span class="function"><span class="title">debug</span>             <span class="title">Start</span> <span class="title">Catalina</span> <span class="title">in</span> <span class="title">a</span> <span class="title">debugger</span></span></span><br><span class="line"><span class="function"><span class="title">debug</span> -<span class="title">security</span>   <span class="title">Debug</span> <span class="title">Catalina</span> <span class="title">with</span> <span class="title">a</span> <span class="title">security</span> <span class="title">manager</span></span></span><br><span class="line"><span class="function"><span class="title">jpda</span> <span class="title">start</span>        <span class="title">Start</span> <span class="title">Catalina</span> <span class="title">under</span> <span class="title">JPDA</span> <span class="title">debugger</span></span></span><br><span class="line"><span class="function"><span class="title">run</span>               <span class="title">Start</span> <span class="title">Catalina</span> <span class="title">in</span> <span class="title">the</span> <span class="title">current</span> <span class="title">window</span></span></span><br><span class="line"><span class="function"><span class="title">run</span> -<span class="title">security</span>     <span class="title">Start</span> <span class="title">in</span> <span class="title">the</span> <span class="title">current</span> <span class="title">window</span> <span class="title">with</span> <span class="title">security</span> <span class="title">manager</span></span></span><br><span class="line"><span class="function"><span class="title">start</span>             <span class="title">Start</span> <span class="title">Catalina</span> <span class="title">in</span> <span class="title">a</span> <span class="title">separate</span> <span class="title">window</span></span></span><br><span class="line"><span class="function"><span class="title">start</span> -<span class="title">security</span>   <span class="title">Start</span> <span class="title">in</span> <span class="title">a</span> <span class="title">separate</span> <span class="title">window</span> <span class="title">with</span> <span class="title">security</span> <span class="title">manager</span></span></span><br><span class="line"><span class="function"><span class="title">stop</span>              <span class="title">Stop</span> <span class="title">Catalina</span></span></span><br><span class="line"><span class="function"><span class="title">version</span>           <span class="title">What</span> <span class="title">version</span> <span class="title">of</span> <span class="title">tomcat</span> <span class="title">are</span> <span class="title">you</span> <span class="title">running</span>?</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>常用的catalina命令选项如下</p>
<ul>
<li><strong>run</strong>：在 catalina 同一个命令行窗口下启动服务器.</li>
<li><strong>start</strong>：开启一个新窗口启动服务器</li>
<li><strong>stop</strong>：关闭服务器</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="关闭方式">关闭方式</h3>
<ul>
<li><strong>方式一</strong>：点击tomcat 服务器窗口右上角X关闭</li>
<li><strong>方式二</strong>：把Tomcat 服务器窗口置为当前窗口，然后按快捷键 Ctrl+C</li>
<li><strong>方式三</strong>：找到Tomcat的<strong>bin</strong>目录下的 <code>shutdown.bat</code> 双击，或cmd进入该目录执行<code>shutdown</code>，就可以停止 Tomcat 服务器</li>
</ul>
<h3 id="常见错误">常见错误</h3>
<p>首先，建议通过CMD命令行的方式进入到bin目录下，通过命令行的方式执行<code>catalina run</code>命令，则会有错误提示信息显示</p>
<ol>
<li>双击startup.bat出现黑窗口一闪而过，JAVA_HOME环境变量没有配置正确</li>
</ol>
<h2 id="修改默认端口号">修改默认端口号</h2>
<ol>
<li>
<p>找到Tomcat目录下的<strong>conf目录</strong>，找到 <strong>server.xml</strong></p>
</li>
<li>
<p>修改如下标签下的<code>port</code>属性端口号信息即可</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">&quot;7777&quot;</span> <span class="attr">protocol</span>=<span class="string">&quot;HTTP/1.1&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">connectionTimeout</span>=<span class="string">&quot;20000&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">redirectPort</span>=<span class="string">&quot;8443&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>修改后需<strong>重启</strong>Tomcat服务器才能生效</p>
</li>
</ol>
<h1 id="Web工程部署">Web工程部署</h1>
<p>Tomcat目录下的<strong>webapps目录</strong>：存放<strong>部署的Web</strong>工程，<strong>一个文件夹一个Web工程</strong>。如默认tomcat含以下<strong>5个web应用</strong>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210327204809.png"
                      alt=""
                ></p>
<hr>
<p>无论静态还是动态资源，Tomcat中web工程部署均有两种</p>
<ul>
<li>拷贝到webapps下的指定工程目录中</li>
<li>通过配置tomcat xml文件实现映射式的部署</li>
</ul>
<h2 id="静态资源部署">静态资源部署</h2>
<ul>
<li>
<p><strong>方式一</strong>：把 web 工程的目录<strong>拷贝</strong>到 Tomcat的<strong>webapps/web目录</strong>下</p>
<ol>
<li>
<p>在<strong>webapps</strong>目录下新建web应用的文件夹，如helloWeb</p>
</li>
<li>
<p>将web应用内容拷贝的该文件夹内</p>
</li>
<li>
<p><a class="link"   target="_blank" rel="noopener" href="http://localhost:8888" >http://localhost:8888<i class="fas fa-external-link-alt"></i></a> 对应webapps的根目录，url与webapps目录的路径关系如下</p>
</li>
<li>
<p>稍等十几秒后，一般tomcat会自动重新部署。若没有效果，则可以尝试重启tomcat服务器</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210327205553.png"
                      style="zoom:80%;" /
                >
</li>
</ol>
</li>
<li>
<p><strong>方式二</strong>：配置文件<strong>映射</strong>部署，即项目任意路径部署</p>
<ol>
<li>
<p>找到Tomcat下的 <strong>conf</strong>目录<code>\Catalina\localhost\ </code>根目录下,创建如下<strong>xml配置文件</strong>，一般一个工程一个xml文件。(旧版本的tomcat可能不存在上述目录，没有就自己建立这个目录结构即可)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Context</span> <span class="attr">path</span>=<span class="string">&quot;/abc&quot;</span> <span class="attr">docBase</span>=<span class="string">&quot;E:\book&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>.xml文件的<strong>文件名</strong>：tomcat9测试，xml文件名才是决定访问(url)根路径</li>
<li><s><strong>path</strong>：表示工程的访问(url)路径，如<code>/abc</code></s></li>
<li><strong>docBase</strong>：表示你的<strong>工程目录</strong>在磁盘下的路径</li>
</ul>
</li>
<li>
<p>一般修改添加或删除，tomcat中的web应用内容，稍等十多秒会<strong>自动重新部署</strong>。若没有效果，则可以重启tomcat服务器使其部署</p>
</li>
</ol>
</li>
</ul>
<h2 id="动态资源部署">动态资源部署</h2>
<h3 id="Web工程目录">Web工程目录</h3>
<p>Servlet 规范中定义了 web 应用程序的目录层次</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">|--Web开发项目		  </span><br><span class="line">    |----src			&#x2F;&#x2F;存放源代码</span><br><span class="line">    ---------------------以上为常见IDE开发时提供的目录结构----</span><br><span class="line">    ---------------------以下为Servlet规范目录结构----------</span><br><span class="line">    |----WEB资源根目录	 &#x2F;&#x2F;约定：但不规定目录名(eclipse WebContent,IDEA web)</span><br><span class="line">    |-------WEB-INF		&#x2F;&#x2F;约定：存放供服务器访问的资源(浏览器无法直接访问)</span><br><span class="line">            classes		&#x2F;&#x2F;约定：存放编译后.class文件</span><br><span class="line">            web.xml		&#x2F;&#x2F;约定：整个动态web工程的配置部署描述文件，配置如(servlet、filter...)组件</span><br><span class="line">                         [apache-tomcata安装根目录]\webapps\docs\WEB-INF 中复制过来</span><br><span class="line">            lib			&#x2F;&#x2F;约定：存放web应用程序用到的jar文件	</span><br><span class="line">    |----css			</span><br><span class="line">    |----img					</span><br><span class="line">         ...</span><br><span class="line">    |----index.html</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>注意</strong>：在IDEA中，web根目录下不允许直接存放静态资源文件，如img、.js等，否则不能访问。换言之只允许直接存放html、jsp文件。其他文件均需至少创建一个文件夹目录后存入才可以访问。</li>
</ul>
<h3 id="步骤如下">步骤如下</h3>
<p>tips：以下以eclipse环境下，手动创建普通java项目，并手动拷贝部署到tomcat的过程，很少使用。拟在突出web工程目录的结构与作用。</p>
<ol>
<li>
<p>在 src下新建一个 Person</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getPersonInfo</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;person info...&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>手工的 Person 类对应的编译后的.class 文件(在工程的bin目录下，含包目录结构均需复制)复制到 classes 目录下</p>
</li>
<li>
<p>在 WebContent 目录下新建一个 JSP 文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">&quot;java&quot;</span> <span class="attr">contentType</span>=<span class="string">&quot;text/html; charset=ISO-8859-1&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">&quot;ISO-8859-1&quot;</span>%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">Person</span> <span class="attr">person</span> = <span class="string">new</span> <span class="attr">Person</span>();</span></span><br><span class="line"><span class="tag">	<span class="attr">System.out.print</span>(<span class="attr">person.getPersonInfo</span>()); </span></span><br><span class="line"><span class="tag">%&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>把 WebContent 目录复制到 Tomcat 的 webapps 目录下, 并改名为: helloworld</p>
</li>
<li>
<p>在浏览器的地址栏中输入: <a class="link"   target="_blank" rel="noopener" href="http://localhost:8080/helloworld/hello.jsp" >http://localhost:8080/helloworld/hello.jsp<i class="fas fa-external-link-alt"></i></a> 即可看到命令行的打印信息</p>
</li>
</ol>
<h3 id="半自动化工程部署">半自动化工程部署</h3>
<p>tips：基于eclipse开发环境</p>
<ol>
<li>可以通过修改src默认的输出目录达到自动把编译好的 class 放到 classes 目录下</li>
<li>通过方式二，实现开发目录与实际部署目录的映射</li>
</ol>
<h2 id="默认工程及首页">默认工程及首页</h2>
<ul>
<li>当地址栏输入访问地址<strong>没有工程名</strong>地址：<code>http://ip:port/</code>  ，默认访问的是 ROOT 工程。</li>
<li>当地址栏输入访问地址<strong>只有工程名</strong>地址： <code>http://ip:port/工程名/</code>，默认访问工程内的 <strong>index.html</strong> 页面</li>
</ul>
<h1 id="IDEA整合Tomcat">IDEA整合Tomcat</h1>
<h2 id="整合Tomcat服务器">整合Tomcat服务器</h2>
<ol>
<li>
<p><strong>进入IDEA如下设置</strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210327215834.png"
                      alt=""
                ></p>
</li>
<li>
<p>配置你的 Tomcat 安装目录，可以添加多个不同版本的tomcat</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210327220051.png"
                      alt=""
                ></p>
</li>
</ol>
<h2 id="创建动态Web工程">创建动态Web工程</h2>
<ol>
<li>
<p>2020版本后的IDEA，建立非Maven管理的web项目需<strong>先建立一个普通</strong>的java Model。右键Add Framework Support</p>
<p>(若选择使用maven则可以在建立model时选择java enterprise)</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210327221135.png"
                      alt=""
                ></p>
</li>
<li>
<p>勾选Web Application ，勾选Create web.xml</p>
</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210327221507.png"
                      alt=""
                ></p>
<ol start="3">
<li>
<p>创建成功如下图，(一般手动di在WEB-INF目录下建立一个lib目录)</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210327221705.png"
                      alt=""
                ></p>
</li>
</ol>
<h2 id="启动Web工程">启动Web工程</h2>
<ol>
<li>
<p>每当创建一个web工程时，IDEA会对应Web工程创建一个Tomcat实例</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210327225539.png"
                      alt=""
                ></p>
</li>
<li>
<p>确认你的 Tomcat 实例中有你要部署运行的 web 工程模块</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210328111834.png"
                      alt=""
                ></p>
</li>
<li>
<p>为了方便使用，一般将<strong>tomcat name</strong>、<strong>URL</strong>、<strong>Application context</strong>三者设置为与<strong>项目名称一致</strong>。则能实现启动项目后，自动调用浏览器且访问的就是Web工程</p>
</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210328111620.png"
                      alt=""
                ></p>
<hr>
<p>Server窗口下的<strong>URL</strong>与Deployement窗口下的<strong>Application context</strong>的区别</p>
<ul>
<li>Server — <strong>URL</strong>：web应用启动后，IDEA自动<strong>调用浏览器访问的地址</strong>(不一定是web工程访问地址)</li>
<li>Deployement — <strong>Application context</strong>：当前<strong>web工程的根目录访问地址</strong>，即在web.xml配置servlet的隐射地址时候斜杠<code>/</code>就是指该路径</li>
</ul>
<hr>
<ol>
<li>如下图显示设置
<ul>
<li>URL设置为：<a class="link"   target="_blank" rel="noopener" href="http://localhost:8080/abc" >http://localhost:8080/abc<i class="fas fa-external-link-alt"></i></a></li>
<li><strong>Application context</strong>设置为：<a class="link"   target="_blank" rel="noopener" href="http://localhost:8080/06_helloServlet/" >http://localhost:8080/06_helloServlet/<i class="fas fa-external-link-alt"></i></a></li>
</ul>
</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210328110559.png"
                      alt=""
                ></p>
<ol start="2">
<li>
<p>当项目启动后，IDEA自动调用浏览器访问的地址是：<a class="link"   target="_blank" rel="noopener" href="http://localhost:8080/abc%E3%80%82%E5%9B%A0%E4%B8%BA%E5%AE%9E%E9%99%85web%E5%BA%94%E7%94%A8%E7%9A%84%E8%AE%BF%E9%97%AE%E5%9C%B0%E5%9D%80%E6%98%AFapplication" >http://localhost:8080/abc。因为实际web应用的访问地址是application<i class="fas fa-external-link-alt"></i></a> context决定的，所以找不到页面如下提示</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210328110854.png"
                      alt=""
                ></p>
<ol start="3">
<li>
<p>当访问application context 设置的url即可访问到web应用</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210328110947.png"
                      alt=""
                ></p>
</li>
</ol>
</li>
<li>
<p>IDEA中、启动、debug启动、停止、与重启按钮说明</p>
</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210327231117.png"
                      alt=""
                ></p>
<ul>
<li>
<p>IDEA中默认启动web项目的效果</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210327231802.png"
                      alt=""
                ></p>
</li>
<li>
<p>重启选项说明</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210327231555.png"
                      alt=""
                ></p>
</li>
</ul>
<h2 id="IDEA中修改端口号">IDEA中修改端口号</h2>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210328090701.png"
                      alt=""
                ></p>
<h2 id="配置资源热部署">配置资源热部署</h2>
<p><strong>热部署</strong>：正在运行状态的应用,修改了他的源码之后,在不重新启动的情况下能够自动把增量内容编译并部署到服务器上</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210328090823.png"
                      alt=""
                ></p>
<h2 id="IDEA创建Servlet">IDEA创建Servlet</h2>
<ol>
<li>
<p>检查项目是否添加了<strong>servlet-api.jar</strong>与<strong>jsp-api.jar</strong></p>
</li>
<li>
<p>在指定包下右键—&gt;New—&gt;Servlet创建即可</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210329150247.png"
                      alt=""
                ></p>
</li>
</ol>
<h2 id="IDEA的部署逻辑">IDEA的部署逻辑</h2>
<p>IDEA整合Tomcat后部署逻辑</p>
<p>tips：一般的整合Tomcat的IDE，如eclipse、IDEA逻辑都类似</p>
<ol>
<li>
<p>编写如下测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestGetRealPath</span> <span class="keyword">implements</span> <span class="title">Servlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig servletConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        String path = servletConfig.getServletContext().getRealPath(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;path = &quot;</span> + path);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//@Override method....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>在整合了Tomcat的IDEA中启动Web工程，可以从service信息打印窗口看到如下信息</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210406225119.png"
                      alt=""
                ></p>
</li>
</ol>
<ul>
<li>
<p><strong>Using CATALINA_BASE</strong>：</p>
<p>Web项目<strong>编译后</strong>真正运行<code>.class</code>文件则被复制到<code>C:\Users\[用户名]\AppData\Local\JetBrains\[IntelliJIdea版本]\tomcat\...</code>目录下。即</p>
<ul>
<li>含Web应用源码编译后的<code>.class</code>文件</li>
<li>含<code>.jsp</code>文件对应的<code>_jsp.java</code>源码，以及编译后的<code>.class</code>文件</li>
<li>含用于Tomcat中完整的配置与项目部署映射所有需要的配置文件。目的是使能在IDEA中直接设置一些有关Tomcat的配置生效，如设置端口号，IDEA自定义的项目映射部署等…</li>
</ul>
</li>
<li>
<p>getRealPath(&quot;/&quot;)输出的内容其实是web部署的实际物理位置，IDEA会将部署的Web应用下的根目录(web目录)的所有内容拷贝到 <code>创建项目物理机地址\out\artifacts\项目工程名</code>目录下，这个目录就是<strong>被IDEA认为</strong>的web<strong>应用部署后源代码的真实路径(非运行路径)</strong>，并非开发目录。因此getRealPath(&quot;/&quot;)输出就是这个路径。并且是与<strong>开发代码时web下目录结构是完全对应</strong>的。</p>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210406225526.png"
                      alt=""
                ></p>
<h1 id="Servlet">Servlet</h1>
<h2 id="Servlet及其容器">Servlet及其容器</h2>
<ul>
<li>
<p><strong>Servlet</strong>：Servlet是用Java编写的<a class="link"   target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%9C%8D%E5%8A%A1%E5%99%A8/100571" >服务器<i class="fas fa-external-link-alt"></i></a>端程序，主要功能在于交互式地浏览和生成动态<a class="link"   target="_blank" rel="noopener" href="https://baike.baidu.com/item/Web/150564" >Web<i class="fas fa-external-link-alt"></i></a>内容。</p>
<p>狭义的Servlet是指Java语言实现的一个接口，广义的Servlet是指任何实现了这个Servlet接口的类，一般情况下，人们将Servlet理解为后者。Servlet运行于支持Java的应用服务器中。</p>
</li>
</ul>
<ol>
<li>Servlet是 <strong>JavaEE 规范</strong>之一，规范就是<strong>接口。</strong></li>
<li>Servlet是JavaWeb 三大组件之一。(Servlet 程序、Filter 过滤器、Listener 监听器)</li>
<li>Servlet是运行在服务器上的一个 java 小程序，可以接收客户端发送过来的请求，并响应数据给客端。</li>
</ol>
<ul>
<li>
<p><strong>Servlet 容器</strong>:</p>
<p>Servlet容器为JavaWeb应用提供<strong>运行时环境</strong>，它负责管理Servlet和JSP的生命周期，以及管理它们的共享数据</p>
<ol>
<li>运行 Servlet、JSP、Filter 等的软件环境.</li>
<li><strong>创建</strong> Servlet, 并<strong>调用</strong> Servlet 的相关生命周期方法。</li>
</ol>
</li>
</ul>
<h2 id="Servlet接口实现">Servlet接口实现</h2>
<ol>
<li>编写一个类去<strong>实现 Servlet 接口</strong></li>
<li><strong>编写</strong>实现<strong>service方法</strong>，处理请求，并响应数据</li>
<li>在web.xml中设置Servlet接口映射
<ul>
<li><code>&lt;servlet&gt;&lt;/servlet&gt;</code></li>
<li><code>&lt;servlet-mapping&gt;&lt;/servlet-mapping&gt;</code></li>
<li>tips：任何web.xml的修改都需重新部署才会生效</li>
</ul>
</li>
</ol>
<hr>
<ol>
<li>
<p><strong>实现接口</strong>：tips，IDEA若无法识别Servlet接口则需要手动导入servlet-api.jar包，一般在tomcat安装路径下lib目录中可以找到</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServlet</span> <span class="keyword">implements</span> <span class="title">Servlet</span> </span>&#123;</span><br><span class="line">    <span class="comment">//建立一个空参构造器</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HelloServlet</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;HelloServlet实例化成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig servletConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;init...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getServletConfig&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest servletRequest, ServletResponse	</span></span></span><br><span class="line"><span class="function"><span class="params">        servletResponse)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hello service&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getServletInfo&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;destroy&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>设置web.xml接口映射：<code>&lt;servlet&gt;</code>标签与<code>&lt;servlet-mapping&gt;</code>映射标签</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--servlet-name 标签为Servlet程序自定义一个别名(一般是类名) --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--servlet-class 是 Servlet 程序的全类名--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.test.servlet.HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--servlet-mapping 标签给 servlet 程序配置映射的访问地址--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--servlet-name 标签指定设置映射的Servlet程序别名--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--url-pattern 标签配置访问地址 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">		&lt;url-pattern&gt;标签内容必须以斜杠打头</span></span><br><span class="line"><span class="comment">		 /   斜杠 ：表示地址为：http://ip:port/工程路径 </span></span><br><span class="line"><span class="comment">		 /hello  : 表示地址为：http://ip:port/工程路径/hello </span></span><br><span class="line"><span class="comment">		--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>小结：</p>
<ul>
<li><code>&lt;url-pattern&gt;</code>标签内容必须<strong>以斜杠打头</strong></li>
<li>若使用通配符只有两种使用方式
<ol>
<li><code>.扩展名</code>，如<code>.html</code>表示所有html结尾的文件均由该servlet受理</li>
<li><code>/*</code>，所有接口调用都受理</li>
</ol>
</li>
</ul>
</li>
<li>
<p>常见错误：</p>
<ul>
<li>url-pattern 中配置的路径没有以斜杠打头</li>
<li>servlet-name 配置的值不存在</li>
<li>servlet-class 标签的全类名配置错误</li>
</ul>
</li>
</ul>
</li>
<li>
<p>最终效果</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210330173225.png"
                      alt=""
                ></p>
</li>
</ol>
<h2 id="Servlet生命周期">Servlet生命周期</h2>
<p>Servlet 生命周期：以下方法均由<strong>Serlvet容器负责调用</strong>.</p>
<ol>
<li><strong>构造器</strong>: 只被调用<strong>一次</strong>，对指定Servle进行首次访问时创建 Servlet 的实例 (Serlvet 的单实例)</li>
<li><strong>init</strong>：只被调用<strong>一次</strong>，在创建好Servlet<strong>实例后立即被调用</strong>，用于初始化当前 Servlet.</li>
<li><strong>service</strong>：被<strong>多次</strong>调用，每次请求都会调用 service 方法. 实际用于响应请求的.</li>
<li><strong>destroy</strong>：只被调用<strong>一次</strong>，在当前 Servlet所在的 WEB 应用<strong>被卸载前</strong>调用，用于释放当前 Servlet 所占用的资源.</li>
</ol>
<hr>
<blockquote>
<ol>
<li>Servlet引擎检查是否已经装载并创建了该Servlet的实例对象。如果是，则直接执行第④步，否则，执行第2步。</li>
<li>装载并创建该Servlet的一个实例对象：调用该 Servlet 的构造器</li>
<li>调用Servlet实例对象的init()方法。</li>
<li>创建一个用于封装请求的ServletRequest对象和一个代表响应消息的ServletResponse对象，然后调用Servlet的service()方法并将请求和响应对象作为参数传递进去。</li>
<li>WEB应用程序被停止或重新启动之前，Servlet引擎将卸载Servlet，并在卸载之前调用Servlet的destroy()方法。</li>
</ol>
</blockquote>
<hr>
<p><strong>load-on-startup标签</strong>: 可以设置Serlvet被创建的时机，若为负数, 则在如上普通生命周期般，要<strong>被调用</strong>，才会实例化与初始化，若为0或正数, 则在当前 WEB 应用被Serlvet 容器<strong>加载时</strong>(启动web应用时，不用调用)就会<strong>创建实例</strong>，且数组越小越早被创建。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- .... --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="相关接口与类">相关接口与类</h3>
<ul>
<li>init()：<strong>ServletConfig</strong></li>
<li>service()：<strong>ServletRequest , ServletResponse</strong></li>
</ul>
<p>以讲解实现servlet接口后出现的相关接口与类展开学习servlet</p>
<h2 id="ServletConfig">ServletConfig</h2>
<h3 id="基本概念-2">基本概念</h3>
<ul>
<li><strong>每个 Servlet</strong> 程序创建时，就创建一个对应的 ServletConfig 对象。</li>
<li>Servlet 程序默认是<strong>第一次访问</strong>的时在<strong>init</strong>()中创建</li>
</ul>
<h3 id="作用">作用</h3>
<ol>
<li>获取Servlet程序的<strong>别名</strong>，即获取标签<code>&lt;servlet-name&gt;</code>的值</li>
<li>获取<strong>初始化参数</strong>，即获取标签<code>&lt;init-param&gt;</code>的键值信息</li>
<li>获取 <strong>ServletContext</strong></li>
</ol>
<h3 id="API">API</h3>
<p>由服务器<strong>供应商</strong>提供实现，封装Servlet 程序的<strong>配置信息</strong>，并可获取ServletContext对象</p>
<p><strong>javax.servlet  Interface ServletConfig</strong></p>
<ul>
<li>
<p><strong>All Known Implementing Classes:</strong></p>
<p>GenericServlet, HttpServlet</p>
</li>
</ul>
<ul>
<li><strong>Method Summary</strong>
<ul>
<li>String <strong>getInitParameter</strong>(String name) ：获取初始化参数，即标签<code>&lt;init-param&gt;</code>内配置的键值对</li>
<li>Enumeration <strong>getInitParameterNames</strong>()  ：获取所有参数名组成的Enumeration对象</li>
<li>String <strong>getServletName</strong>() ：获取Servlet程序的<strong>别名</strong>，即获取标签<code>&lt;servlet-name&gt;</code>的值</li>
<li>ServletContext <strong>getServletContext</strong>()：获取ServletContext对象</li>
</ul>
</li>
</ul>
<hr>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Servlet别名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletConfitTestName<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.test.servlet.ServletConfigTest<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 配置初始化参数，可定义多个 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>usn<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>username<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>psw<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>password<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletConfitTestName<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/testConfig<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServletConfigTest</span> <span class="keyword">implements</span> <span class="title">Servlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        <span class="comment">//1、获取当前Servlet的别名，即标签&lt;servlet-name&gt;的值</span></span><br><span class="line">        String name = config.getServletName();</span><br><span class="line">        System.out.println(<span class="string">&quot;servlet-name: &quot;</span> + name);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2、获取初始化参数，即标签&lt;init-param&gt;内配置的键值对</span></span><br><span class="line">        String userName = config.getInitParameter(<span class="string">&quot;usn&quot;</span>);</span><br><span class="line">        String passWord = config.getInitParameter(<span class="string">&quot;psw&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;usn: &quot;</span> + userName);</span><br><span class="line">        System.out.println(<span class="string">&quot;psw: &quot;</span> + passWord);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//2.1、获取所有参数名组成的Enumeration 对象</span></span><br><span class="line">        Enumeration&lt;String&gt; names = config.getInitParameterNames();</span><br><span class="line">        <span class="keyword">while</span>(names.hasMoreElements())&#123;</span><br><span class="line">            System.out.println(names.nextElement());</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//3、获取servletContext</span></span><br><span class="line">        ServletContext servletContext = config.getServletContext();</span><br><span class="line">        System.out.println(servletContext);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">//@Override Method...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;打印结果如下</span><br><span class="line">servlet-name: ServletConfitTestName</span><br><span class="line">usn: username</span><br><span class="line">psw: password</span><br><span class="line">usn</span><br><span class="line">psw</span><br><span class="line">org.apache.catalina.core.ApplicationContextFacade@5a298b72</span><br></pre></td></tr></table></figure>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210329171533.png"
                       /
                >
<h3 id="ServletContext">ServletContext</h3>
<h4 id="基本概念-3">基本概念</h4>
<p>ServletContext称为“servlet上下文”，<strong>一个Web应用</strong>对应<strong>一个ServletContext</strong>，封装了Web诸多信息</p>
<ul>
<li>
<p>ServletContext对象由**servletConfig.getServletContext();**获取</p>
</li>
<li>
<p><strong>一个 web 工程</strong>，只有<strong>一个 ServletContext 对象</strong></p>
</li>
<li>
<p>ServletContext 是在 web 工程部署启动的时候创建。在 web 工程停止的时候销毁</p>
</li>
</ul>
<h4 id="作用-2">作用</h4>
<ol>
<li>获取当前WEB 应用的<strong>初始化参数</strong>，即<code>&lt;context-param&gt;</code>的值
<ul>
<li><code>&lt;context-param&gt;</code>可以被所有的Servlet 所获取, 而Servlet的初始化参数<code>&lt;init-param&gt;</code>只有对应的 Serlvet 可获取</li>
</ul>
</li>
<li>获取当前 WEB 应用的<strong>某一个文件</strong>在服务器上<strong>部署后</strong>的<strong>绝对路径</strong></li>
<li>获取当前WEB 应用的<strong>工程路径</strong></li>
<li>获取当前WEB应用的某一个文件对应的<strong>输入流</strong></li>
<li>作为<strong>application域</strong>范围的属性(后续补充说明)</li>
</ol>
<h4 id="API-2">API</h4>
<p><strong>javax.servlet Interface ServletContext</strong></p>
<ul>
<li>
<p><strong>Method Summary</strong></p>
<ul>
<li>String <strong>getInitParameter</strong>(String name) ：获取初始化参数，即标签<code>&lt;context-param&gt;</code>内配置的键值对</li>
<li>Enumeration <strong>getInitParameterNames</strong>()：获取所有参数名组成的Enumeration 对象</li>
<li>String <strong>getRealPath</strong>(String path)
<ul>
<li>获取当前 WEB 应用的<strong>某一个文件</strong>在服务器上<strong>部署后</strong>的<strong>绝对路径</strong></li>
<li>输入参数<code>/file.suffix</code>，<code>/</code>对应Web应用的<strong>根目录</strong>(部署后)</li>
<li>同时<strong>getRealPath</strong>(“/”)<strong>映射</strong>到IDE<strong>代码开发目录</strong>中的根目录(web或webcontent)</li>
</ul>
</li>
<li>String <strong>getContextPath</strong>() ：获取当前WEB 应用的<strong>工程路径</strong></li>
<li>InputStream <strong>getResourceAsStream</strong>(String path)
<ul>
<li>获取当前WEB应用的某一个文件对应的输入流</li>
<li>输入参数<code>/file.suffix</code>，<code>/</code>对应Web应用的<strong>根目录</strong>(IDEA-web)</li>
</ul>
</li>
</ul>
<hr>
<p>Attribute相关方法后续补充</p>
<ul>
<li>Object getAttribute(String name)</li>
<li>Enumeration getAttributeNames()</li>
<li>void removeAttribute(String name)</li>
<li>void setAttribute(String name, Object object)</li>
</ul>
</li>
<li>
<p>web.xml</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 配置当前Web应用的初始化参数   --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>driver<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>jdbcUrl<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>jdbc:mysql....<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletContextTest<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.test.servlet.ServletContextTest<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletContextTest<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/contextTest<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>ServletContextTest.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServletContextTest</span> <span class="keyword">implements</span> <span class="title">Servlet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        <span class="comment">//获取ServletContext对象</span></span><br><span class="line">        ServletContext servletContext = config.getServletContext();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1、获取当前Web应用的初始化参数，即&lt;context-param&gt;值</span></span><br><span class="line">        String driver = servletContext.getInitParameter(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">        String jdbcUrl = servletContext.getInitParameter(<span class="string">&quot;jdbcUrl&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;driver: &quot;</span> + driver);</span><br><span class="line">        System.out.println(<span class="string">&quot;jdbcUrl: &quot;</span> + jdbcUrl);</span><br><span class="line"></span><br><span class="line">        Enumeration&lt;String&gt; names = servletContext.getInitParameterNames();</span><br><span class="line">        <span class="keyword">while</span>(names.hasMoreElements())&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;names&quot;</span> + names.nextElement());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2、获取当前 WEB 应用的某一个文件在服务器上部署后的绝对路径</span></span><br><span class="line">        String realPath = servletContext.getRealPath(<span class="string">&quot;/test.txt&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;test.txt realPath&quot;</span> + realPath);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3、获取当前WEB 应用的工程路径</span></span><br><span class="line">        String contextPath = servletContext.getContextPath();</span><br><span class="line">        System.out.println(<span class="string">&quot;contextPath: &quot;</span> + contextPath);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4、获取当前WEB应用的某一个文件对应的输入流</span></span><br><span class="line">        InputStream resourceAsStream = servletContext.getResourceAsStream(<span class="string">&quot;/WEB-INF/jdbc.properties&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;resourceAsStream: &quot;</span> + resourceAsStream);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//@Override Method...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>工程目录与打印结果</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210330211852.png"
                      style="zoom:130%;" /
                >
<h2 id="ServletRequest">ServletRequest</h2>
<h3 id="基本概念-4">基本概念</h3>
<p>Servlet 的 service方法用于<strong>应答请求</strong>，每次请求都会调用 service() 方法。<strong>服务器</strong>并给予ServletRequest与ServletRsponse<strong>接口实现</strong>，将<strong>请求与响应的信息封装到这两个接口</strong>中，并在服务器调用 service 方法时传入<strong>实现类对象</strong>。</p>
<h3 id="作用-3">作用</h3>
<ul>
<li><strong>ServletRequest</strong>: 封装了<strong>请求</strong>信息，可以从中获取到任何的请求信息.</li>
</ul>
<h3 id="API-3">API</h3>
<p><strong>javax.servlet Interface ServletRequest</strong></p>
<ul>
<li>
<p><strong>All Known Subinterfaces:</strong></p>
<p>HttpServletRequest/Respone (tips：<strong>重要的子接口</strong>)</p>
</li>
<li>
<p><strong>Method Summary</strong>：方法众多，以下为当前常用的方法，有需要查询API</p>
<ol>
<li><strong>ServletRequest获取请求参数相关</strong>
<ul>
<li>String <strong>getParameter</strong>(String name)：根据html标签的name属性, 返回value. 若请求参数有多个值(例如 checkbox), 该方法只能获取到第一个提交的值</li>
<li>String[] <strong>getParameterValues</strong>(String name)：根据html标签的name属性, 返回对应的值的字符串数组</li>
<li>Enumeration <strong>getParameterNames</strong>()：返回所有请求<strong>参数名</strong>names对的Enumeration 对象</li>
<li>Map <strong>getParameterMap</strong>()：返回所有请求参数的键值对, String 数组类型</li>
<li><strong>Attribute</strong>相关的方法，暂时略，后续补充说明</li>
<li>…</li>
</ul>
</li>
</ol>
<hr>
<ol start="2">
<li>
<p><strong>HttpServletRequest</strong>：以下功能需使用功能更强大的<strong>HTTP相关</strong>的(扩展)子接口</p>
<ul>
<li>String <strong>getRequestURI</strong>()：获取<strong>请求的URI</strong>(URL除站点外的字符串)</li>
<li>String <strong>getMethod</strong>()：获取<strong>请求方式</strong></li>
<li>String <strong>getQueryString()</strong>：获取URL中的<strong>请求字符串</strong>(如GET请求?后部分)</li>
<li>String <strong>getServletPath</strong>()：获取servlet<strong>映射路径</strong>(web.xml配置的mapping路径)</li>
<li>…</li>
</ul>
</li>
</ol>
</li>
</ul>
<h4 id="示例代码">示例代码</h4>
<h5 id="前端页面">前端页面</h5>
<h6 id="前端页面展示">前端页面展示</h6>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210331164441.png"
                      style="zoom:150%;" /
                >
<h6 id="前端页面源码">前端页面源码</h6>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/06_helloweb/login&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">	用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    interesting:</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;interesting&quot;</span> <span class="attr">value</span>=<span class="string">&quot;java&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;checked&quot;</span>&gt;</span>java</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;interesting&quot;</span> <span class="attr">value</span>=<span class="string">&quot;C++&quot;</span>&gt;</span>C++</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;interesting&quot;</span> <span class="attr">value</span>=<span class="string">&quot;C&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;checked&quot;</span>&gt;</span>C</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;interesting&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysql&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;checked&quot;</span>&gt;</span>mysql</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;interesting&quot;</span> <span class="attr">value</span>=<span class="string">&quot;php&quot;</span>&gt;</span>php</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;interesting&quot;</span> <span class="attr">value</span>=<span class="string">&quot;go&quot;</span>&gt;</span>go</span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h6 id="参数传递格式">参数传递格式</h6>
<ul>
<li>
<p><strong>参数提交页情况</strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210805222405.png"
                      alt=""
                ></p>
</li>
<li>
<p><strong>GET请求</strong>：<code>user=admin&amp;password=123&amp;interesting=java&amp;interesting=C&amp;interesting=mysql</code></p>
</li>
<li>
<p><strong>POST请求</strong>：</p>
<ul>
<li><strong>HTTP原生</strong>：<u>键值对参数</u>传递是与<u>GET请求传递参数格式一致</u>，唯一区别是POST请求将其<u>放在请求体中</u>，GET请求是直接追加到URL后</li>
<li><strong>Chrome 解析的Form Data展示</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">user: admin</span><br><span class="line">password: 123</span><br><span class="line">interesting: java</span><br><span class="line">interesting: C</span><br><span class="line">interesting: mysql</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>可以发现某种含多个参数值的参数名，实际传递还是按照<strong>每一个键值对传递</strong>，<strong>只是键都一样</strong></p>
</blockquote>
<h5 id="web-xml">web.xml</h5>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.test.servlet.LoginServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/login<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="LoginServlet-java">LoginServlet.java</h5>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">implements</span> <span class="title">Servlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest request, ServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1、根据请求参数的name, 返回value. 若请求参数</span></span><br><span class="line">        <span class="comment">//有多个值(例如 checkbox), 该方法只能获取到第一个提交的值</span></span><br><span class="line">        String user = request.getParameter(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        String password = request.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        String interesting_one = request.getParameter(<span class="string">&quot;interesting&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;user = &quot;</span> + user);</span><br><span class="line">        System.out.println(<span class="string">&quot;password = &quot;</span> + password);</span><br><span class="line">        System.out.println(<span class="string">&quot;interesting_one = &quot;</span> + interesting_one);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2、据请求参数的name, 返回对应的值的字符串数组</span></span><br><span class="line">        String[] interesting = request.getParameterValues(<span class="string">&quot;interesting&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; interesting.length; i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;interest = &quot;</span> + (i + <span class="number">1</span>) + <span class="string">&quot; &quot;</span> + interesting[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3、返回所有请求参数名names对的Enumeration 对象</span></span><br><span class="line">        Enumeration&lt;String&gt; parameterNames = request.getParameterNames();</span><br><span class="line">        <span class="keyword">while</span> (parameterNames.hasMoreElements()) &#123;</span><br><span class="line">            String name = parameterNames.nextElement();</span><br><span class="line">            String value = request.getParameter(name);</span><br><span class="line">            System.out.println(<span class="string">&quot;name : value = &quot;</span> + name + <span class="string">&quot; : &quot;</span> + value);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4、返回所有请求参数的键值对, Map&lt;String,String&gt; 数组类型</span></span><br><span class="line">        Map&lt;String, String[]&gt; parameterMap = request.getParameterMap();</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, String[]&gt; param : parameterMap.entrySet()) &#123;</span><br><span class="line">           System.out.println(<span class="string">&quot;name : value = &quot;</span></span><br><span class="line">                   + param.getKey() + <span class="string">&quot; : &quot;</span> + Arrays.asList(param.getValue()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="comment">// @Override...Method</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>打印结果如下</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">user = test</span><br><span class="line">password = 123456</span><br><span class="line">interesting_one = java</span><br><span class="line">interest = 1 java</span><br><span class="line">interest = 2 C</span><br><span class="line">interest = 3 mysql</span><br><span class="line">name : value = user : test</span><br><span class="line">name : value = password : 123456</span><br><span class="line">name : value = interesting : java</span><br><span class="line">name : value = user : [test]</span><br><span class="line">name : value = password : [123456]</span><br><span class="line">name : value = interesting : [java, C, mysql]</span><br></pre></td></tr></table></figure>
<h2 id="ServletResponse">ServletResponse</h2>
<h3 id="作用-4">作用</h3>
<p><strong>ServletResponse</strong>: 封装了<strong>响应</strong>信息, 如果想给用户什么响应, 具体可以使用该接口的方法实现.</p>
<h3 id="API-4">API</h3>
<p><strong>javax.servlet Interface ServletResponse</strong></p>
<ul>
<li>
<p><strong>All Known Subinterfaces:</strong></p>
<p>HttpServletResponse (tips：<strong>重要的子接口</strong>)</p>
</li>
<li>
<p><strong>Method Summary</strong></p>
<p><strong>ServletResponse</strong>：</p>
<ul>
<li>PrintWriter <strong>getWriter</strong>()
<ul>
<li>返回 PrintWriter 对象. 调用该对象的 print() 方法, 将把 print() 中的参数<strong>直接打印</strong>到客户的<strong>浏览器上</strong>.</li>
<li>PrintWriter 对象还可配合setContentType响应类型，把内容输入到响应类型文件内</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>PrintWriter</strong>常用的方法于属性<br>
* <strong>out属性</strong>：out属性是Writer类型的，servlet实现io的底层类，write方法基于调用out方法实现</p>
<ul>
<li>
<p><strong>write</strong>()：<strong>底层方法</strong>、调用PrintWriter的out属性的方法，将字符串(HTTP文本传送)数据写入输出缓冲区中，发送个浏览器。</p>
<ul>
<li><strong>print</strong>()：有多种传入类型重载的方法，把各种类型转换为字符串后调用write()实现。</li>
</ul>
</li>
<li>
<p><strong>flush</strong>()：将jsp中的JspWriter对象的缓冲区追加到response的缓冲区后，并执行相应操作，发回数据给客户端(response.getWriter()的PrintWriter的Writer缓冲区)</p>
</li>
<li>
<p>void <strong>setContentType</strong>(String type)：</p>
<ul>
<li>
<p>设置响应的内容类型，如pdf类型&quot;application/pdf&quot;，具体其他文件类型type值可打开<code>[tomcat安装路径]]\conf\web.xml</code>文件进行查询，例如</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mime-mapping</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">extension</span>&gt;</span>pdf<span class="tag">&lt;/<span class="name">extension</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mime-type</span>&gt;</span>application/pdf<span class="tag">&lt;/<span class="name">mime-type</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mime-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">    </span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>…</p>
<hr>
<p><strong>HttpServletResponse</strong>：</p>
<p>③. void sendRedirect(String location)：请求的重定向，后续补充</p>
</li>
</ul>
<h2 id="GenericServlet">GenericServlet</h2>
<h3 id="需求驱动">需求驱动</h3>
<ul>
<li>
<p>在 web.xml 文件中设置两个 WEB 应用的初始化参数, user, password.</p>
</li>
<li>
<p>定义一个 login.html, 里边定义两个请求字段: user, password. 发送请求到 loginServlet</p>
</li>
<li>
<p>获取请求方式</p>
</li>
<li>
<p>在创建一个 LoginServlet, 在其中获取请求的 user, password. 比对其和 web.xml 文件中定义的请求参数是否一致</p>
</li>
<li>
<p>若一致，作出基本提示</p>
</li>
<li>
<p>LoginServlet.java文件</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 基于实现Servlet接口进行Servlet程序开发</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">implements</span> <span class="title">Servlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//在类内部声明一个ServletConfig属性，</span></span><br><span class="line">    <span class="comment">//用于暂存从init方法中获取的servletConfig对象</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig servletConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.servletConfig = servletConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ServletConfig servletConfig;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1、获取应用初始化参数username、password</span></span><br><span class="line">        ServletContext servletContext = servletConfig.getServletContext();</span><br><span class="line">        String user = servletContext.getInitParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        String psw = servletContext.getInitParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2、获取login.html请求参数</span></span><br><span class="line">        String username = servletRequest.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        String password = servletRequest.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line">        PrintWriter writer = servletResponse.getWriter();</span><br><span class="line">        String mes;</span><br><span class="line">        <span class="comment">//3、将请求中的参数与web应用初始化参数信息进行比较</span></span><br><span class="line">        <span class="keyword">if</span>(user.equals(username) &amp;&amp; psw.equals(password))&#123;</span><br><span class="line">            mes = <span class="string">&quot;App: login succeed&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            mes = <span class="string">&quot;App: login failed&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        writer.print(mes);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>web.xml文件</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>username<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>12345<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>password<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>55555<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.test.java.LoginServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/login<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="解决思路">解决思路</h3>
<p>由于WEB应用的初始化参数必须通过ServletContext对象获取，而该对象又需要ServletConfig对象获取。ServletConfig则需在init方法才能得到实体引用。因此关键实现步骤如下：</p>
<ol>
<li><strong>暂存</strong>从<strong>init方法</strong>中获取的<strong>ServletConfig引用</strong>
<ol>
<li>定义一个private <strong>ServletConfig servletConfig</strong> 属性，用于存储servletConfig的引用</li>
<li>从init方法中对servletConfig引用赋值</li>
</ol>
</li>
<li>通过servletConfig获取ServletContext进而获取WEB应用的初始化参数</li>
</ol>
<h3 id="问题分析">问题分析</h3>
<ul>
<li><strong>存在的问题</strong>：
<ol>
<li>在完成上述简单功能时候为了实现Servlet接口，出现众多无需使用的空方法</li>
<li>想使用ServletConfig 或ServletContext每次都需创建一个属性从init方法中暂存引用</li>
</ol>
</li>
<li><strong>解决方案</strong>：
<ol>
<li>自定义一个Servlet<strong>实现类</strong>、尝试实现里面的方法。</li>
<li>在后续开发Servlet程序时<strong>通过继承</strong>的这个实现类的方式开发，以<strong>简化开发</strong></li>
</ol>
</li>
<li><strong>MyGenericServlet.java</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 在后续开发Servlet程序时通过继承的这个实现类的方式开发，以简化开发</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">MyGenericServlet</span> <span class="keyword">implements</span> <span class="title">Servlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1、声明一个ServletConfig变量用于暂存init方法中获取到的引用</span></span><br><span class="line">    <span class="keyword">private</span> ServletConfig servletConfig;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig servletConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.servletConfig = servletConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2、尝试实现方法：可以实现，即返回ServletConfig引用</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.servletConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 3、由于service方法是开发servlet必须使用与实现的方法</span></span><br><span class="line"><span class="comment">     * 可以将其定义未抽象方法，即强制继承的子类必须实现这个方法</span></span><br><span class="line"><span class="comment">     * 由于该方法定义成abstract，因此MyGenericServlet需改成抽象类</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4、尝试实现方法：无法实现</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>通过继承MyGenericServlet.java实现优化后的LoginServlet开发
<ul>
<li>无需强制实现Servlet其他不需要的方法</li>
<li>可通过getServletConfig()，在任意位置获取到ServletConfig()对象</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 基于自实现的GenericServlet——MyGenericServlet进行Servlet开发 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet2</span> <span class="keyword">extends</span> <span class="title">MyGenericServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1、获取应用初始化参数username、password</span></span><br><span class="line">        ServletContext servletContext = getServletConfig().getServletContext();</span><br><span class="line">        String user = servletContext.getInitParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        String psw = servletContext.getInitParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2、获取login.html请求参数</span></span><br><span class="line">        String username = servletRequest.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        String password = servletRequest.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line">        PrintWriter writer = servletResponse.getWriter();</span><br><span class="line">        String mes;</span><br><span class="line">        <span class="comment">//3、将请求中的参数与web应用初始化参数信息进行比较</span></span><br><span class="line">        <span class="keyword">if</span>(user.equals(username) &amp;&amp; psw.equals(password))&#123;</span><br><span class="line">            mes = <span class="string">&quot;App2: login succeed&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            mes = <span class="string">&quot;App2: login failed&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        writer.print(mes);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="GenericServlet-2">GenericServlet</h3>
<p>GenericServlet是实现Servlet的一个抽像类，上述自实现的<strong>MyGenericServlet要解决的问题与思路和GenericServlet一致</strong>。不过官方的GenericServlet除了实现Servlet接口，<strong>还实现了ServletConfig接口</strong>，意义使继承GenericServlet的Servlet能够直接调用ServletConfig的所有方法(ServletConfig是对标一个Servlet的)，进而更一步提高了GenericServlet的功能。提高了开发Servlet的效率。GenericServlet一些其他细节如下所示：</p>
<ul>
<li>
<p>源码中ServletConfig<strong>接口方法的实现</strong>，是使用从<strong>init</strong>方法中获取的ServletConfig对象直接调用对应方法来<strong>间接实现的</strong>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericServlet</span> </span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">Servlet</span>, <span class="title">ServletConfig</span>, <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="comment">//.....</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getInitParameter</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.getServletConfig().getInitParameter(name);<span class="comment">//间接实现</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Enumeration&lt;String&gt; <span class="title">getInitParameterNames</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.getServletConfig().getInitParameterNames();<span class="comment">//间接实现</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//.....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>GenericServlet在实现的Servlet接口中原生的init(ServletConfig servletConfig)方法的同时调用了一个自定义的**空参init()**方法。作用如下说明：</p>
<ul>
<li>**空参init()**方法用于给继承GenericServlet开发的子类想通过init方法进行一些初始化操作</li>
<li>由于GenericServlet关键在于声明了一个ServletConfig类型成员变量，在原生带参的init(ServletConfig)方法中进行了初始化。</li>
<li>若子类直接重写GenericServlet的带参init(ServletConfig)方法进行初始化操作。则会导GenericServlet对ServletConfig初始化失败，系统默认调用了子类重写的init方法。因此当子类在调用GenericServlet封装好且涉及ServletConfig参与实现的方法时，就会<strong>出现空指针异常</strong>。</li>
</ul>
<hr>
<ul>
<li><strong>小结</strong>：
<ol>
<li>若子类想使用初始化init方法，<strong>建议重写空参的init()方法</strong>，不建议重写init(ServletConfig)</li>
<li>若子类有必要重写init(ServletConfig)，则必须在init方法中<code>super.init(ServletConfig)</code>显式调用一下父类的带参init方法，使父类的ServletConfig能顺利被初始化</li>
<li>因此，严格来说，GenericServlet定义的<strong>空参init()方法并非Servlet的生命周期方法</strong>，init(ServletConfig)才是。</li>
</ol>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericServlet</span> </span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">Servlet</span>, <span class="title">ServletConfig</span>, <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="comment">//.....</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.config = config;</span><br><span class="line">            <span class="keyword">this</span>.init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//.....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="HTTP请求处理">HTTP请求处理</h2>
<h3 id="HTTP请求">HTTP请求</h3>
<h4 id="GET">GET</h4>
<h5 id="请求格式">请求格式</h5>
<ol>
<li>
<p><strong>请求行</strong></p>
<ol>
<li>请求的方式 GET</li>
<li>请求的资源路径[+?+请求参数]</li>
<li>请求的协议的版本号 HTTP/1.1</li>
</ol>
</li>
<li>
<p><strong>请求头</strong>：key : value 组成多个不同的键值对，表示不同的含义。</p>
</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210407084038.png"
                      alt=""
                ></p>
<h5 id="传递参数格式">传递参数格式</h5>
<ol>
<li>
<p><strong>键值对格式</strong>：<code>http://www.xxx.com/index.jsp?name=lc&amp;password=123</code></p>
<ul>
<li>? 隔开URL与参数列表，用与表示请求参数的开始位置</li>
<li>每个参数有键值对 name=value组成</li>
<li>多个简直对之间用 &amp; 相隔</li>
</ul>
<hr>
<ul>
<li><strong>特点</strong>：参数在URL的<strong>位置任意</strong>，因为后端通过键值对解析。参数占用URL长度较多。</li>
</ul>
</li>
<li>
<p><strong>参数序列格式</strong>：<code>http://www.xxx.com/api/name/password</code></p>
<ul>
<li>没有明显的请求参数开始标记</li>
<li>参数值直接写入URL中，并通过<code>/</code>隔开</li>
</ul>
<hr>
<ul>
<li><strong>特点</strong>：请求参数<strong>必须按序放入</strong>，由于没有键值对的关联关系，因此位置信息是决定参数类型的唯一参考，每个位置对应指定的参数类型。优势是占用URL长度较少。</li>
</ul>
</li>
</ol>
<h5 id="GET请求类型操作">GET请求类型操作</h5>
<ul>
<li>form 标签method=get</li>
<li>超链接 a标签或img标签</li>
<li>在浏览器地址栏中输入地址后敲回车</li>
</ul>
<h5 id="特点">特点</h5>
<h4 id="POST">POST</h4>
<h5 id="请求格式-2">请求格式</h5>
<ol>
<li>
<p>请求行</p>
<ol>
<li>请求的方式 POST</li>
<li>请求的资源路径[+?+请求参数]</li>
<li>请求的协议的版本号 HTTP/1.1</li>
</ol>
</li>
<li>
<p>请求头：key : value组成多个不同的请求头，有不同的含义</p>
</li>
<li>
<p><strong>空行</strong></p>
</li>
<li>
<p><strong>请求体</strong> ：发送给服务器的数据</p>
</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210407084640.png"
                      alt=""
                ></p>
<h5 id="POST请求类型操作">POST请求类型操作</h5>
<ul>
<li>form 标签 method=post</li>
</ul>
<h3 id="HTTP响应">HTTP响应</h3>
<h4 id="响应格式">响应格式</h4>
<ol>
<li>
<p><strong>响应行</strong></p>
<ol>
<li>响应的协议和版本号</li>
<li>响应状态码</li>
<li>响应状态描述符</li>
</ol>
</li>
<li>
<p><strong>响应头</strong>： key : value 不同的响应头，有其不同含义</p>
</li>
<li>
<p><strong>空行</strong></p>
</li>
<li>
<p><strong>响应体</strong>：回传给客户端的数据</p>
</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210407085354.png"
                      alt=""
                ></p>
<h4 id="常用的响应码">常用的响应码</h4>
<ul>
<li>200 表示请求成功</li>
<li>302 表示请求重定向</li>
<li>404 表示请求服务器已经收到了，但是你要的数据不存在（请求地址错误）</li>
<li>500 表示服务器已经收到请求，但是服务器内部错误（代码错误）</li>
</ul>
<h3 id="MIME类型说明">MIME类型说明</h3>
<ul>
<li>MIME 的英文全称是&quot;Multipurpose Internet Mail Extensions&quot; 多功能 Internet 邮件扩充服务。</li>
<li>MIME 是 <strong>HTTP 协议</strong>中<strong>数据类型</strong>，用于表示某一种<strong>文件的扩展名</strong>。</li>
<li>MIME 类型的<strong>格式</strong>是“<strong>大类型/小类型</strong>”</li>
</ul>
<p>具体可通过网络查询</p>
<h2 id="HttpServlet">HttpServlet</h2>
<h3 id="HttpServletRequest-Response初谈">HttpServletRequest/Response初谈</h3>
<h4 id="需求驱动-2">需求驱动</h4>
<ul>
<li>在通过Servlet去处理HTTP请求时，若想获取<strong>请求的方式</strong>，进而区分处理两种不同类型的请求(GET/POST)时，服务器给予的<strong>ServletRequest/Response实现类是不能满足需求的</strong>。</li>
<li>由于ServletReqeust与ServletResponse是基于<strong>请求—响应这个服务机制</strong>层面上的封装，严格来说没有指明使用的通信协议。而GET/POST请求时HTTP协议所特有的，因此在使用HTTP协议所涉及的相关功能时，需要使用——<strong>HttpServletRequest/Response</strong>接口</li>
</ul>
<h4 id="简介">简介</h4>
<p>HttpServletRequest/Response分别是ServletRequest/Response接口<strong>基于HTTP协议的子接口</strong>，在ServletRequest/Response原有功能的基础上，规范定义许多HTTP协议特用的方法。与ServletRequest/Response类似，具体的<strong>实现类由HTTP服务器提供</strong></p>
<h4 id="获取HttpServletRequest-Response">获取HttpServletRequest/Response</h4>
<p>由于HttpServletRequest/Response是ServletRequest/Response的<strong>子接口</strong>。而在开发基于HTTP协议的应用时，HTTP服务器实现的肯定是HttpServletRequest/Response。而通过上层协议规范ServletRequest/Response传入</p>
<ul>
<li>因此可以在获取ServletRequest/Response实体后通过<strong>向下转型(强制转换)<strong>得到HttpServletRequest/Response。具体操作在</strong>service</strong>(ServletRequest,ServletResponse)方法中实现</li>
<li>得到HttpServletRequest/Response实现类后，可调用request.getMethod();获取HTTP请求方式</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">implements</span> <span class="title">Servlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//通过向下转型(强制类型转换)获得其实现类</span></span><br><span class="line">        HttpServletRequest request = (HttpServletRequest) servletRequest;</span><br><span class="line">        HttpServletResponse response = (HttpServletResponse) servletResponse;</span><br><span class="line">        String requestMethod = request.getMethod();</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//@Override...method，略</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="需求驱动-3">需求驱动</h3>
<p>即使通过继承GenericServlet开发Servlet已经方便了许多，但是当处理HTTP请求时还是需要将ServletRequest/Response手动强制转换为HttpServletRequest/Response才能更好的处理HTTP请求。而每次开发Servlet处理HTTP请求都需要书写强制类型转换语句，显然还有优化的空间。</p>
<ul>
<li>因此，可以在<strong>GenericServlet基础上</strong>针对<strong>HTTP协议再进行优化</strong>，创建一个**专门用于处理HTTP请求Servlet接口实现类。**具备的基本功能如下：
<ol>
<li>如封装好将ServletRequest/Response转换为HttpServletRequest/Response的步骤。</li>
<li>实现GET请求、POST请求的分发处理</li>
<li>…</li>
</ol>
</li>
<li>MyHttpServlet.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自定义一个基于GenericServlet，HTTP协议的Servlet接口实现类，基本功能如下：</span></span><br><span class="line"><span class="comment"> *  1、封装好将ServletRequest/Response转换为HttpServletRequest/Response</span></span><br><span class="line"><span class="comment"> *  2、实现GET请求、POST请求的分发</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyHttpServlet</span> <span class="keyword">extends</span> <span class="title">GenericServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1、封装好将ServletRequest/Response转换为HttpServletRequest/Response</span></span><br><span class="line">        <span class="comment">//1.1、通过instanceof检查实现类的实际类型</span></span><br><span class="line">        <span class="keyword">if</span>(servletRequest <span class="keyword">instanceof</span> HttpServletRequest)&#123;</span><br><span class="line">            HttpServletRequest request = (HttpServletRequest)servletRequest;</span><br><span class="line">            <span class="keyword">if</span>(servletResponse <span class="keyword">instanceof</span> HttpServletResponse)&#123;</span><br><span class="line">                HttpServletResponse response = (HttpServletResponse) servletResponse;</span><br><span class="line">                <span class="comment">//1.2、创建一个重载service(HttpServletRequest,HttpServletResponse)</span></span><br><span class="line">                <span class="comment">//传入转换后的HttpServletRequest/Response 实体引用。</span></span><br><span class="line">                <span class="comment">//子类通过重写service(HttpServletRequest,HttpServletResponse)方法</span></span><br><span class="line">                <span class="comment">//进而实现直接使用HttpServletRequest/Response</span></span><br><span class="line">                service(request,response);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.2、创建一个重载service(HttpServletRequest,HttpServletResponse)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//2、实现GET请求、POST请求的分发处理</span></span><br><span class="line">        <span class="comment">//2.1、通过HttpServletRequest获取当前HTTP请求类型，并进行判断</span></span><br><span class="line">        String requestMethod = request.getMethod();</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;GET&quot;</span>.equals(requestMethod))&#123;</span><br><span class="line">            doGet(request,response);<span class="comment">//2.2、模仿service方法，创建专门处理GET请求的方法doGet</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;POST&quot;</span>.equals(requestMethod))&#123;</span><br><span class="line">            doPost(request,response);<span class="comment">//2.2、模仿service方法，创建专门处理POST请求的方法doPost</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//开发的时候，可以针对HTTP协议对不同的请求重写对应的doGet或doPost实现更方便的处理</span></span><br><span class="line">    <span class="comment">//2.2、模仿service方法，创建专门处理GET请求的方法doGet</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.2、模仿service方法，创建专门处理POST请求的方法doPost</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>基于MyHttpServlet的servlet开发，更加有针对性，简洁，有效</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 基于自实现的HttpServlet——MyHttpServlet进行Servlet开发</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yhd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2021-04-06 8:10</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet4</span> <span class="keyword">extends</span> <span class="title">MyHttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1、获取应用初始化参数username、password</span></span><br><span class="line">        String user = getServletContext().getInitParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        String psw = getServletContext().getInitParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2、获取login.html请求参数</span></span><br><span class="line">        String username = request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        String password = request.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line">        PrintWriter writer = response.getWriter();</span><br><span class="line">        String mes;</span><br><span class="line">        <span class="comment">//3、将请求中的参数与web应用初始化参数信息进行比较</span></span><br><span class="line">        <span class="keyword">if</span>(user.equals(username) &amp;&amp; psw.equals(password))&#123;</span><br><span class="line">            mes = <span class="string">&quot;App4: login succeed&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            mes = <span class="string">&quot;App4: login failed&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        writer.print(mes);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="HttpServlet-2">HttpServlet</h3>
<p>HttpServlet继承与GenericServlet，上述自实现的<strong>MyHttpServlet要解决的问题思路以及功能与HttpServlet类似</strong>。在<strong>真正的Servlet开发</strong>中，是通过<strong>继承HttpServlet</strong>方式进行开发，根据请求方式重写doXxx()方法即可。</p>
<ul>
<li>(了解)其中如果我们对一个请求没有进行任何doXxx()方法的重写，其实源码内部已经对该请求进行了一定程度的受理</li>
</ul>
<h2 id="HttpServletRequest">HttpServletRequest</h2>
<p>tips：概念介绍请转至标题HttpServlet下的HttpServletRequest/Response初谈</p>
<h3 id="API-5">API</h3>
<ul>
<li><strong>getRequestURI</strong>() ：获取请求的<strong>资源路径</strong></li>
<li><strong>getRequestURL</strong>() ：获取请求的统一资源定位符（绝对路径）</li>
<li><strong>getRemoteHost</strong>() ：获取客户端的 ip 地址</li>
<li><strong>getHeader</strong>() ：获取请求头（User-Agent的值）</li>
<li><strong>getMethod</strong>()： 获取请求的方式 GET 或 POST</li>
</ul>
<hr>
<ul>
<li>– ServletRequest – 来自父接口的方法</li>
<li><strong>getParameter</strong>()： 获取请求的参数</li>
<li><strong>getParameterValues</strong>()： 获取请求的参数（多个值的时候使用）</li>
</ul>
<hr>
<ul>
<li><strong>setAttribute</strong>(key, value)：设置域数据</li>
<li><strong>getAttribute</strong>(key)：获取域数据</li>
<li><strong>getRequestDispatcher</strong>()： 获取请求转发对象</li>
<li>…</li>
</ul>
<h3 id="请求中文乱码">请求中文乱码</h3>
<h4 id="GET请求">GET请求</h4>
<p>后端获取带中文的请求参数时，打印显示???，由于<strong>HTTP协议</strong>传输<strong>URL默认编码为iso-8859-1</strong>(兼容ASCII)</p>
<ul>
<li><strong>方案1</strong>：先正确解码，再对应编码</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取请求参数</span></span><br><span class="line">String username = req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line"><span class="comment">//先以iso8859-1 解码，再以utf-8进行编码</span></span><br><span class="line">username = <span class="keyword">new</span> String(username.getBytes(<span class="string">&quot;iso-8859-1&quot;</span>), <span class="string">&quot;UTF-8&quot;</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>方案2</strong>：修改tomcat收到请求时<strong>url参数的编码方式</strong></p>
<ul>
<li>打开tomcat安装目录中的<code>conf\server.xml</code>，修改成如下内容</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">connectionTimeout</span>=<span class="string">&quot;20000&quot;</span> <span class="attr">port</span>=<span class="string">&quot;8080&quot;</span> <span class="attr">protocol</span>=<span class="string">&quot;HTTP/1.1&quot;</span> <span class="attr">redirectPort</span>=<span class="string">&quot;8443&quot;</span> <span class="attr">URIEncoding</span>=<span class="string">&quot;UTF-8&quot;</span> <span class="attr">useBodyEncodingForURI</span>=<span class="string">&quot;true&quot;</span>/&gt;</span> </span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="POST请求">POST请求</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//一定要在获取请求参数前设置，一旦获取了请求参数后设置无效</span></span><br><span class="line">request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br></pre></td></tr></table></figure>
<h2 id="HttpServletResponse">HttpServletResponse</h2>
<h3 id="API-6">API</h3>
<p>ServletResponse接口定义</p>
<ul>
<li>PrintWriter <strong>getWriter</strong>()：<strong>字符流</strong>，常用于回传字符串（常用）
<ul>
<li>返回 PrintWriter 对象. 调用该对象的 print() 方法, 将把 print() 中的参数<strong>直接打印</strong>到客户的<strong>浏览器上</strong>.</li>
<li>PrintWriter 对象还可配合setContentType响应类型，把内容输入到响应类型文件内</li>
</ul>
</li>
<li>OutputStream <strong>getOutputStream</strong>()：<strong>字节流</strong>，常用于下载（传递二进制数据）</li>
</ul>
<p>注意：两个流同时只能获取一个，否则就会报错。</p>
<h3 id="响应中文乱码">响应中文乱码</h3>
<p>当通过字符流PrintWriter <strong>getWriter</strong>()向浏览器直接传送中文字符时，常见显示???乱码情况。</p>
<h4 id="乱码的原因">乱码的原因</h4>
<ul>
<li>乱码问题终归就是：发送方的编码字符集与接收方的编码<strong>字符集不兼容导致</strong></li>
</ul>
<ol>
<li>
<p>可通过调用<code>response.getCharacterEncoding();</code>获取当前服务器的默认编码集(ISO-8859-1)</p>
</li>
<li>
<p>一般浏览器默认是GBK编码，因此服务器与浏览器字符集不匹配因此。这是造成乱码的首要原因</p>
<ul>
<li>因此最直接的解决方案(<strong>不推荐</strong>！)：<code>response.setCharacterEncoding(&quot;GBK&quot;);</code></li>
</ul>
<blockquote>
<ul>
<li>
<p>GBK编码：一个汉字占用两个字节，此编码为中国专用的汉字编码而形成之解决方案。</p>
</li>
<li>
<p>UTF-8编码：一个汉字占用3个字节。是全世界统一的编码结构。外国网站看的话不会乱码。</p>
<ul>
<li>Unicode是「字符集」：为每一个「字符」分配一个唯一的 ID(学名为码位 / 码点 / Code Point）</li>
<li>UTF-8 是「编码规则」：将「码位」转换为字节序列的规则（编码/解码 可以理解为 加密/解密 的过程）</li>
</ul>
</li>
</ul>
</blockquote>
<blockquote>
<p><strong>小结</strong>：因此在选择中文编码集时，由于国际化问题，<strong>优先选用UTF-8</strong>。</p>
</blockquote>
</li>
<li>
<p>若为了国际化将服务器编码设置为<code>response.setCharacterEncoding(&quot;UTF-8&quot;);</code>又会因为浏览器默认GBK编码而又导致了乱码。此时可以通过将浏览器的编码设置为UTF-8来解决问题，但<strong>不推荐</strong>，由于不可能让用户每次访问该网页时都手动设置一下编码。而且有些浏览器设置困难</p>
</li>
</ol>
<h4 id="推荐解决方案">推荐解决方案</h4>
<ul>
<li>
<p><strong>方案1</strong>：设置响应头，告诉浏览器接收到数据时，采用UTF-8解析网页内容</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setHeader(<span class="string">&quot;Content-Type&quot;</span>,<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>方案2</strong>(推荐)：设置内容类型，同时设置了服务器和客户端都使用UTF-8字符集，还设置了响应头。<strong>注意</strong>：此方法一定要在<strong>获取流对象之前调用才有效</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//注意获取流对象前设置才有效，一旦获取了流对象设置无效</span></span><br><span class="line">resp.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Servlet体系结构">Servlet体系结构</h2>
<ul>
<li>
<p>由于Servlet，或者是Web开发，是一种被动式的开发。</p>
</li>
<li>
<p>服务器操作的占比远远高于编程人员</p>
</li>
<li>
<p>其实是在Web容器，服务器实现与一套机制管理下，通过开放给编程人员使用的部分接口(主要的service)而实现Web开发编程的</p>
</li>
<li>
<p>由于服务器操作的占比远远高于编程人员，因此Servlet体系中，大部分是接口的定义(给服务器处理)。</p>
</li>
</ul>
<h3 id="优化Servlet开发层面">优化Servlet开发层面</h3>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/ServletAPI.jpg"
                      style="zoom:130%;" /
                >
<h3 id="请求处理层面">请求处理层面</h3>
<ul>
<li>ServletRequest/Response 都是接口</li>
<li>定义成接口的原因就是这些类都是由服务器实现的</li>
<li>ServletRequest/Response服务器实现后通过传入参数给用户调用，这种接口层次是在通信协议之上的(HTTP之上)</li>
<li>HttpServletRequest/Response是基于ServletRequest/Response的<strong>子接口</strong>，是针对HTTP协议定义的规范。对应由服务器实现后，即是ServletRequest/Response的子类。</li>
</ul>
<h3 id="完整结构体系">完整结构体系</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/ServletAPIDiagram.png"
                      alt=""
                ></p>
<h1 id="Web路径">Web路径</h1>
<h2 id="绝对与相对路径">绝对与相对路径</h2>
<ul>
<li>
<p>相对路径：</p>
<table>
<thead>
<tr>
<th style="text-align:center">符号</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">.</td>
<td style="text-align:center">表示当前目录</td>
</tr>
<tr>
<td style="text-align:center">…</td>
<td style="text-align:center">表示上一级目录</td>
</tr>
<tr>
<td style="text-align:center">资源名</td>
<td style="text-align:center">表示当前目录/资源名</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>绝对路径：<code>http://ip:port/工程路径/资源路径</code></p>
</li>
</ul>
<h2 id="‘-’-斜杠的不同含义">‘/’ 斜杠的不同含义</h2>
<p>在 web 中 / 斜杠是一种绝对路径</p>
<ol>
<li>
<p>/ 若被<strong>浏览器解析</strong>（前端代码）：只定位到<strong>端口号</strong>，如 <code>http://ip:port/</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/&quot;</span>&gt;</span>斜杠<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>/ 若被<strong>服务器解析</strong>（Servlet、web.xml、JSP）：定位到<strong>工程名</strong>，如 <code>http://ip:port/工程路径</code>对应WEB资源根目录(IDEA - web，eclipse - WebContent)</p>
<ul>
<li>特殊情况，<strong>重定向</strong>：<code>response.sendRediect(“/”);</code> 把斜杠发送给<strong>浏览器解析</strong> <code>http://ip:port</code></li>
</ul>
</li>
</ol>
<h1 id="JSP">JSP</h1>
<h2 id="需求驱动-4">需求驱动</h2>
<p>前端想通过发送一个请求返回整个<strong>java处理过</strong>的<strong>HTML页面</strong>(动态页面)，而非PrintWriter返回的几个字符串，则传统的方式只能通过PrintWriter逐一打印出整个html代码，如下所示。</p>
<ul>
<li><strong>ReturnHtml.java</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yhd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2021-04-07 21:33</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReturnHtml</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        StringBuilder result = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        Date date = <span class="keyword">new</span> Date();<span class="comment">//获取当前时间</span></span><br><span class="line">        result.append(<span class="string">&quot;&lt;form&gt;&quot;</span>);</span><br><span class="line">        result.append(<span class="string">&quot;当前时间：&lt;input type=\&quot;text\&quot; name=\&quot;username\&quot; value=\&quot; &quot;</span> + date + <span class="string">&quot; \&quot;&gt;&lt;br/&gt;&quot;</span>);</span><br><span class="line">        result.append(<span class="string">&quot;&lt;/form&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        resp.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">        PrintWriter writer = resp.getWriter();</span><br><span class="line">        writer.print(result.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>index.html</strong></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/08_JSP/getHTML&quot;</span> &gt;</span>获取HTML页面<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>最终效果</strong></li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/%E8%BF%94%E5%9B%9Ehtml%E9%A1%B5%E9%9D%A2.jpg"
                      alt=""
                ></p>
<ul>
<li>小结：只能通过这种方式返回经过java处理过的页面，编写和<strong>维护</strong>都将非常困难，实在效率太低了</li>
</ul>
<h2 id="JSP基本概念">JSP基本概念</h2>
<ul>
<li>为弥补 Servlet 的缺陷，SUN公司<strong>在Servlet的基础上</strong>推出了<strong>JSP</strong>（Java Server Pages）技术作为解决方案。</li>
<li>JSP是简化Servlet编写的一种技术，它将<strong>Java代码和HTML语句混合</strong>在同一个文件中编写，只对网页中的要<strong>动态产生的内容采用Java代码</strong>来编写，而对<strong>固定不变的静态内容</strong>采用普通<strong>静态HTML页面</strong>的方式编写。</li>
<li>JSP文件<strong>就像普通的HTML文件一样</strong>，可以放置在WEB应用程序中的<strong>除了WEB-INF及其子目录外</strong>的其他任何目录中，JSP页面的<strong>访问路径与普通HTML</strong>页面的访问路径<strong>形式也完全一样</strong>。</li>
</ul>
<h2 id="HelloWorld">HelloWorld</h2>
<ol>
<li>在IDEA 或 eclipse中右键新建一个JSP文件</li>
<li>在<code>&lt;body&gt;</code>标签内写入<code>&lt;% %&gt;</code></li>
<li>在<code>&lt;% %&gt;</code>内可以编写Java代码</li>
</ol>
<ul>
<li>
<p>index.jsp</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;$Title$&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">      我是JSP页面</span><br><span class="line">      &lt;%</span><br><span class="line">        System.out.println(<span class="string">&quot;JSP：在前端页面编写后台打印语句！&quot;</span>);</span><br><span class="line">      %&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>最终效果</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/jsp%E6%B5%8B%E8%AF%95.jpg"
                      alt=""
                ></p>
</li>
</ul>
<h2 id="JSP运行原理">JSP运行原理</h2>
<h3 id="运行原理">运行原理</h3>
<ol>
<li>WEB容器（Servlet引擎）收到以.jsp为扩展名的URL的访问请求时，会把该访问请求交给<strong>JSP引擎</strong>去处理。</li>
<li>每个JSP页面在<strong>第一次被访问时</strong>，JSP引擎将它翻译成一个Servlet源程序(.java文件)，</li>
<li>接着再把这个Servlet源程序<strong>编译</strong>成Servlet的<code>.class类</code>文件</li>
<li>然后再由WEB容器（Servlet引擎）像调用普通Servlet程序一样的方式来装载和解释执行这个由JSP页面翻译成的Servlet程序。</li>
</ol>
<h3 id="JSP的Servlet源程序">JSP的Servlet源程序</h3>
<h4 id="源程序路径">源程序路径</h4>
<ul>
<li>IDEA存放位置：<code>C:\Users\[用户名]\AppData\Local\JetBrains\IntelliJIdea2020.3\tomcat\[XXXX-XX-标识符-XXXX-XXXX]\work\Catalina\localhost\[项目名称]\org\apache\jsp</code>目录下</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210408095342.png"
                      alt=""
                ></p>
<h3 id="JSP本质">JSP本质</h3>
<ul>
<li>
<p>观察JSP源程序：可以发现index_jsp这个类<strong>继承了HttpJspBase</strong></p>
</li>
<li>
<p>通过观察HttpJspBase源码发现<strong>HttpJspBase继承HttpServlet</strong></p>
</li>
<li>
<p>结论：因此可知JSP源程序是间接继承了HttpServlet的，即<strong>JSP本质上就是Servlet</strong></p>
<ul>
<li><strong>index_jsp.java</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.apache.jsp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.jsp.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">index_jsp</span> <span class="keyword">extends</span> <span class="title">org</span>.<span class="title">apache</span>.<span class="title">jasper</span>.<span class="title">runtime</span>.<span class="title">HttpJspBase</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">org</span>.<span class="title">apache</span>.<span class="title">jasper</span>.<span class="title">runtime</span>.<span class="title">JspSourceDependent</span>,</span></span><br><span class="line"><span class="class">                 <span class="title">org</span>.<span class="title">apache</span>.<span class="title">jasper</span>.<span class="title">runtime</span>.<span class="title">JspSourceImports</span> </span>&#123;</span><br><span class="line">  <span class="comment">//....省略部分代码....</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//类似Servlet的Init方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">_jspInit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//类似Servlet的destroy方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">_jspDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line">                     </span><br><span class="line">  <span class="comment">//类似Servlet的service方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">_jspService</span><span class="params">(<span class="keyword">final</span> javax.servlet.http.HttpServletRequest request, <span class="keyword">final</span> javax.servlet.http.HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">      <span class="keyword">throws</span> java.io.IOException, javax.servlet.ServletException </span>&#123;</span><br><span class="line">	<span class="comment">//.....</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//类似Servlet相关的一些类，ServletContext、ServletCondig等...</span></span><br><span class="line">    <span class="comment">//这些其实就是后面所说的JSP隐函对象</span></span><br><span class="line">    <span class="keyword">final</span> javax.servlet.jsp.PageContext pageContext;</span><br><span class="line">    javax.servlet.http.HttpSession session = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">final</span> javax.servlet.ServletContext application;</span><br><span class="line">    <span class="keyword">final</span> javax.servlet.ServletConfig config;</span><br><span class="line">    javax.servlet.jsp.JspWriter out = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">final</span> java.lang.Object page = <span class="keyword">this</span>;</span><br><span class="line">    javax.servlet.jsp.JspWriter _jspx_out = <span class="keyword">null</span>;</span><br><span class="line">    javax.servlet.jsp.PageContext _jspx_page_context = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      response.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">      pageContext = _jspxFactory.getPageContext(<span class="keyword">this</span>, request, response,</span><br><span class="line">      			<span class="keyword">null</span>, <span class="keyword">true</span>, <span class="number">8192</span>, <span class="keyword">true</span>);</span><br><span class="line">      _jspx_page_context = pageContext;</span><br><span class="line">      application = pageContext.getServletContext();</span><br><span class="line">      config = pageContext.getServletConfig();</span><br><span class="line">      session = pageContext.getSession();</span><br><span class="line">      out = pageContext.getOut();</span><br><span class="line">      _jspx_out = out;</span><br><span class="line">      </span><br><span class="line">      out.write(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;&lt;html&gt;\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;  &lt;head&gt;\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;    &lt;title&gt;$Title$&lt;/title&gt;\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;  &lt;/head&gt;\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;  &lt;body&gt;\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;      我是JSP页面\n&quot;</span>);<span class="comment">//自编写的HTML元素</span></span><br><span class="line">      out.write(<span class="string">&quot;      &quot;</span>);</span><br><span class="line">	  <span class="comment">//自编写的java代码</span></span><br><span class="line">        System.out.println(<span class="string">&quot;JSP：在前端页面编写后台打印语句！&quot;</span>);</span><br><span class="line">      </span><br><span class="line">      out.write(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;  &lt;/body&gt;\n&quot;</span>);</span><br><span class="line">      out.write(<span class="string">&quot;&lt;/html&gt;\n&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (java.lang.Throwable t) &#123;</span><br><span class="line">      <span class="comment">//....省略部分代码....</span></span><br><span class="line">  	&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>HttpJspBase：继承了HttpServlet，里面的init、service等Servlet生命周期方法都对应调用了jsp源程序的相关Servlet生命周期代码</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpJspBase</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> <span class="keyword">implements</span> <span class="title">HttpJspPage</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">HttpJspBase</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.init(config);</span><br><span class="line">        jspInit();</span><br><span class="line">        _jspInit();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Localizer.getMessage(<span class="string">&quot;jsp.engine.info&quot;</span>, Constants.SPEC_VERSION);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        jspDestroy();</span><br><span class="line">        _jspDestroy();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Entry point into service.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        _jspService(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">jspInit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">_jspInit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">jspDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">_jspDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">_jspService</span><span class="params">(HttpServletRequest request,</span></span></span><br><span class="line"><span class="function"><span class="params">                                     HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="9大隐含对象">9大隐含对象</h2>
<ul>
<li>
<p>从JSP运行原理中看到JSP对应的Servlet源程序时可发现，自编写的java代码在<code>void _jspService()</code>方法内，而该方法的首部，<strong>还定义了许多对象</strong>。这些便是<strong>JSP的隐函对象</strong>，可供我们<strong>在JSP编写java代码</strong>时不用声明(已经帮我们声明)直接使用使用。</p>
</li>
<li>
<p>JSP的<strong>9个隐函对象</strong>：request、response、pageContext、session、application、config、out、page、exception</p>
</li>
</ul>
<hr>
<ol>
<li>
<p><strong>request</strong>：HttpServletRequest对象.</p>
</li>
<li>
<p><strong>response</strong>(了解)：HttpServletResponse 对象(在 JSP 页面中几乎不会调用 response 的任何方法.)</p>
</li>
<li>
<p><strong>pageContext</strong>:</p>
<ul>
<li>页表示面的上下文，PageContext的一个对象封装了当前页面的一切信息(学习自定义标签时使用它)</li>
<li>可以从该对象中获取到其他 8 个隐含对象. 也可以从中获取到当前</li>
</ul>
</li>
<li>
<p><strong>session</strong>：代表浏览器和服务器的一次会话, 是 HttpSession 的一个对象. 后面详细学习</p>
</li>
<li>
<p><strong>application</strong>: 代表当前 <strong>WEB 应用</strong>，是<strong>ServletContext</strong>对象.</p>
</li>
<li>
<p><strong>config</strong>(了解)：当前 JSP 对应的 Servlet 的 <strong>ServletConfig</strong> 对象(几乎不使用). 若需要访问当前 JSP页面。配置的初始化参数, 需要配置jsp页面的映射的地址才可以。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>hellojsp<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">jsp-file</span>&gt;</span>/hello.jsp<span class="tag">&lt;/<span class="name">jsp-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>test<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>testValue<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>hellojsp<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hellojsp<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span>  	</span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>out</strong>：JspWriter对象，结构功能与response.getWrite()的PrintWriter对象类似。调用 out.println() 可以直接把字符串打印到浏览器上</p>
</li>
<li>
<p><strong>page</strong>(几乎不使用))：指向当前 JSP 对应的Servlet 对象的引用, 但为 Object 类型, 只能调用 Object 类的方法</p>
</li>
<li>
<p><strong>exception</strong>：在声明了 page 指令的<code> &lt;%@ page isErrorPage=&quot;true&quot; %&gt;</code> 时, 才可以使用。</p>
</li>
</ol>
<h2 id="JSP基本语法">JSP基本语法</h2>
<h3 id="模板元素">模板元素</h3>
<p><strong>静态HTML内容</strong>称之为JSP模版元素，在静态的<strong>HTML内容之中可以嵌套JSP</strong>的其他各种元素来产生动态内容和执行业务逻辑。</p>
<h3 id="注释">注释</h3>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- html注释：会被翻译导java源代码中，通过out.writer方式输出 --&gt;</span><br><span class="line"><span class="comment">// 或 /* java注释，也会被翻译导java源代码中 */</span></span><br><span class="line">&lt;%-- JSP注释,真正的注释，不会被翻译 --%&gt;</span><br><span class="line">&lt;%-- 凡是涉及后端解析的代码，如JSP、EL、JSTL注释都必须是用JSP注释，否则会被解析 --%&gt;</span><br></pre></td></tr></table></figure>
<h3 id="JSP脚本">JSP脚本</h3>
<h4 id="JSP小脚本">JSP小脚本</h4>
<p>语法格式：<code>&lt;%  %&gt;</code></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 打印当前时间 --&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	Date date = <span class="keyword">new</span> Date();</span><br><span class="line">%&gt;</span><br><span class="line">&lt;% System.out.println(date); %&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>每次访问</strong>含小脚本的页面，小脚本都会被<strong>重头执行</strong>。</p>
</li>
<li>
<p>只能编写<strong>方法内语句</strong>。</p>
</li>
<li>
<p><strong>原理</strong>：由于<strong>JSP小脚本</strong>内编写的代码时直接<strong>移植到</strong>jsp对应Servlet<strong>源程序</strong>的<code>_jspService()</code><strong>方法内</strong>，因此像声明一个java方法的这些语句是不能够写在JSP小脚本内的(java中方法内不能定义方法)。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">index_jsp</span> <span class="keyword">extends</span> <span class="title">org</span>.<span class="title">apache</span>.<span class="title">jasper</span>.<span class="title">runtime</span>.<span class="title">HttpJspBase</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">org</span>.<span class="title">apache</span>.<span class="title">jasper</span>.<span class="title">runtime</span>.<span class="title">JspSourceDependent</span>,</span></span><br><span class="line"><span class="class">                 <span class="title">org</span>.<span class="title">apache</span>.<span class="title">jasper</span>.<span class="title">runtime</span>.<span class="title">JspSourceImports</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">_jspService</span><span class="params">(<span class="keyword">final</span> javax.servlet.http.HttpServletRequest request</span></span></span><br><span class="line"><span class="function"><span class="params">                            , <span class="keyword">final</span> javax.servlet.http.HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">      <span class="keyword">throws</span> java.io.IOException, javax.servlet.ServletException </span>&#123;</span><br><span class="line">      <span class="comment">//&lt;% %&gt;JSP小脚本代码移植的位置</span></span><br><span class="line">    &#125;      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="JSP声明">JSP声明</h4>
<p>语法格式：<code>&lt;%! %&gt;</code></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 声明一个名为date的Date类型变量 --&gt;</span><br><span class="line">&lt;%! Date date = <span class="keyword">null</span>; %&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>只能</strong>编写<strong>声明，定义</strong>类型的java语句。不能直接编写java代码</p>
</li>
<li>
<p>使用<code>&lt;%! %&gt;</code>声明变量仅在页面第一次加载时由容器<strong>只初始化一次</strong>，后续<strong>再访问页面不再执行</strong>。</p>
</li>
<li>
<p>若使用<code>&lt;%  %&gt;</code>小脚本声明变量，由于小脚本每次访问页面时都被执行。因此<strong>每次都是重新声明变量。</strong></p>
</li>
<li>
<p><strong>原理</strong>：JSP声明的内容是<strong>移植到</strong>jsp对应Servlet<strong>源程序</strong>的<strong>类中</strong>，是属于<strong>类的成员的一部分</strong>。因此只能编写书写属性、方法声明语句。</p>
</li>
<li>
<p>tips：几乎不怎么使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">index_jsp</span> <span class="keyword">extends</span> <span class="title">org</span>.<span class="title">apache</span>.<span class="title">jasper</span>.<span class="title">runtime</span>.<span class="title">HttpJspBase</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">org</span>.<span class="title">apache</span>.<span class="title">jasper</span>.<span class="title">runtime</span>.<span class="title">JspSourceDependent</span>,</span></span><br><span class="line"><span class="class">                 <span class="title">org</span>.<span class="title">apache</span>.<span class="title">jasper</span>.<span class="title">runtime</span>.<span class="title">JspSourceImports</span> </span>&#123;</span><br><span class="line">    <span class="comment">//&lt;%! %&gt;JSP声明代码移植的位置(类成员)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">_jspService</span><span class="params">(<span class="comment">/*...省略...*/</span>)</span></span>&#123;</span><br><span class="line">      <span class="comment">//&lt;% %&gt;JSP小脚本代码移植的位置(方法内)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="JSP表达式">JSP表达式</h3>
<p>语法格式：<code>&lt;%= %&gt;</code></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 输出当前时间 --&gt;</span><br><span class="line">&lt;%= <span class="keyword">new</span> Date() %&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>可直接输出<strong>任何对象</strong>(null)或任何<strong>基本数据类型</strong>、<strong>表达式</strong>、<strong>方法调用返回值</strong>等</li>
<li>JSP表达式的百分号%和等号=之间<strong>不能有空格</strong></li>
<li>JSP表达式内的语句<strong>不用写分号</strong>，原理(out.print(翻译语句**;**));，若加了分号则导致 ));语句多出，语法错误</li>
<li><strong>原理</strong>：与jsp小脚本一样，翻译在<code>_jspService()</code><strong>方法内</strong>，通过调用PrintWrite，print方法打印，因此还可以获取request，response对象</li>
</ul>
<h3 id="JSP与HTML互嵌">JSP与HTML互嵌</h3>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">if</span>(i &gt; <span class="number">10</span>)&#123;</span><br><span class="line">%&gt;</span><br><span class="line">    &lt;a href=&quot;/08_JSP/index.jsp&quot;&gt;大于10&lt;/a&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">%&gt;</span><br><span class="line">	&lt;a href=&quot;/08_JSP/index.jsp&quot;&gt;小于10&lt;/a&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<h3 id="JSP指令">JSP指令</h3>
<p>用于向容器提供关于<strong>JSP页面的总体信息</strong>，并<strong>不产生任何输出</strong>，语法格式为<code>&lt;%@ 指令 属性名 = &quot;值&quot; %&gt;</code>。一般写在JSP首部。指令有三种类型：</p>
<ul>
<li><strong>page</strong></li>
<li><strong>include</strong></li>
<li><strong>taglib</strong></li>
</ul>
<h4 id="page指令"><strong>page</strong>指令</h4>
<ul>
<li>描述JSP页面的总体特性，如输出内容类型、字符集编码等信息</li>
<li>配置多个属性可以用空格隔开，或使用多条指令语句单独设置</li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--返回的内容类型及返回内容的编码、翻译后语言、及JSP页面本身编码的字符集--&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> </span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>
<hr>
<p>其他属性：常用为<strong>加粗表示</strong></p>
<ul>
<li>
<p>language：表示jsp翻译后是什么语言，暂时只支持java</p>
</li>
<li>
<p>extends=“package.class”：表明当前JSP被翻译成<strong>源程序</strong>(.java)时<strong>继承哪个类</strong></p>
</li>
<li>
<p><strong>import</strong>=“package.class”：与java一样导包，导类</p>
</li>
<li>
<p><strong>session</strong>=“true | false”：设置当前页面是否启用session，使用session前必须设置为true</p>
</li>
<li>
<p><strong>errorPage</strong>=“错误页面路径”：jsp本身代码出错时，自动转发到这个页面。</p>
<ul>
<li>
<p>还可以通过在web.xml中配置<code>&lt;error-page&gt;</code>信息来实现</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 通过http错误代码配置错误页面 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">error-page</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">error-code</span>&gt;</span>404<span class="tag">&lt;/<span class="name">error-code</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">location</span>&gt;</span>/WEB-INF/error.jsp<span class="tag">&lt;/<span class="name">location</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">error-page</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 通过设定的异常类跳转错误页面 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">error-page</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exception-type</span>&gt;</span>java.lang.ArithmeticException<span class="tag">&lt;/<span class="name">exception-type</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">location</span>&gt;</span>/WEB-INF/error.jsp<span class="tag">&lt;/<span class="name">location</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">error-page</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p><strong>isErrorPage</strong>=“true | false” ：</p>
<ul>
<li>默认为false，true时可使用exception隐函对象，打印出错信息。</li>
<li>只有出错时exception才不会null，因此不建议直接访问含该对象时候的网页。</li>
<li>因此推荐把调用exception对象的错误页面放入WEB-INF中，通过外部请求的转发访问。</li>
</ul>
</li>
<li>
<p><strong>contentType</strong>=“mimeType [ ;charset=characterSet ]” | “text/html ;charset=ISO-8859-1” ]</p>
<ul>
<li>指定当前JSP的<strong>响应类型</strong>，实际调用response.setContentType();</li>
<li>同理也可以再配置中设置响应类型的字符编码charset</li>
</ul>
</li>
<li>
<p><strong>pageEncoding</strong>=“characterSet| ISO-8859-1”] ：指定当前JSP页面编码的字符编码，一般与上述的字符编码设置一致</p>
</li>
<li>
<p><strong>isELIgnored</strong>=“true | false”：指定当前JSP页面<strong>是否可以使用EL表达式</strong>，通常取值为true</p>
</li>
<li>
<p><strong>autoFlush</strong>：设置当out输出缓冲区满了之后，是否自动刷新缓冲区。默认true</p>
</li>
<li>
<p><strong>buffer</strong>：设置out缓冲区的大小，默认8kb</p>
</li>
</ul>
<h4 id="include指令">include指令</h4>
<ul>
<li>
<p>include指令实现把另一个文件(HTML、JSP等)的内容<strong>静态包含</strong>到当前页面中。</p>
</li>
<li>
<p><strong>静态包含</strong></p>
<ul>
<li>静态包含其实是吧被包含得jsp页面的代码拷贝到包含的位置执行输出(out.write())</li>
<li>静态包含不会翻译被包含的jsp页面，即只有一个jsp源文件</li>
</ul>
</li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ include file = <span class="string">&quot;copyright.html&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>
<h3 id="JSP动作">JSP动作</h3>
<p>JSP动作JSP页面发给容器的<strong>命令</strong>，它指示容器在页面<strong>执行期间</strong>(动态)，完成的某种任务。</p>
<ul>
<li>
<p><strong>基本语法</strong>：<code>&lt;前缀: 动作名称 属性列表键值对 /&gt;</code>，如<code>&lt;jsp:include page=&quot;copyright.html&quot;/&gt;</code></p>
</li>
<li>
<p><strong>动作类型</strong>：JSP标准动作、标准标签库(JSTL)、用户自定义动作</p>
</li>
<li>
<p><strong>常用动作</strong>：</p>
<ul>
<li>
<p><strong>jsp:include</strong>：在当前页面中<strong>动态包</strong>含另一个页面</p>
<ul>
<li>非源码级搬运包含，而是通过内置调用一个方法包含</li>
</ul>
<p><code>JspRuntimeLibrary.include(request, response, &quot;/include/footer.jsp&quot;, out, false</code></p>
</li>
<li>
<p>生成多个servlet源文件，即包含与被包含数目。</p>
</li>
<li>
<p>多数使用静态包含</p>
</li>
<li>
<p><strong>jsp:forward page</strong> = “”：请求转发到指定页面</p>
<ul>
<li>可以使用 jsp:param 子标签传入一些参数，响应端可通过getParameter()</li>
</ul>
</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> &lt;jsp:forward page=<span class="string">&quot;/include/b.jsp&quot;</span>&gt;</span><br><span class="line">&lt;jsp:param value=<span class="string">&quot;abcd&quot;</span> name=<span class="string">&quot;username&quot;</span>/&gt;</span><br><span class="line"> &lt;/jsp:forward&gt;	</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>jsp:useBean</strong>：查找或创建一个javaBean对象</p>
<ul>
<li>
<p>jsp:setProperty：设置JavaBeans对象的属性值</p>
</li>
<li>
<p>jsp:getProperty：返回JavaBeans对象的属性值</p>
</li>
<li>
<p>jsp:plugin：在JSP页面中嵌入一个插件</p>
</li>
</ul>
</li>
</ul>
<h2 id="4大域对象">4大域对象</h2>
<h3 id="通用方法">通用方法</h3>
<p>pageContext，request，session，application对象都含以下方法</p>
<ul>
<li>void <strong>setAttribute</strong>(String name, Object object)：设置数据内容，键值对key : value</li>
<li>Object <strong>getAttribute</strong>(String name)：通过key获取value</li>
<li>Enumeration <strong>getAttributeNames</strong>() ：获取所有key组成的Enumeration对象</li>
<li>void <strong>removeAttribute</strong>(String name) ：删除指定key的数据</li>
</ul>
<h3 id="属性作用范围">属性作用范围</h3>
<p>范围从小到大：pageContext —&gt; request —&gt; session —&gt; application</p>
<ul>
<li><strong>pageContext</strong>：仅限于<strong>当前 JSP 页面</strong>，因此Servlet或者其他页面都获取不到。</li>
<li><strong>request</strong>：仅限于<strong>同一个请求</strong>.</li>
<li><strong>session</strong>：限于<strong>同一次会话</strong>，浏览器打开直到关闭称之为一次会话(前提在此期间会话不失效)</li>
<li><strong>application</strong>：限于<strong>当前WEB 应用</strong>，是范围最大的属性作用范围。只要在一处设置属性, 在其他各处的 JSP 或 Servlet 中都可以获取到。</li>
</ul>
<hr>
<p>tips：由于这些域对象存储数据都是占用资源的，因此在业务使用中，尽量能小作用域完成的工作交给小作用域，使其资源得到最快得释放。</p>
<h2 id="转发与重定向">转发与重定向</h2>
<h3 id="请求转发">请求转发</h3>
<h4 id="基本概念-5">基本概念</h4>
<p>请求转发：服务器收到请求后，从<strong>一次资源跳转到另一个资源</strong>(Servlet)的操作叫请求转发。</p>
<ol>
<li>浏览器地址栏<strong>没有变化</strong>，为初次发出请求的地址。</li>
<li>只有<strong>一次请求</strong>，request始终是<strong>同一个对象</strong>，因此共享Request域中的数据</li>
<li>可以转发到WEB-INF目录下</li>
<li>只能转发给当前 WEB 应用的的资源、不可以访问工程以外的资源</li>
<li>转发地址全程由服务器操作，/ 代表的是当前 <strong>WEB 应用</strong>的根目录<code>http://ip:port/web应用</code></li>
</ol>
<h4 id="实现步骤">实现步骤</h4>
<ol>
<li>调用HttpServletReques对象<strong>getRequestDispatcher</strong>()方法并填入转发路径</li>
<li>通过第1步获取到RequestDispatcher对象</li>
<li>通过调用RequestDispatcher的<strong>forward</strong>()方法进行请求的转发</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ForwardServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span></span><br><span class="line"><span class="function">		<span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		<span class="comment">//请求的转发.</span></span><br><span class="line">		<span class="comment">//1. 调用 HttpServletRequest的getRequestDispatcher()方法,需要传入要转发的地址</span></span><br><span class="line">        <span class="comment">//获取RequestDispatcher对象</span></span><br><span class="line">		RequestDispatcher requestDispatcher = request.getRequestDispatcher(<span class="string">&quot;/testServlet&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//2、调用 HttpServletRequest 的 forward(request, response) 进行请求的转发. </span></span><br><span class="line">		requestDispatcher.forward(request, response); </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="请求的重定向">请求的重定向</h3>
<h4 id="基本概念-6">基本概念</h4>
<p>请求重定向：指客户端给服务器发请求后，服务器告知客户端，去请求另一个地址。</p>
<ol>
<li>浏览器地址栏会<strong>发生变化</strong>、初次发出的请求地址，地址栏为最后响应的那个地址</li>
<li><strong>两次请求</strong>，request<strong>不是同一个对象</strong>，不能共享request域中的数据</li>
<li>不能访间WEB-INF下的资源</li>
<li>可以访问工程外的资源(可以重定向到任何资源，百度，淘宝等)</li>
<li>地址将被服务器发往浏览器进行解析，因此 / 代表 / 代表的是当前 <strong>WEB 站点</strong>的根目录. <code>http://ip:port/</code></li>
</ol>
<h4 id="实现步骤-2">实现步骤</h4>
<h5 id="方式1">方式1</h5>
<p>通过设置响应头</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置响应状态码 302 ，表示重定向，（已搬迁）</span></span><br><span class="line">resp.setStatus(<span class="number">302</span>);</span><br><span class="line"><span class="comment">// 设置响应头，说明 新的地址在哪里</span></span><br><span class="line">resp.setHeader(<span class="string">&quot;Location&quot;</span>, <span class="string">&quot;http://localhost:8080&quot;</span>);</span><br></pre></td></tr></table></figure>
<h5 id="方式2">方式2</h5>
<p>直接调用HttpServletResponse的sendRedirect()方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.sendRedirect(<span class="string">&quot;http://localhost:8080&quot;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="out-getWriter">out&amp;getWriter()</h2>
<h3 id="场景复现">场景复现</h3>
<ul>
<li>jsp测试代码：</li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    out.write(<span class="string">&quot;out输出1&lt;br/&gt;&quot;</span>);</span><br><span class="line">    out.write(<span class="string">&quot;out输出2&lt;br/&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    response.getWriter().write(<span class="string">&quot;response输出1&lt;br/&gt;&quot;</span>);</span><br><span class="line">    response.getWriter().write(<span class="string">&quot;response输出2&lt;br/&gt;&quot;</span>);</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>输出结果反而是逆过来，先输出response，再输出out</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210604083740.png"
                      alt=""
                ></p>
<h3 id="原理分析">原理分析</h3>
<ul>
<li>
<p>jsp中的out对象是<strong>JspWriter</strong>类型，response.getWrite()对象是<strong>PrintWriter</strong>类型，两者功能与结构非常相似</p>
</li>
<li>
<p>当JSP页面中所有代码执行完后会做一下两个动作</p>
<ol>
<li>系统自动执行jsp的JspWriter对象的out.flush()操作，此时会把out缓冲区中得数据<strong>追加</strong>写入到response缓冲区<strong>后</strong></li>
<li>系统自动执行response的PrintWriter对象的out.flush刷新操作，此时的flush操作是将全部数据响应给客户端。</li>
</ol>
</li>
</ul>
<hr>
<ul>
<li>步骤1：各自写入自己的缓冲区</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210412083948.png"
                      alt=""
                ></p>
<ul>
<li>步骤2：代码执行完后，系统先调用jsp的flush()追加数据到response中，后调用response的flush()操作响应到页面上。</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210604090851.png"
                      alt=""
                ></p>
<h3 id="测试">测试</h3>
<ul>
<li>手动执行jsp的out.flush操作，控制jsp的out缓冲区追加到response缓冲区的时机</li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    out.write(<span class="string">&quot;out输出1&lt;br/&gt;&quot;</span>);</span><br><span class="line">    out.flush();</span><br><span class="line">    out.write(<span class="string">&quot;out输出2&lt;br/&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    response.getWriter().write(<span class="string">&quot;response输出1&lt;br/&gt;&quot;</span>);</span><br><span class="line">    response.getWriter().write(<span class="string">&quot;response输出2&lt;br/&gt;&quot;</span>);</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>输出效果：</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210604091500.png"
                      alt=""
                ></p>
<h3 id="结论">结论</h3>
<ul>
<li>由于 jsp 翻译之后，底层源代码都是使用jsp的JspWriter对象out来进行输出，所以一般情况下。我们在 <strong>jsp 页面中统一使用 jsp的out 来进行输出</strong>，而不建议使用response的out对象输出。避免打乱页面输出内容的顺序。</li>
</ul>
<h3 id="write-print">write &amp; print</h3>
<p>由于JspWriter和response.getWrite()的PrintWriter功能与结构是相似的，write()方法与print()方法的原理和使用也一致。</p>
<ul>
<li>out.write() 输出<strong>字符串</strong>没有问题</li>
<li>out.print() ，有多个重载方法，因此输出<strong>任意数据都</strong>没有问题（都转换成为字符串后调用的 write 输出）</li>
</ul>
<h1 id="EL表达式">EL表达式</h1>
<h2 id="基础概念">基础概念</h2>
<ul>
<li>EL 表达式的全称是：Expression Language，是<strong>表达式语言</strong>。</li>
<li>EL 表达式的作用：主要是<strong>代替jsp表达式脚本</strong> ,<strong>负责</strong>jsp页面的<strong>数据输出</strong>。由于EL 表达式在输出数据时比jsp脚本更为简洁、强大、友好。</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">&lt;% request.setAttribute(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;值&quot;</span>); %&gt;</span><br><span class="line">表达式脚本输出key的值是：</span><br><span class="line">	&lt;%=request.getAttribute(<span class="string">&quot;key1&quot;</span>)==<span class="keyword">null</span>?<span class="string">&quot;&quot;</span>:request.getAttribute(<span class="string">&quot;key1&quot;</span>)%&gt;&lt;br/&gt;</span><br><span class="line">EL 表达式输出 key 的值是：$&#123;key1&#125;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>EL表达式格式</strong>：<code>$&#123;表达式&#125;</code></li>
<li>EL表达式<strong>直接编写在JSP页面中</strong>，无需写在<code>&lt;% %&gt;</code>内</li>
<li>EL表达式在<strong>输出null值</strong>时，会自定<strong>转换为空串输出</strong>。</li>
<li>EL表达式所有语句输出都需要<strong>JavaBean</strong>的读方法支持(getter()、isXxxx())。</li>
<li>tips：<code>&lt;%-- 凡是涉及后端解析的代码，如JSP、EL、JSTL注释都必须是用JSP注释，否则会被解析 --%&gt;</code></li>
</ul>
<h2 id="域数据的搜索顺序">域数据的搜索顺序</h2>
<h3 id="输出语法">输出语法</h3>
<p>由于EL表达式主要用于在 jsp 页面中输出数据。 且主要是输出<strong>域对象中的数据</strong>。</p>
<ul>
<li><strong>格式</strong>：<code>&lt;% request.setAttribute(&quot;key&quot;,&quot;值&quot;); %&gt;  </code>等价于 <code>$&#123;key&#125;</code></li>
</ul>
<h3 id="域数据的搜索顺序-2">域数据的搜索顺序</h3>
<p>当四个域中都有<strong>相同的key 的数据</strong>的时，EL 表达式会按照四个域的<strong>从小到大的顺序</strong>去进行搜索，优先匹配则输出。</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line"><span class="comment">//往四个域中都保存了相同的 key 的数据。</span></span><br><span class="line">    request.setAttribute(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;request&quot;</span>);</span><br><span class="line">    session.setAttribute(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;session&quot;</span>);</span><br><span class="line">    application.setAttribute(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;application&quot;</span>);</span><br><span class="line">    pageContext.setAttribute(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;pageContext&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">$&#123;key&#125; &lt;%-- 输出：pageContext --&gt;</span><br></pre></td></tr></table></figure>
<h2 id="java类属性输出">java类属性输出</h2>
<p>输出Java类中普通属性，数组属性。list 集合属性和 map 集合属性。</p>
<ul>
<li><strong>JSP部分</strong></li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    Person person = <span class="keyword">new</span> Person();</span><br><span class="line">    person.setName(<span class="string">&quot;Denny！&quot;</span>);</span><br><span class="line">    person.setPhones(<span class="keyword">new</span> String[]&#123;<span class="string">&quot;18610541354&quot;</span>,<span class="string">&quot;18688886666&quot;</span>,<span class="string">&quot;18699998888&quot;</span>&#125;);</span><br><span class="line">    List&lt;String&gt; cities = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">    cities.add(<span class="string">&quot;北京&quot;</span>);</span><br><span class="line">    cities.add(<span class="string">&quot;上海&quot;</span>);</span><br><span class="line">    cities.add(<span class="string">&quot;深圳&quot;</span>);</span><br><span class="line">    person.setCities(cities);</span><br><span class="line">    Map&lt;String,Object&gt;map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;key1&quot;</span>,<span class="string">&quot;value1&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;key2&quot;</span>,<span class="string">&quot;value2&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;key3&quot;</span>,<span class="string">&quot;value3&quot;</span>);</span><br><span class="line">    person.setMap(map);pageContext.setAttribute(<span class="string">&quot;p&quot;</span>, person);</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>EL表达式部分</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">输出 Person：$&#123; p &#125;&lt;br&#x2F;&gt;</span><br><span class="line">输出 Person 的 name 属性：$&#123;p.name&#125; &lt;br&gt;</span><br><span class="line">输出 Person 的 pnones 数组属性值：$&#123;p.phones[2]&#125; &lt;br&gt;</span><br><span class="line">输出 Person 的 List 集合：$&#123;p.cities&#125; &lt;br&gt;</span><br><span class="line">输出 Person 的 List 集合中个别元素值：$&#123;p.cities[2]&#125; &lt;br&gt;</span><br><span class="line">输出 Person 的 Map 集合: $&#123;p.map&#125; &lt;br&gt;</span><br><span class="line">输出 Person 的 Map 集合中某个 key 的值: $&#123;p.map.key3&#125; &lt;br&gt;</span><br></pre></td></tr></table></figure>
<h2 id="运算符">运算符</h2>
<h3 id="关系运算符">关系运算符</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210412165520.png"
                      alt=""
                ></p>
<h3 id="逻辑运算符">逻辑运算符</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210412165608.png"
                      alt=""
                ></p>
<h3 id="算术运算符">算术运算符</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210412165825.png"
                      alt=""
                ></p>
<h3 id="empty运算">empty运算</h3>
<p>empty 运算可以判断一个数据是否为空，若为<strong>空输出 true</strong></p>
<p><code>$&#123;empty requestScope.book&#125; //假设空串，则返回false</code></p>
<ul>
<li><strong>输出 false几种情况</strong>
<ul>
<li>值为<strong>null</strong>值</li>
<li>值为<strong>空串</strong></li>
<li>值是 Object 类型数组，<strong>长度为零</strong></li>
<li>list、map集合，<strong>元素个数为零</strong></li>
</ul>
</li>
</ul>
<h3 id="三元运算符">三元运算符</h3>
<p><code>$&#123;empty requestScope.book ? &quot;add&quot; : &quot;update&quot;&#125;</code></p>
<h3 id="与-中括号运算">&quot;.&quot;与[]中括号运算</h3>
<ul>
<li>
<p>.点运算，可以输出 Bean 对象中某个<strong>属性的值</strong>。</p>
</li>
<li>
<p>[]中括号运算</p>
<ul>
<li>
<p>可以输出<strong>有序集合</strong>中<strong>某个元素的值</strong>。</p>
</li>
<li>
<p>并且[]中括号运算，还可以输出 map 集合中 key 里含有<strong>特殊字符的 key 的值</strong></p>
<ol>
<li>将key值用单引号’’ 包含</li>
<li>将含特殊字符的key值整个用 [ ] 中括号包含</li>
</ol>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;a.a.a&quot;</span>, <span class="string">&quot;aaaValue&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;b+b+b&quot;</span>, <span class="string">&quot;bbbValue&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;c-c-c&quot;</span>, <span class="string">&quot;cccValue&quot;</span>);</span><br><span class="line">    request.setAttribute(<span class="string">&quot;map&quot;</span>, map);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%-- $&#123; map.a.a.a&#125; &lt;br&gt; 输出失败--&gt;</span><br><span class="line">$&#123; map[<span class="string">&#x27;a.a.a&#x27;</span>] &#125; &lt;br&gt;</span><br><span class="line">$&#123; map[<span class="string">&quot;b+b+b&quot;</span>] &#125; &lt;br&gt;</span><br><span class="line">$&#123; map[<span class="string">&#x27;c-c-c&#x27;</span>] &#125; &lt;br&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="11个隐函对象">11个隐函对象</h2>
<h3 id="隐函对象列表">隐函对象列表</h3>
<table>
<thead>
<tr>
<th style="text-align:left">隐函对象</th>
<th>返回类型</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>pageContext</strong></td>
<td>PageContextImpl</td>
<td>可获取 jsp 中的九大内置对象</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left"><strong>pageScope</strong></td>
<td>Map&lt;Strubg,Object&gt;</td>
<td>获取 pageContext 域中的</td>
</tr>
<tr>
<td style="text-align:left"><strong>requestScope</strong></td>
<td>Map&lt;Strubg,Object&gt;</td>
<td>获取 Request 域中的数</td>
</tr>
<tr>
<td style="text-align:left"><strong>sessionScope</strong></td>
<td>Map&lt;Strubg,Object&gt;</td>
<td>获取 Session 域中的数据</td>
</tr>
<tr>
<td style="text-align:left"><strong>applicationScope</strong></td>
<td>Map&lt;Strubg,Object&gt;</td>
<td>获取 ServletContext 域中的数据</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left"><strong>param</strong></td>
<td>Map&lt;Strubg,String&gt;</td>
<td>获取请求参数的值(同getParameter())</td>
</tr>
<tr>
<td style="text-align:left"><strong>paramValues</strong></td>
<td>Map&lt;Strubg,String[]&gt;</td>
<td>同上，获取多个值的时候使用</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left"><strong>header</strong></td>
<td>Map&lt;String,String&gt;</td>
<td>获取请求头的信息</td>
</tr>
<tr>
<td style="text-align:left"><strong>headerValues</strong></td>
<td>Map&lt;Strubg,String[]&gt;</td>
<td>同上，获取多个值的情况使用</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left"><strong>cookie</strong></td>
<td>Map&lt;Strubg,Cookie&gt;</td>
<td>获取当前请求的 Cookie 信息</td>
</tr>
<tr>
<td style="text-align:left"><strong>initParam</strong></td>
<td>Map&lt;String,String&gt;</td>
<td>获取web.xml中<code>&lt;context-param&gt;</code>参数</td>
</tr>
</tbody>
</table>
<h3 id="域隐函对象">域隐函对象</h3>
<ul>
<li>pageScope ——&gt; pageContext 域</li>
<li>requestScope ——&gt; request 域</li>
<li>sessionScope ——&gt; Session 域</li>
<li>applicationScope ——&gt; ServletContext 域</li>
</ul>
<hr>
<ul>
<li><strong>示例</strong></li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    pageContext.setAttribute(<span class="string">&quot;key1&quot;</span>, <span class="string">&quot;pageContext1&quot;</span>);</span><br><span class="line">    pageContext.setAttribute(<span class="string">&quot;key2&quot;</span>, <span class="string">&quot;pageContext2&quot;</span>);</span><br><span class="line">    request.setAttribute(<span class="string">&quot;key2&quot;</span>, <span class="string">&quot;request&quot;</span>);</span><br><span class="line">    session.setAttribute(<span class="string">&quot;key2&quot;</span>, <span class="string">&quot;session&quot;</span>);</span><br><span class="line">    application.setAttribute(<span class="string">&quot;key2&quot;</span>, <span class="string">&quot;application&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">$&#123; key2 &#125; &lt;%-- 非指定域搜索数据，默认从小到大 --&gt;</span><br><span class="line">&lt;%-- 指定域搜索数据 --&gt;</span><br><span class="line">$&#123; requestScope.key2 &#125;</span><br><span class="line">$&#123; applicationScope.key2 &#125;</span><br></pre></td></tr></table></figure>
<h3 id="pageContext">pageContext</h3>
<p>pageContext隐函对象可获取任意9大jsp隐函对象，获取后常用功能如下</p>
<ol>
<li>协议</li>
<li>服务器 ip</li>
<li>服务器端口</li>
<li><strong>获取工程路径</strong></li>
<li>获取请求方式</li>
<li>获取客户端 ip 地址</li>
<li>获取会话的 id 编号</li>
</ol>
<hr>
<ul>
<li><strong>示例</strong></li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;%--</span><br><span class="line">    原生方法说明</span><br><span class="line">    request.getScheme() 它可以获取请求的协议,如 http、https</span><br><span class="line">    request.getServerName() 获取请求的服务器ip或域名，如 <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">    request.getServerPort() 获取请求的服务器端口号，如 <span class="number">80</span></span><br><span class="line">    request.getContextPath() 获取当前工程路径，如 /<span class="number">09</span>_EL_JSTL</span><br><span class="line">    request.getMethod() 获取请求的方式，如（GET 或 POST）</span><br><span class="line">    request.getRemoteHost() 获取客户端的 ip 地址</span><br><span class="line">    session.getId() 获取会话的唯一标识</span><br><span class="line">--%&gt;</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>协议： $&#123; pageContext.request.scheme &#125;&lt;br&gt;</span><br><span class="line"><span class="number">2.</span>服务器 ip：$&#123; pageContext.request.serverName &#125;&lt;br&gt;</span><br><span class="line"><span class="number">3.</span>服务器端口：$&#123; pageContext.request.serverPort &#125;&lt;br&gt;</span><br><span class="line"><span class="number">4.</span>获取工程路径：$&#123; pageContext.request.contextPath &#125;&lt;br&gt;</span><br><span class="line"><span class="number">5.</span>获取请求方法：$&#123; pageContext.request.method &#125;&lt;br&gt;</span><br><span class="line"><span class="number">6.</span>获取客户端 ip 地址：$&#123; pageContext.request.remoteHost &#125;&lt;br&gt;</span><br><span class="line"><span class="number">7.</span>获取会话的 id 编号：$&#123; pageContext.session.id &#125;&lt;br&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>提高EL表达式简洁度的技巧</strong></li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">	<span class="comment">//如需调用request相关方法，则不通pageContext获取request对象</span></span><br><span class="line">	<span class="comment">//而将JSP的request隐函对象存入pageContext域后直接用EL表达式调用</span></span><br><span class="line">    pageContext.setAttribute(<span class="string">&quot;req&quot;</span>, request);</span><br><span class="line">%&gt;</span><br><span class="line">优化前： $&#123; pageContext.request.scheme &#125;&lt;br&gt;</span><br><span class="line">优化后： $&#123; req.scheme &#125;&lt;br&gt;</span><br></pre></td></tr></table></figure>
<h3 id="param">param</h3>
<ul>
<li><strong>param</strong> Map&lt;String,String&gt;：它可以获取请求参数的值</li>
<li><strong>paramValues</strong> Map&lt;String,String[]&gt;： 它也可以获取请求参数的值，获取<strong>多个值</strong>的时候使用。</li>
</ul>
<hr>
<ul>
<li><strong>示例代码</strong></li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">输出请求参数 username 的值：$&#123; param.username &#125; &lt;br&gt;</span><br><span class="line">输出请求参数 password 的值：$&#123; param.password &#125; &lt;br&gt;</span><br><span class="line">输出请求参数 hobby 的值：$&#123; paramValues.hobby[<span class="number">0</span>] &#125; &lt;br&gt;</span><br><span class="line">输出请求参数 hobby 的值：$&#123; paramValues.hobby[<span class="number">1</span>] &#125; &lt;br&gt;</span><br></pre></td></tr></table></figure>
<h3 id="header">header</h3>
<ul>
<li><strong>header</strong> Map&lt;String,String&gt;：它可以获取请求头的信息的各种键值对</li>
<li><strong>headerValues</strong> Map&lt;String,String[]&gt;： 它可以获取请求头的信息，它可以获取多个值的情况。</li>
</ul>
<hr>
<ul>
<li>示例代码：</li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输出请求头【User-Agent】的值：$&#123; header[<span class="string">&#x27;User-Agent&#x27;</span>] &#125; &lt;br&gt;</span><br><span class="line">输出请求头【Connection】的值：$&#123; header.Connection &#125; &lt;br&gt;</span><br><span class="line">输出请求头【User-Agent】的值：$&#123; headerValues[<span class="string">&#x27;User-Agent&#x27;</span>][<span class="number">0</span>]&#125; &lt;br&gt;</span><br></pre></td></tr></table></figure>
<h3 id="cookie">cookie</h3>
<ul>
<li><strong>cookie</strong> Map&lt;String,Cookie&gt;： 它可以获取当前请求的 Cookie 信息</li>
</ul>
<hr>
<ul>
<li>示例代码</li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">获取 Cookie 的名称：$&#123; cookie.JSESSIONID.name &#125; &lt;br&gt;</span><br><span class="line">获取 Cookie 的值：$&#123; cookie.JSESSIONID.value &#125; &lt;br&gt;</span><br></pre></td></tr></table></figure>
<h3 id="initParam">initParam</h3>
<ul>
<li><strong>initParam</strong> Map&lt;String,String&gt; ：它可以获取在 web.xml 中配置的上下文参数</li>
</ul>
<hr>
<ul>
<li><strong>web.xml</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>username<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>url<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>jdbc:mysql:///test<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>示例代码</strong></li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输出&amp;lt;Context-param&amp;gt;username 的值：$&#123;initParam.username&#125; &lt;br&gt;</span><br><span class="line">输出&amp;lt;Context-param&amp;gt;url 的值：$&#123;initParam.url&#125; &lt;br&gt;</span><br></pre></td></tr></table></figure>
<h1 id="JSTL">JSTL</h1>
<h2 id="简介-2">简介</h2>
<ul>
<li>JSTL 标签库全称是指 JSP Standard Tag Library，即<strong>JSP标准标签库</strong>。是一个不断完善的<strong>开放源代码</strong>的 JSP 标签库。 属于JSP动作，其开源性起始源于自定义标签库的功能。可以说JSTL是最广泛使用友好的自定义标签库典范。</li>
<li>EL 表达式主要是为了替换 jsp 中的表达式脚本，而<strong>标签库</strong>则是为了<strong>替换JSP小脚本</strong>。使得整个jsp 页面变得更加简洁。</li>
<li>本章内容不涉及自定义标签库知识，有需求时学(保留2013版JavaWeb资源即可)</li>
<li>通常，JSTL是结合EL表达式使用的，<strong>EL</strong>表达式用于<strong>获取与显示</strong>数据，<strong>JSTL</strong>用于<strong>操作数据</strong>。</li>
<li>tips：<code>&lt;%-- 凡是涉及后端解析的代码，如JSP、EL、JSTL注释都必须是用JSP注释，否则会被解析 --%&gt;</code></li>
</ul>
<h2 id="标签库类型">标签库类型</h2>
<table>
<thead>
<tr>
<th>功能范围</th>
<th>URI</th>
<th>前缀</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>核心标签库</strong></td>
<td><a class="link"   target="_blank" rel="noopener" href="http://java.sun.com/jsp/jstl/core" >http://java.sun.com/jsp/jstl/core<i class="fas fa-external-link-alt"></i></a></td>
<td>c</td>
</tr>
<tr>
<td>格式化</td>
<td><a class="link"   target="_blank" rel="noopener" href="http://java.sun.com/jsp/jstl/fmt" >http://java.sun.com/jsp/jstl/fmt<i class="fas fa-external-link-alt"></i></a></td>
<td>fmt</td>
</tr>
<tr>
<td>函数</td>
<td><a class="link"   target="_blank" rel="noopener" href="http://java.sun.com/jsp/jstl/functions" >http://java.sun.com/jsp/jstl/functions<i class="fas fa-external-link-alt"></i></a></td>
<td>fn</td>
</tr>
<tr>
<td>数据库(不使用)</td>
<td><a class="link"   target="_blank" rel="noopener" href="http://java.sun.com/jsp/jstl/sql" >http://java.sun.com/jsp/jstl/sql<i class="fas fa-external-link-alt"></i></a></td>
<td>sql</td>
</tr>
<tr>
<td>XML(不使用)</td>
<td><a class="link"   target="_blank" rel="noopener" href="http://java.sun.com/jsp/jstl/xml" >http://java.sun.com/jsp/jstl/xml<i class="fas fa-external-link-alt"></i></a></td>
<td>x</td>
</tr>
</tbody>
</table>
<h2 id="JSTL的使用步骤">JSTL的使用步骤</h2>
<p>JSTL是一系列标签库，主要用于操作数据。如遍历操作</p>
<ol>
<li>
<p>先导入jstl 标签库的<strong>jar 包</strong>。</p>
<ul>
<li>taglibs-standard-impl-1.2.1.jar</li>
<li>taglibs-standard-spec-1.2.1.jar</li>
</ul>
</li>
<li>
<p>使用 <strong>taglib 指令</strong>引入标签库，使用哪种类型的标签库则引入对应的URI</p>
<p><code> &lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot; %&gt;</code></p>
</li>
</ol>
<h2 id="core核心库">core核心库</h2>
<h3 id="set">set</h3>
<p>set 标签可以往域中保存数据，**等同于setAttribute()**操作(较少使用)</p>
<ul>
<li><strong>scope属性</strong>：设置保存到哪个域中
<ul>
<li>page 表示 PageContext 域（默认值）</li>
<li>request 表示 Request 域</li>
<li>session 表示 Session 域</li>
</ul>
</li>
<li><strong>var属性</strong>：设置key值</li>
<li><strong>value属性</strong>：设置属性值</li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">保存前：$&#123; sessionScope.abc &#125; &lt;br&gt;</span><br><span class="line">&lt;c:set scope=<span class="string">&quot;session&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;abc&quot;</span> value=<span class="string">&quot;abcValue&quot;</span>/&gt;</span><br><span class="line">保存后：$&#123; sessionScope.abc &#125; &lt;br&gt;</span><br></pre></td></tr></table></figure>
<h3 id="if">if</h3>
<p>if标签实现if逻辑操作，<strong>单路判断</strong>，即只能if，不能if-else(if-else只能拆解成两个条件进行)</p>
<ul>
<li><strong>test属性</strong>：表示判断的条件，使用<strong>EL表达式编写</strong></li>
</ul>
 <figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123; 12 == 12 &#125;&quot;</span>&gt;</span><br><span class="line">	&lt;h1&gt;12 等于 12&lt;/h1&gt;</span><br><span class="line">&lt;/c:if&gt;</span><br><span class="line"></span><br><span class="line">&lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123; 12 != 12 &#125;&quot;</span>&gt;</span><br><span class="line">	&lt;h1&gt;12 不等于 12&lt;/h1&gt;</span><br><span class="line">&lt;/c:if&gt;</span><br></pre></td></tr></table></figure>
<h3 id="choose-when-otherwise">choose-when-otherwise</h3>
<p><strong>多路判断</strong>，类似于switch … case … default ，区别是，当前标签一旦<strong>匹配一个则退出执行</strong>，否则执行otherwise</p>
<ul>
<li><strong>choose标签</strong>：开始选择判断，类switch</li>
<li><strong>when标签</strong>：每一种判断情况，类case
<ul>
<li><strong>test属性</strong>：表示当前判断情况的值，类case <strong>value</strong> : ?</li>
</ul>
</li>
<li><strong>otherwise标签</strong>：剩余的情况，类 default</li>
</ul>
<hr>
<ul>
<li><strong>示例代码</strong></li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;% request.setAttribute(<span class="string">&quot;height&quot;</span>, <span class="number">180</span>); %&gt;</span><br><span class="line">&lt;c:choose&gt;</span><br><span class="line">    &lt;c:when test=<span class="string">&quot;$&#123; requestScope.height &gt; 190 &#125;&quot;</span>&gt;</span><br><span class="line">    &lt;h2&gt;小巨人&lt;/h2&gt;</span><br><span class="line">    &lt;/c:when&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;c:when test=<span class="string">&quot;$&#123; requestScope.height &gt; 180 &#125;&quot;</span>&gt;</span><br><span class="line">    	&lt;h2&gt;很高&lt;/h2&gt;</span><br><span class="line">    &lt;/c:when&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;c:when test=<span class="string">&quot;$&#123; requestScope.height &gt; 170 &#125;&quot;</span>&gt;</span><br><span class="line">    &lt;h2&gt;还可以&lt;/h2&gt;</span><br><span class="line">    &lt;/c:when&gt;</span><br><span class="line">  </span><br><span class="line">    &lt;c:otherwise&gt;</span><br><span class="line">		&lt;h2&gt;其他&lt;/h2&gt;</span><br><span class="line">    &lt;/c:otherwise&gt;</span><br><span class="line">&lt;/c:choose&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>使用注意点：</p>
<ol>
<li>标签里<strong>不能使用 html 注释</strong>，要使用 jsp 注释</li>
<li>when标签的<strong>父标签</strong>一定要是<strong>choose</strong>标签</li>
</ol>
</li>
<li>
<p><strong>示例代码</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%-- 例如若想在otherwise里面再细分，则需要先写一个choose标签再写when标签 --&gt;</span><br><span class="line">&lt;c:otherwise&gt;</span><br><span class="line">        &lt;c:choose&gt;</span><br><span class="line">        &lt;c:when test=<span class="string">&quot;$&#123;requestScope.height &gt; 160&#125;&quot;</span>&gt;</span><br><span class="line">        &lt;h3&gt;大于 160&lt;/h3&gt;</span><br><span class="line">        &lt;/c:when&gt;</span><br><span class="line">        &lt;c:when test=<span class="string">&quot;$&#123;requestScope.height &gt; 150&#125;&quot;</span>&gt;</span><br><span class="line">        &lt;h3&gt;大于 150&lt;/h3&gt;</span><br><span class="line">        &lt;/c:when&gt;</span><br><span class="line">        &lt;c:when test=<span class="string">&quot;$&#123;requestScope.height &gt; 140&#125;&quot;</span>&gt;</span><br><span class="line">        &lt;h3&gt;大于 140&lt;/h3&gt;</span><br><span class="line">        &lt;/c:when&gt;</span><br><span class="line">        &lt;c:otherwise&gt;</span><br><span class="line">        其他小于 <span class="number">140</span></span><br><span class="line">        &lt;/c:otherwise&gt;</span><br><span class="line">        &lt;/c:choose&gt;</span><br><span class="line">&lt;/c:otherwise&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="forEach">forEach</h3>
<h4 id="遍历输出">遍历输出</h4>
<p>普通遍历输出，等价于<code>for(int i;i &lt;= 10;i++)</code></p>
<ul>
<li><strong>begin属性</strong>：设置开始的索引</li>
<li><strong>end属性</strong>：设置结束的索引，<code>&lt;=</code></li>
<li><strong>var属性</strong>：表示循环的变量(也是当前正在遍历到的数据)</li>
</ul>
<hr>
<ul>
<li><strong>示例代码1</strong>：遍历 1 到 10，输出，类同普通for循环<code>for(int i;i &lt;= 10;i++)</code></li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:forEach begin=<span class="string">&quot;1&quot;</span> end=<span class="string">&quot;10&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;i&quot;</span>&gt;</span><br><span class="line">	$&#123;i&#125;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
<h4 id="遍历数组">遍历数组</h4>
<p>遍历Object类型数组，类同增强for循环<code>for(Object obj: args)</code></p>
<ul>
<li><strong>items属性</strong>：表示遍历的<strong>数据源</strong>，类同上述的 args</li>
<li><strong>var属性</strong>：同上，表示当前遍历到的数据</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">	request.setAttribute(<span class="string">&quot;arr&quot;</span>, </span><br><span class="line">	<span class="keyword">new</span> String[]&#123;<span class="string">&quot;18610541354&quot;</span>,<span class="string">&quot;18688886666&quot;</span>,<span class="string">&quot;18699998888&quot;</span>&#125;);</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;c:forEach items=<span class="string">&quot;$&#123; requestScope.arr &#125;&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;item&quot;</span>&gt;</span><br><span class="line">    $&#123; item &#125; &lt;br&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
<h4 id="遍历Map">遍历Map</h4>
<p>遍历Map，类同<code>for ( Map.Entry&lt;String,Object&gt; entry : map.entrySet())</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;key1&quot;</span>, <span class="string">&quot;value1&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;key2&quot;</span>, <span class="string">&quot;value2&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;key3&quot;</span>, <span class="string">&quot;value3&quot;</span>);</span><br><span class="line">    request.setAttribute(<span class="string">&quot;map&quot;</span>, map);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;c:forEach items=<span class="string">&quot;$&#123; requestScope.map &#125;&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;entry&quot;</span>&gt;</span><br><span class="line">	&lt;h1&gt;$&#123;entry.key&#125; = $&#123;entry.value&#125;&lt;/h1&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
<h4 id="遍历List">遍历List</h4>
<p>注意：以下借助遍历List说明forEach标签各种属性结合实现的效果，<strong>并非只有遍历List才可使用。</strong></p>
<ul>
<li><strong>测试Java类</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="comment">//编号，用户名，密码，年龄，电话信息</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//省略构造器以及getter与setter方法...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>示例代码1：<strong>普通遍历</strong>(全部遍历)</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">	<span class="comment">//数据准备</span></span><br><span class="line">    List&lt;Student&gt; studentList = <span class="keyword">new</span> ArrayList&lt;Student&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++) &#123;</span><br><span class="line">        studentList.add(<span class="keyword">new</span> Student(i,<span class="string">&quot;username&quot;</span>+i ,<span class="string">&quot;pass&quot;</span>+i,<span class="number">18</span>+i,<span class="string">&quot;phone&quot;</span>+i));</span><br><span class="line">    &#125;</span><br><span class="line">	request.setAttribute(<span class="string">&quot;stus&quot;</span>, studentList);</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;c:forEach items=<span class="string">&quot;$&#123;requestScope.stus&#125;&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;stu&quot;</span>&gt;</span><br><span class="line">    $&#123;stu.id&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;stu.username&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;stu.password&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;stu.age&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;stu.phone&#125;&lt;br/&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>示例2：指定<strong>区间</strong>、<strong>步长</strong>遍历</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:forEach begin=<span class="string">&quot;2&quot;</span> end=<span class="string">&quot;7&quot;</span> step=<span class="string">&quot;2&quot;</span> items=<span class="string">&quot;$&#123;requestScope.stus&#125;&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;stu&quot;</span>&gt;</span><br><span class="line">    $&#123;stu.id&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;stu.username&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;stu.password&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;stu.age&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;stu.phone&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;status.step&#125;&lt;br/&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>示例3：<strong>varStatus对象</strong>
<ul>
<li>
<p>varStatus 属性表示当前遍历到的数据的<strong>状态</strong>，是一个实体对象。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:forEach varStatus=<span class="string">&quot;status&quot;</span> items=<span class="string">&quot;$&#123;requestScope.stus&#125;&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;stu&quot;</span>&gt;</span><br><span class="line">	$&#123;status&#125;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>该对象所在类在源码中实现了LoopTagStatus接口，接口包含如下方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">LoopTagStatus</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">getCurrent</span><span class="params">()</span></span>;<span class="comment">//获取当前遍历到的数据</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getlndex</span><span class="params">()</span></span>;<span class="comment">//获取当前遍历的索引</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span></span>;<span class="comment">//获取已遍历的个数</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isFirst</span><span class="params">()</span></span>;<span class="comment">//判断当前遍历的数据是否属于第一条</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLast</span><span class="params">()</span></span>;<span class="comment">//判断当前遍历的数据是否属于最后一条</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getBegin</span><span class="params">()</span></span>;<span class="comment">//获取遍历的起始值</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getEnd</span><span class="params">()</span></span>;<span class="comment">//获取遍历的结束值</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getStep</span><span class="params">()</span></span>;<span class="comment">//获取当前设置的步长值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h1 id="Listener监听器">Listener监听器</h1>
<p>什么是监听器？监听器就是实时监视一些事物状态的程序，我们称为监听器。</p>
<ul>
<li>Listener 监听器它是 JavaWeb 的<strong>三大组件之一</strong>：Servlet 程序、Filter 过滤器、<strong>Listener监听器</strong>。</li>
<li>Listener它是 JavaEE 的<strong>规范</strong>，就是<strong>接口</strong></li>
<li>监听器的作用是监听某种事物的变化。然后通过<strong>回调函数</strong>，反馈给客户(程序)去做一些相应的处理。</li>
</ul>
<h2 id="ServletContextListener">ServletContextListener</h2>
<p>随之技术的变革，绝大多数类型的监听器已经用不上了，剩下ServletContextListener有较高的使用频率。</p>
<h3 id="功能">功能</h3>
<ul>
<li>
<p>ServletContextListener它可以监听 <strong>ServletContext</strong> 对象的<strong>创建和销毁</strong></p>
</li>
<li>
<p>ServletContext对象在 web 工程启动的时候创建，在 web 工程停止的时候销毁</p>
</li>
<li>
<p><strong>监听到创建和销毁</strong>之后都会分别调用ServletContextListener<strong>监听器的方法</strong>反馈。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ServletContextListener</span> <span class="keyword">extends</span> <span class="title">EventListener</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 在 ServletContext 对象创建之后马上调用，做初始化</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextInitialized</span><span class="params">(ServletContextEvent sce)</span></span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 在 ServletContext 对象销毁之后调用</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextDestroyed</span><span class="params">(ServletContextEvent sce)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="操作步骤">操作步骤</h3>
<ol>
<li>编写一个类去<strong>实现ServletContextListener接口</strong></li>
<li><strong>实现</strong>其两个回调<strong>方法</strong></li>
<li>到 <strong>web.xml</strong>中去<strong>配置监听器</strong></li>
</ol>
<ul>
<li>
<p><strong>ServletContextListenerTest.java</strong></p>
<p>由于接口中用的时<strong>default</strong>作为修饰符，且方法体已<strong>空实现</strong>（有大括号），所以不会提示有熟悉的红色下划线 快捷实现接口中的抽象方法 的操作，需自己在IDE中编写方法，提示重写。</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServletContextListenerTest</span> <span class="keyword">implements</span> <span class="title">ServletContextListener</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextInitialized</span><span class="params">(ServletContextEvent sce)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;servletContext对象已被创建&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextDestroyed</span><span class="params">(ServletContextEvent sce)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;servletContext对象已被销毁&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>web.xml</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>com.website.test.ServletContextListenerTest<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="文件上传与下载">文件上传与下载</h1>
<h2 id="文件上传">文件上传</h2>
<h3 id="基本步骤">基本步骤</h3>
<ol>
<li>
<p><strong>form标签</strong></p>
<ul>
<li>
<p><strong>method</strong> = post：由于get请求有长度限制因此使用post请求</p>
</li>
<li>
<p><strong>encType</strong> = multiparty/form-data</p>
<ul>
<li>表示提交的数据，以<strong>多段</strong>(<strong>每一个表单</strong>项一个数据段)的形式进行<strong>拼接</strong>，然后以<strong>二进制流</strong>的形式发送给服务器。</li>
<li>注意：以二进制流形式发送时，<strong>不能</strong>再用getParameter()取获取数据，结果只能为null，应该使用getInputStream()获取</li>
</ul>
</li>
</ul>
</li>
<li>
<p>在form标签中使用<strong>input type = file</strong> 添加上传文件</p>
</li>
<li>
<p><strong>编写服务器代码</strong>，处理上传数据。</p>
</li>
</ol>
<h3 id="HTTP协议部分">HTTP协议部分</h3>
<ul>
<li><strong>前端代码</strong></li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/uploadServlet&quot;</span></span><br><span class="line">          method=<span class="string">&quot;post&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">      用户名：&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>&gt;&lt;br/&gt;</span><br><span class="line">      头像：&lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;photo&quot;</span>&gt;&lt;br/&gt;</span><br><span class="line">      &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>前端页面</strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210413174648.png"
                      alt=""
                ></p>
</li>
<li>
<p>后端代码：打印上传的流内容</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;文件上传&quot;</span>);</span><br><span class="line">        ServletInputStream inputStream = req.getInputStream();</span><br><span class="line">        <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span> * <span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> len = inputStream.read(buffer);</span><br><span class="line">        System.out.println(<span class="keyword">new</span> String(buffer,<span class="number">0</span>,len));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>后端打印结果：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">文件上传</span><br><span class="line">------WebKitFormBoundaryVldrwB6NIgx1Eq3S</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;username&quot;</span><br><span class="line"></span><br><span class="line">wzg168</span><br><span class="line">------WebKitFormBoundaryVldrwB6NIgx1Eq3S</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;photo&quot;; filename&#x3D;&quot;d.jpg&quot;</span><br><span class="line">Content-Type: image&#x2F;jpeg</span><br><span class="line"></span><br><span class="line">??? JFIF  x x  ?? C	</span><br><span class="line">2!!22222222222222222222222222222222222222222222222222?? @Q&quot; ??           	</span><br><span class="line">?? ?   &#125; !1AQa&quot;q2亼#B绷R佯$3br?	</span><br><span class="line">%&amp;&#39;()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz儎厗噲墛挀敃枟槞殺￥ウЖ┆渤吹斗腹郝媚牌侨墒矣哉肿刭卺忏溴骁栝犟蝮趱鲼??        	</span><br><span class="line">?? ?  w !1AQaq&quot;2B憽绷	#3R?br?</span><br><span class="line">攽&lt;hz噔痆?А矸宒f疇挐籘柭XU草?&gt;X龅j0猹Mz裶&quot;m?8п筧P诶U廿A#R邦7f險湑弌z播堒?螶庒?#僙#6SWa匝?袈pH5晤焪z?幖?犛?:圆媕I猡_璘嶠^*&#96;Mf?dz慩儌sU崭隣躴溤焢&gt;敼郥</span><br><span class="line">E?&#39;?B硘??......</span><br></pre></td></tr></table></figure>
<ul>
<li>上传文件，<strong>HTTP协议分析</strong></li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/文件上传Http请求.png"
                      style="zoom:150%;" /
                >
<h3 id="上传实现">上传实现</h3>
<p>当清楚了上传文件的HTTP请求头信息格式后，其实剩下的就是对服务器接收到的流数据进行<strong>解析即刻</strong>，如通过请求头的boundary获取到每段数据的分隔符，然后再分解不同表单的数据，对应处理即可…，在java开发一般这种数据解析操作常使用<strong>apache</strong>提供的commons-fileupload.jar实现。</p>
<h4 id="jar包依赖">jar包依赖</h4>
<ul>
<li>commons-fileupload-1.2.1.jar</li>
<li>commons-io-1.4.jar</li>
</ul>
<h4 id="常用类说明">常用类说明</h4>
<ul>
<li><strong>ServletFileUpload</strong>：用于解析上传的数据
<ul>
<li>boolean ServletFileUpload.<strong>isMultipartContent</strong>(HttpServletRequest request);
<ul>
<li>判断当前上传的数据格式是否是多段的格式，true则是多段格式，false则不是</li>
</ul>
</li>
<li>public List&lt;FileItem&gt; <strong>parseRequest</strong>(HttpServletRequest request) ：解析上传的数据 。</li>
</ul>
</li>
<li><strong>FileItem</strong>：封装每一个表单项的数据。
<ul>
<li>boolean FileItem.<strong>isFormField</strong>()：判断当前表单项属于普通还是上传表单项
<ul>
<li>true：表示普通类型的表单项</li>
<li>false：表示上传的文件类型</li>
</ul>
</li>
<li>String FileItem.<strong>getFieldName</strong>()： 获取表单项的<strong>name属性值</strong></li>
<li>String FileItem.<strong>getString</strong>()： 获取当前表单项的值。</li>
<li>String FileItem.<strong>getName</strong>()：获取上传的文件名</li>
<li>void FileItem.<strong>write</strong>(file) ：将上传的文件<strong>写到参数file</strong>所指向抽硬盘位置</li>
</ul>
</li>
</ul>
<h4 id="示例代码-2">示例代码</h4>
<ul>
<li><strong>index.jsp</strong></li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/uploadServlet&quot;</span></span><br><span class="line">          method=<span class="string">&quot;post&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">      用户名：&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>&gt;&lt;br/&gt;</span><br><span class="line">      头像：&lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;photo&quot;</span>&gt;&lt;br/&gt;</span><br><span class="line">      &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>UploadServlet.java</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1、通过静态方法判断上传的数据是否为多段数据(只有是多段数据，才是文件上传)</span></span><br><span class="line">        <span class="keyword">if</span>(ServletFileUpload.isMultipartContent(req))&#123;</span><br><span class="line">            <span class="comment">//3、创建FileItemFactory接口实现类对象，传入ServletFileUpload构造器中</span></span><br><span class="line">            FileItemFactory fileItemFactory = <span class="keyword">new</span> DiskFileItemFactory();</span><br><span class="line">            <span class="comment">//2、创建ServletFileUpload对象进行数据解析工作，注意空参构造器不是给我们初始化的</span></span><br><span class="line">            ServletFileUpload servletFileUpload = <span class="keyword">new</span> ServletFileUpload(fileItemFactory);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//3、解析所有数据</span></span><br><span class="line">                List&lt;FileItem&gt; list = servletFileUpload.parseRequest(req);</span><br><span class="line">                <span class="comment">//4、遍历每个表单项数据</span></span><br><span class="line">                <span class="keyword">for</span>(FileItem item : list)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(item.isFormField())&#123;<span class="comment">//5、普通表单项目获取name-value</span></span><br><span class="line">                        String name = item.getFieldName();<span class="comment">//</span></span><br><span class="line">                        String value = item.getString();<span class="comment">//中文乱码可传入&quot;UTF-8&quot;形参</span></span><br><span class="line">                        System.out.println(<span class="string">&quot;普通表单项 name = &quot;</span> + name);</span><br><span class="line">                        System.out.println(<span class="string">&quot;普通表单项 value = &quot;</span> + value);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;<span class="comment">//6、上传表单项获取name-fileName-流操作</span></span><br><span class="line">                        String name = item.getFieldName();</span><br><span class="line">                        String fieldName = item.getName();</span><br><span class="line">                        System.out.println(<span class="string">&quot;上传表单项 name = &quot;</span> + name);</span><br><span class="line">                        System.out.println(<span class="string">&quot;上传表单项 fieldName = &quot;</span> + fieldName);</span><br><span class="line"></span><br><span class="line">                        <span class="comment">//流操作，将上传文件写入本地磁盘</span></span><br><span class="line">                        item.write(<span class="keyword">new</span> File(<span class="string">&quot;d:\\TestFolder\\uploadTest\\&quot;</span> + fieldName));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="文件下载">文件下载</h2>
<h3 id="基本步骤-2">基本步骤</h3>
<ol>
<li>从客户的请求中读取要<strong>下载的文件名</strong></li>
<li>设置<strong>响应类型</strong>
<ul>
<li>String servletContext.<strong>getMimeType</strong>(String filePath);
<ul>
<li>String filePath：表示文件的实际存储路径，&quot;/&quot; 表明当前web应用的web根目录</li>
</ul>
</li>
<li>response.<strong>setContentType</strong>(String mimeType);</li>
</ul>
</li>
<li>可选：设置<strong>响应头</strong>，表明数据是用于下载的(如图片，实现非直接打开，而是<strong>弹出浏览器下载</strong>)
<ul>
<li>response.<strong>setHeader</strong>(“Content-Disposition”,“attachement;filename=文件名”);
<ul>
<li>Content-Disposition响应头：指明收到的数据如何处理</li>
<li>attachement：意为附件，表示下载使用</li>
<li>filename=文件名：设置响应给客户时下载的文件名(可自定义)</li>
</ul>
</li>
</ul>
</li>
<li><strong>读取</strong>下载文件的内容：获取文件的InputStream对象，获取途径可能存在多种
<ul>
<li>文件存储在web应用本身可用：servletContext.getResourceAsStream(String path);</li>
</ul>
</li>
<li>把下载文件<strong>回传</strong>给客户端
<ol>
<li>首先获取用于响应的输出流：OutputStream response.<strong>getOutputStream</strong>();</li>
<li>把文件的输入流逐一读取并传入响应的输出流</li>
</ol>
</li>
</ol>
<h3 id="下载实现">下载实现</h3>
<p>下载操作代码实现<strong>基本不用使用其他第三方jar包</strong>，IO操作中可以使用apache的commons-io-1.4.jar(也是commons-fileupload-1.2.1.jar的依赖)来简化IO代码书写。其余<strong>大部分使用源生代码实现</strong>。</p>
<hr>
<ul>
<li>项目结构：在web根目录下创建file文件夹，里面存放abc.jpg图片</li>
<li><strong>downloadPage.jsp</strong></li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;a href=&quot;$&#123;pageContext.request.contextPath&#125;/downloadServlet&quot;&gt;下载文件&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>DownloadServlet.java</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.website.download;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.IOUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContext;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletOutputStream;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yhd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2021-04-14 16:29</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DownloadServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1、从客户端请求中读取拟下载文件的文件名，(演示写死文件名)</span></span><br><span class="line">        String fileName = <span class="string">&quot;abc.jpg&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2、设置响应类型</span></span><br><span class="line">        ServletContext servletContext = getServletContext();</span><br><span class="line">        String mimeType = servletContext.getMimeType(<span class="string">&quot;/file/&quot;</span> + fileName);</span><br><span class="line">        resp.setContentType(mimeType);</span><br><span class="line">        System.out.println(<span class="string">&quot;mimeType = &quot;</span> + mimeType);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3、设置响应头：指明响应数据的处理方式，调用浏览器附件下载(fileName可自定义)</span></span><br><span class="line">        resp.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>,<span class="string">&quot;attachment;filename=&quot;</span> + fileName);</span><br><span class="line">        <span class="comment">//4、获取拟回传文件的输入流</span></span><br><span class="line">        InputStream resourceAsStream = servletContext.getResourceAsStream(<span class="string">&quot;/file/&quot;</span> + fileName);</span><br><span class="line">        System.out.println(<span class="string">&quot;resourceAsStream = &quot;</span> + resourceAsStream);</span><br><span class="line">        <span class="comment">//5、获取响应输出流</span></span><br><span class="line">        ServletOutputStream outputStream = resp.getOutputStream();</span><br><span class="line">        <span class="comment">//6、把数据读出并想响应输出流输出(为方便IO操作代码，使用apache，commons-io的IOUtils)</span></span><br><span class="line">        IOUtils.copy(resourceAsStream,outputStream);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="setHeader中文乱码">setHeader中文乱码</h3>
<p>当通过setHeader()设置回传给浏览器附件下载时的下载明含中文时出现乱码，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resp.setHeader(&quot;Content-Disposition&quot;,&quot;attachment;filename&#x3D;&quot; + &quot;中国.jpg&quot;);</span><br></pre></td></tr></table></figure>
<ul>
<li>解决方案1：<strong>URLEncoder编码</strong>，仅适用(IE，Chrome浏览器)</li>
<li>解决方案2：<strong>Base64编码</strong>，适用(火狐浏览器)</li>
</ul>
<h4 id="URL编码方案">URL编码方案</h4>
<p><strong>URLEncoder编码</strong>，仅适用(IE，Chrome浏览器)</p>
<ul>
<li><strong>编码格式</strong>：把字符串转换称为<code>%xx%xx%xx...</code>内容，xx是<strong>十六进制</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String str = <span class="string">&quot;attachment;fileName=&quot;</span> + URLEncoder.encode(<span class="string">&quot;中文.jpg&quot;</span>, <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line"><span class="comment">//str = %E4%B8%AD%E5%9B%BD.jpg</span></span><br><span class="line">response.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>, str);</span><br></pre></td></tr></table></figure>
<h4 id="Base64编码方案">Base64编码方案</h4>
<p><strong>Base64编码</strong>，适用(Chrome、火狐浏览器)，不适用IE</p>
<ul>
<li>
<p>base64编码与解码操作：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//base64解码与编码操作</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Base64Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String str = <span class="string">&quot;这是base64编码&quot;</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;原始 str = &quot;</span> + str);</span><br><span class="line">        <span class="comment">//base64编码操作</span></span><br><span class="line">        BASE64Encoder encoder = <span class="keyword">new</span> BASE64Encoder();</span><br><span class="line">        str = encoder.encode(str.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;base64编码 str = &quot;</span> + str);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//base64解码操作</span></span><br><span class="line">        BASE64Decoder decoder = <span class="keyword">new</span> BASE64Decoder();</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = decoder.decodeBuffer(str);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//解码成字节数组后，重新以UTF-8的方式编码成字符串</span></span><br><span class="line">        str = <span class="keyword">new</span> String(bytes,<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;base64解码 str = &quot;</span> + str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>setHeader</strong>中的应用：火狐浏览器中文乱码问题</p>
<ul>
<li>修改请求头部分信息
<ul>
<li>原始请求头：Content-Disposition: attachment; filename=中文名</li>
<li>修改请求头：Content-Disposition: attachment; filename=<strong>=?charset?B?xxxxx?=</strong></li>
</ul>
</li>
<li><code>=?charset?B?xxxxx?=</code>说明
<ul>
<li><strong>=?</strong>：表示编码内容的<strong>开始</strong></li>
<li><strong>charset</strong>：填充字符集类型，如UTF-8</li>
<li><strong>B</strong>：表示使用BASE64编码</li>
<li>xxxx：BASE64编码的内容，这里即表示文件名</li>
<li><strong>?=</strong>：表示编码内容的<strong>结束</strong></li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String downloadFileName = <span class="keyword">new</span> BASE64Encoder().encode(<span class="string">&quot;中国.jpg&quot;</span>.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">download = <span class="string">&quot;=?UTF-8?B?&quot;</span> + downloadFileName  + <span class="string">&quot;?=&quot;</span>;</span><br><span class="line">resp.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>,<span class="string">&quot;attachment;filename=&quot;</span> + downloadFileName);</span><br></pre></td></tr></table></figure>
<h4 id="综合解决方案">综合解决方案</h4>
<ul>
<li>通过<strong>判断User-Agent</strong>分两种情况处理，兼容chrome、火狐、ie浏览器
<ul>
<li>若为火狐浏览器、则使用base64编码</li>
<li>其他浏览器则使用URL编码</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">String downloadFileName;</span><br><span class="line">        <span class="comment">//若是火狐浏览器则使用base64编码，否则使用URL编码(UTF-8)</span></span><br><span class="line"><span class="keyword">if</span>(req.getHeader(<span class="string">&quot;User-Agent&quot;</span>).contains(<span class="string">&quot;Firefox&quot;</span>))&#123;</span><br><span class="line">    downloadFileName = <span class="string">&quot;=?UTF-8?B?&quot;</span> + <span class="keyword">new</span> BASE64Encoder().encode(<span class="string">&quot;中国.jpg&quot;</span>.getBytes(<span class="string">&quot;UTF-8&quot;</span>)) + <span class="string">&quot;?=&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    downloadFileName = URLEncoder.encode(<span class="string">&quot;中国.jpg&quot;</span>,<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">resp.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>,<span class="string">&quot;attachment;filename=&quot;</span> + downloadFileName);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="会话机制">会话机制</h1>
<h2 id="基本概念-7">基本概念</h2>
<h3 id="需求驱动-5">需求驱动</h3>
<p>在很多应用中，要求Web服务器<strong>能够跟踪客户的状态</strong>，如不同用户在同一购物网站上发出不同用户的购买订单请求。此时就要求服务器知道哪个请求是属于哪个用户的，这就是跟踪客户状态的一个应用。</p>
<h3 id="无状态特性">无状态特性</h3>
<p>协议能<strong>记住客户身份及其发出的请求</strong>的能力称为<strong>状态</strong>(state)，以这个观点可将协议分为两种类型：<strong>有状态</strong>和<strong>无状态</strong>协议。</p>
<ul>
<li><strong>HTTP协议</strong>是一种<strong>无状态的协议</strong>，对于浏览器发出的每一个请求，服务器是不能识别由哪个客户发送过来的。</li>
<li>这种无状态特性对于一些无需记录用户身份的应用是很好的，如一个在线查询系统就不用记录用户身份和状态。但对于购物车这种场景，则不能满足。</li>
</ul>
<h3 id="会话概念">会话概念</h3>
<p>会话(session)是客户与服务器进行通讯的过程，可以理解为就是”通话“。在这个”通话“持续的过程中，服务器能明确用户的身份，及其发出的所有请求。会话的跟踪就是指身份与请求源的跟踪。</p>
<h3 id="会话跟踪方案">会话跟踪方案</h3>
<p>Web服务器跟踪客户的状态有多种方法，以下是常用的跟踪方案，第二种方法是目前最常用的方法，其他几种是传统的实现会话跟踪的方法，每种方法都有各自的优缺点。</p>
<ol>
<li>使用数据库记录</li>
<li>使用Servlet API 的Session(会话)机制</li>
<li>使用持久的Cookie对象</li>
<li>使用URL的重写机制</li>
<li>使用隐藏的表单域</li>
<li>…</li>
</ol>
<h2 id="Cookie">Cookie</h2>
<h3 id="基本概念-8">基本概念</h3>
<p>Cookie是客户访问Web服务器时，服务器在客户端<strong>硬盘上</strong>存放的<strong>一小段键值对文本信息</strong>，属于一种持久化技术，好像服务器送给客户的“点心/饼干”一样。客户以后访问同一个Web服务器时浏览器会把他们原样发还服务器。常用于标识用户的身份。</p>
<ul>
<li>客户端一旦有了对应URL的Cookie后，每次请求都会发回给服务器</li>
<li>每个Cookie的大小<strong>不能超过4KB</strong>(一小段)</li>
<li>Cookie的<strong>Value</strong>值<strong>不支持中文</strong>和很多<strong>特殊字符</strong>(空格、方括号、等号、叹号…)，若内容包含这些信息需使用<strong>BASE64编码</strong></li>
<li>Cookie是HTTP协议的一部分，通过请求头<code>Set-Cookie</code>，<code>Cookie:key:value;</code>等传递cookie数据</li>
</ul>
<h3 id="创建Cookie">创建Cookie</h3>
<ul>
<li><strong>com.website.servlet.CookieServlet.java</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建并发送一个Cookie</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">createCookie</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    <span class="comment">//1、创建Cookie对象</span></span><br><span class="line">    Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">&quot;key1&quot;</span>,<span class="string">&quot;value1&quot;</span>);</span><br><span class="line">    <span class="comment">//2、通知客户端保持Cookie</span></span><br><span class="line">    resp.addCookie(cookie);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Cookie创建机制</strong>：由服务器通过<code>Set-Cookie</code><strong>请求头</strong>通知客户端，客户端收到后转存在硬盘中或修改已有的Cookie内容。</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210528205403.png"
                      alt=""
                ></p>
<h3 id="获取Cookie">获取Cookie</h3>
<p>服务器获取Cookie只有一行代码，也仅有一个方法。<code>getCookies()</code></p>
<ul>
<li><strong>com.website.servlet.CookieServlet.java</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//服务器获取Cookie</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">getCookie</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    <span class="comment">//获取cookie只有一个方法，获取当前请求所有cookie</span></span><br><span class="line">    Cookie[] cookies = req.getCookies();</span><br><span class="line">    <span class="keyword">for</span> (Cookie cookie : cookies) &#123;<span class="comment">//打印所有Cookie的键值对数据</span></span><br><span class="line">        String str = <span class="string">&quot;Cookie:[key=&quot;</span> + cookie.getName() </span><br><span class="line">            + <span class="string">&quot; : value=&quot;</span> + cookie.getValue() + <span class="string">&quot;]&lt;br/&gt;&quot;</span>;</span><br><span class="line">        resp.getWriter().write(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>com.website.util.CookieUtils.java</strong></p>
<p>由于查找指定Cookie操作非常常用，因此可封装成一个工具方法。</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 查找并返回指定键的Cookie对象引用</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> name 查找的Cookie键信息</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> cookies   被查询集</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@return</span>  若不存在返回null</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Cookie <span class="title">findCookie</span><span class="params">(String name,Cookie[] cookies)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(name == <span class="keyword">null</span> || cookies == <span class="keyword">null</span> || cookies.length == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (Cookie cookie : cookies) &#123;</span><br><span class="line">        <span class="keyword">if</span>(name.equals(cookie.getName()))&#123;</span><br><span class="line">            <span class="keyword">return</span> cookie;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>客户端发送Cookie机制：通过请求头<code>Cookie:key1:value1;key2...</code>包含所有发回的Cookie键值对</li>
</ul>
<h3 id="修改Cookie">修改Cookie</h3>
<h4 id="方案1：重构">方案1：重构</h4>
<ul>
<li>创建一个与修改Cookie同名(Key)的Cookie对象</li>
<li>在<strong>构造器</strong>创建时，赋予新的Cookie值</li>
<li>调用response.addCookie(cookie)方法发回</li>
</ul>
<hr>
<ul>
<li><strong>com.website.servlet.CookieServlet.java</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//更新指定Cookie值</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">updateCookie</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    <span class="comment">//方案1：重构修改。如修改Cookie名为key1的值</span></span><br><span class="line">    Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">&quot;key1&quot;</span>,<span class="string">&quot;newValue1&quot;</span>);</span><br><span class="line">    resp.addCookie(cookie);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="方案2：setValue">方案2：setValue()</h4>
<ul>
<li>查找到需修改的Cookie对象</li>
<li>调用<strong>setValue</strong>()方法赋予新的Cookie值</li>
<li>调用response.addCookie(cookie)方法发回</li>
</ul>
<hr>
<ul>
<li><strong>com.website.servlet.CookieServlet.java</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//更新指定Cookie值</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">updateCookie</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    <span class="comment">//方案2：setValue()修改</span></span><br><span class="line">    Cookie cookie = CookieUtils.findCookie(<span class="string">&quot;key2&quot;</span>, req.getCookies());</span><br><span class="line">    <span class="keyword">if</span>(cookie != <span class="keyword">null</span>)&#123;</span><br><span class="line">        cookie.setValue(<span class="string">&quot;newValue2&quot;</span>);</span><br><span class="line">        resp.addCookie(cookie);</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="生命控制">生命控制</h3>
<p>Cookie的生命控制一般指控制Cookie什么时候被<strong>销毁</strong>，可以通过<strong>setMaxAge</strong>(second)函数设置。</p>
<ul>
<li><strong>MaxAge值含义</strong>：单位秒
<ul>
<li><strong>正数</strong>：表示在指定的<strong>秒数后过期</strong></li>
<li><strong>负数</strong>(默认-1)：表示<strong>浏览器关闭</strong>后，Cookie就会被删除，属于标准的Session作用级别</li>
<li><strong>0</strong>：表示<strong>立即删除</strong>Cookie</li>
</ul>
</li>
<li><strong>com.website.servlet.CookieServlet.java</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cookie.setMaxAge(<span class="number">60</span> * <span class="number">60</span>); <span class="comment">// 设置 Cookie 一小时之后被删除。无效</span></span><br><span class="line">cookie.setMaxAge(-<span class="number">1</span>);<span class="comment">//创建Cookie默认-1，浏览器关闭后删除</span></span><br><span class="line">cookie.setMaxAge(<span class="number">0</span>); <span class="comment">//马上删除，不需要等待浏览器关闭</span></span><br><span class="line"></span><br><span class="line">resp.addCookie(cookie);<span class="comment">//发回给客户端</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>setMaxAge原理</strong>
<ul>
<li>通过HTTP请求头<code>Set-Cookie</code>追加了一个<code>Expires=time</code>键值对信息<strong>标识过期时间</strong>实现的</li>
<li>Expires指示的过期时间是<strong>GMT</strong>时间，即<strong>格林时间</strong>，非本土时间。</li>
<li>立即删除Cookie是将过期时间设置为一个<strong>已经过去了的时间</strong>，默认是时间戳的开始计数时间(1970.1.1)</li>
</ul>
</li>
</ul>
<h3 id="有效路径">有效路径</h3>
<p>Cookie的有效路径Path(<strong>目录信息</strong>)指只有在该路径下，浏览器才会对于将<strong>属于Path路径下的Cookie才发送给客户端</strong>。因此path属性可以用于有效过滤Cookie。(被过滤掉的Cookie，Chrome浏览器为了安全性默认屏蔽调，就是存在也不显示)</p>
<ul>
<li><strong>过滤原理实例</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;注意 path默认就是指示目录信息</span><br><span class="line">Cookie_A path&#x3D;&#x2F;工程路径</span><br><span class="line">Cookie_B path&#x3D;&#x2F;工程路径&#x2F;abc</span><br><span class="line"></span><br><span class="line">请求地址如下：</span><br><span class="line">http:&#x2F;&#x2F;ip:port&#x2F;工程路径&#x2F;a.html</span><br><span class="line">Cookie_A 发送</span><br><span class="line">Cookie_B 不发送</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;ip:port&#x2F;工程路径&#x2F;abc&#x2F;a.html</span><br><span class="line">Cookie_A 发送</span><br><span class="line">Cookie_B 发</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>com.website.servlet.CookieServlet.java</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cookie.setPath(req.getContextPath()); <span class="comment">//默认值</span></span><br><span class="line">cookie.setPath(req.getContextPath() + <span class="string">&quot;/abc&quot;</span> ); <span class="comment">//基于工程路径下追加/abc路径</span></span><br><span class="line"></span><br><span class="line">resp.addCookie(cookie);<span class="comment">//发回给客户端</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>setPath原理</strong>
<ul>
<li>通过HTTP请求头<code>Set-Cookie</code>追加了一个<code>Path=/xxx/xxx</code>键值对设置有效路径</li>
<li>Cookei默认Path参数为<strong>当前web工程名路径</strong>，即<code>/工程名路径</code>，对应<code>request.getContextPath()</code>的值</li>
</ul>
</li>
</ul>
<h3 id="查看Cookie">查看Cookie</h3>
<h4 id="Chrome">Chrome</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210529092527.png"
                      alt=""
                ></p>
<h4 id="Firefox">Firefox</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210529090349.png"
                      alt=""
                ></p>
<h3 id="Cookie应用">Cookie应用</h3>
<h4 id="免登录">免登录</h4>
<ul>
<li><strong>login.jsp</strong></li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;title&gt;登录页面&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;login&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    &lt;table&gt;</span><br><span class="line">    &lt;tr&gt; &lt;td&gt;用户名:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;username&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">    &lt;tr&gt; &lt;td&gt;密码:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;password&quot; name=&quot;password&quot;/&gt;&lt;/td&gt; &lt;/tr&gt;</span><br><span class="line">    &lt;tr&gt; &lt;td&gt; &lt;input type=&quot;checkbox&quot; name=&quot;check&quot; value=&quot;check&quot;/&gt;自动登录 &lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">	&lt;tr&gt; &lt;td colspan=&quot;2&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;登录&quot;/&gt; &lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>CheckUserServlet.java</strong></p>
<p>该实现利用了GET和POST本身的特性去划分了业务处理。GET应对了直接访问URL的情况，POST处理了常规登录。</p>
<blockquote>
<p>引用《JavaWeb编程技术》第3版(微课版)第四章用Cookie实现自动登录代码</p>
</blockquote>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/CheckUserServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheckUserServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    String message = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">        String value1 = <span class="string">&quot;&quot;</span>, value2 = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        Cookie cookie = <span class="keyword">null</span>;</span><br><span class="line">        Cookie[] cookies = request.getCookies();</span><br><span class="line">        <span class="keyword">if</span> (cookies != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cookies.length; i++) &#123;</span><br><span class="line">                cookie = cookies[i];</span><br><span class="line">                <span class="keyword">if</span> (cookie.getName().equals(<span class="string">&quot;username&quot;</span>))</span><br><span class="line">                    value1 = cookie.getValue();</span><br><span class="line">                <span class="keyword">if</span> (cookie.getName().equals(<span class="string">&quot;password&quot;</span>))</span><br><span class="line">                    value2 = cookie.getValue();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (value1.equals(<span class="string">&quot;admin&quot;</span>) &amp;&amp; value2.equals(<span class="string">&quot;admin&quot;</span>)) &#123;</span><br><span class="line">                message = <span class="string">&quot;欢迎您！&quot;</span> + value1 + <span class="string">&quot;再次登录该页面！&quot;</span>;</span><br><span class="line">                request.getSession().setAttribute(<span class="string">&quot;message&quot;</span>, message);</span><br><span class="line">                response.sendRedirect(<span class="string">&quot;welcome.jsp&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                response.sendRedirect(<span class="string">&quot;login.jsp&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            response.sendRedirect(<span class="string">&quot;login.jsp&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">        String username = request.getParameter(<span class="string">&quot;username&quot;</span>).trim();</span><br><span class="line">        String password = request.getParameter(<span class="string">&quot;password&quot;</span>).trim();</span><br><span class="line">        <span class="keyword">if</span> (!username.equals(<span class="string">&quot;admin&quot;</span>) || !password.equals(<span class="string">&quot;admin&quot;</span>)) &#123;</span><br><span class="line">            message = <span class="string">&quot;用户名或口令不正确，请重试！&quot;</span>;</span><br><span class="line">            request.getSession().setAttribute(<span class="string">&quot;message&quot;</span>, message);</span><br><span class="line">            response.sendRedirect(<span class="string">&quot;login.jsp&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 如果用户选中了“自动登录”复选框，向浏览器发送2个Cookie </span></span><br><span class="line">            <span class="keyword">if</span> ((request.getParameter(<span class="string">&quot;check&quot;</span>) != <span class="keyword">null</span>) &amp;&amp;</span><br><span class="line">                    (request.getParameter(<span class="string">&quot;check&quot;</span>).equals(<span class="string">&quot;check&quot;</span>))) &#123;</span><br><span class="line">                Cookie nameCookie = <span class="keyword">new</span> Cookie(<span class="string">&quot;username&quot;</span>, username);</span><br><span class="line">                Cookie pswdCookie = <span class="keyword">new</span> Cookie(<span class="string">&quot;password&quot;</span>, password);</span><br><span class="line">                nameCookie.setMaxAge(<span class="number">60</span> * <span class="number">60</span>);</span><br><span class="line">                pswdCookie.setMaxAge(<span class="number">60</span> * <span class="number">60</span>);</span><br><span class="line">                response.addCookie(nameCookie);</span><br><span class="line">                response.addCookie(pswdCookie);</span><br><span class="line">            &#125;</span><br><span class="line">            message = <span class="string">&quot;你已成功登录！&quot;</span>;</span><br><span class="line">            request.getSession().setAttribute(<span class="string">&quot;message&quot;</span>, message);</span><br><span class="line">            response.sendRedirect(<span class="string">&quot;welcome.jsp&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Session">Session</h2>
<h3 id="基本概念-9">基本概念</h3>
<p>上述可知，实现会话跟踪有多种方案。除Cookie外，还可以通过Servlet API 提供的<strong>Session接口</strong>标准来实现会话跟踪。有别于Cookie，Servlet API - Session的<strong>客户信息</strong>主要<strong>存放在服务器</strong>。因此Session能存放的信息更丰富，更抽象，如Servlet API 有专门的<strong>Session数据域</strong>，可以存放Object类型数据，而Cookie只能存放有限的键值对文本信息。小结如下：</p>
<ul>
<li>Servlet API Session 是<strong>一个接口</strong>，一种实现会话跟踪的技术规范之一</li>
<li>Session的客户信息主要<strong>存放在服务器</strong>中，常用于保存登陆后的信息</li>
<li>Servlet API Session是基于Cookie与Web容器结合实现的一种新机制</li>
</ul>
<blockquote>
<p>无特殊说明，以下Session均特指Servlet API 下的Session接口标准，非广义概念上的会话，因此从这个角度来说，Session是java特有的(JSESSIONID)。</p>
</blockquote>
<h3 id="Session机制">Session机制</h3>
<ul>
<li>
<p>当<strong>首次收到</strong>到客户端的请求时，服务器可通过调用<code>request.getSession(); </code>来<strong>创建Session对象</strong>，并将请求对象与其会话对象<strong>关联</strong>起来。最后响应时通过<strong>Cookie搭载</strong>这个会话的唯一标识id号一并发回给客户端。</p>
</li>
<li>
<p>Cookie搭载id：发回给客户端的会话标识符id，是通过Cookie返回的：键统一命名为：JSESSIONID，值则为：唯一的32位标识符。由于Servlet API 是通过规定了该Cookie的Expires/Max-Age为Session(-1)，因此当浏览器关闭时搭载JSESSIONID的Cookie将会在浏览器中被销毁。因此整个基于Servlet API - Session机制的生命周期对外表现出：”始于第一次请求，止于关闭浏览器“。Session会话就会终结(在客户端角度)，因为客户端已经无法通过JSESSIONID发回给服务器获取到于之对于的会话对象了。</p>
</li>
<li>
<p>当<strong>下一次</strong>客户端发送请求时，将通过Cookie携带这个会话id号一并发送请求给服务器。服务器收到请求后并获取会话id，并从服务器中匹配这个id，若匹配成功则返回这个请求与之关联的会话对象。此时可通<code>request.getSession();</code>获取到已经关联的会话对象。</p>
</li>
<li>
<p><strong>Session销毁时机及机制</strong>：</p>
<ul>
<li><strong>客户端角度</strong>：取决于搭载id的Cookie生命周期，默认-1，关闭浏览器后销毁(JSESSIONID)
<ul>
<li>由于客户端中搭载id的是Cookie，若修改JSESSIONID的存活时机则可实现Session的持久化</li>
</ul>
</li>
<li><strong>服务器角度</strong>：由于服务器无法得知客户端何时销毁，因此只能超时判断或后端代码控制。
<ul>
<li><strong>session超时控制</strong>：客户端<strong>两次请求</strong>的<strong>最大间隔时长</strong>，默认30分钟</li>
<li><strong>后端立即销毁</strong>：</li>
<li><strong>Web应用被卸载</strong>：清除所有资源。</li>
</ul>
</li>
</ul>
</li>
<li>
<p>由于保存用户信息及相关数据的会话对象是<strong>存放在服务器</strong>，从这个因素可凸显如下几个特征：</p>
<table>
<thead>
<tr>
<th></th>
<th>Session</th>
<th>Cookie</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>数据存储位置</strong></td>
<td>服务器</td>
<td>客户端</td>
</tr>
<tr>
<td><strong>数据类型</strong></td>
<td>Object</td>
<td>4KB文本键值对</td>
</tr>
<tr>
<td><strong>数据安全性</strong></td>
<td>高，主要信息在服务器，标识在客户端</td>
<td>低，全部信息在客户端</td>
</tr>
<tr>
<td><strong>生命周期</strong></td>
<td>客户端：默认-1，取决搭载Id的Cookie</td>
<td>自定义</td>
</tr>
<tr>
<td></td>
<td>服务器：默认无请求操作后30分钟、或代码控制立即失效</td>
<td></td>
</tr>
<tr>
<td><strong>常用领域</strong></td>
<td>在线用户跟踪(经一定操作后)</td>
<td>离线用户跟踪</td>
</tr>
<tr>
<td></td>
<td>如，用户登录后临时存放的信息(购物车)</td>
<td>离线自动登录</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>Session机制实现示意图</strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210529172703.png"
                      alt=""
                ></p>
</li>
</ul>
<h3 id="创建与获取">创建与获取</h3>
<p>当收到客户端的请求时，服务器可通过调用<code>request.getSession(); </code>来创建或获取Session对象。</p>
<ul>
<li><strong>首次调用</strong>：服务器<strong>创建</strong>会话对象，并将请求对象与其会话对象<strong>关联</strong>起来。并<strong>发回</strong>会话的唯一标识id号给客户端。id内容可通过<code>session.getId();</code>获取</li>
<li><strong>再次调用</strong>：获取请求对象与之关联的Session会话对象。</li>
<li><strong>isNew</strong>：通过调用<code>isNew();</code>方法可以判断这个会话是不是刚创建的（新的）
<ul>
<li>true：表示刚创建</li>
<li>false：表示获取之前创建</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><strong>com.website.servlet.SessionServlet.java</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">createOrGetSession</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    <span class="comment">//创建返回或获取Session会话对象</span></span><br><span class="line">    HttpSession session = req.getSession();</span><br><span class="line">    <span class="comment">//判断当前Session会话是否为新创建</span></span><br><span class="line">    <span class="keyword">boolean</span> isNew = session.isNew();</span><br><span class="line">    <span class="comment">//获取Session会话的唯一标识</span></span><br><span class="line">    String id = session.getId();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Session数据域">Session数据域</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">session.setAttribute(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;Object&quot;</span>);</span><br><span class="line">Object object = session.getAttribute(<span class="string">&quot;key&quot;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="销毁控制">销毁控制</h3>
<p>由于客户端取决于JSESSIONID的Cookie的MaxAge，因此这里所说的生命周期控制指<strong>服务器对Session的生命周期控制</strong>。服务器控制Session生命周期如下两种方法</p>
<h4 id="超时销毁">超时销毁</h4>
<ul>
<li><strong>setMaxInactiveInterval</strong>：通过该方法可以设置 Session 的超时时间（以秒为单位），超过指定的时长，Session 就会被服务器自动销毁。
<ul>
<li><strong>正数</strong>：超时时长，单位秒</li>
<li><strong>负数</strong>：永不超时(极少使用)</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session.setMaxInactiveInterval(<span class="number">3600</span>);<span class="comment">//最后一次请求1小时内无下次请求销毁</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>getMaxInactiveInterval</strong>：通过该方法可获取Session的超时机，默认30分钟</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> maxInactiveInterval = session.getMaxInactiveInterval();<span class="comment">//默认1800秒，即30分钟</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>修改当前Web-Session默认超时时间</strong>：</p>
<p>由于setMaxInactiveInterval只能对一个session对象设置超时时间，若想web项目中所有session的超时时间都改变，则需要改变<strong>web</strong>项目中的<strong>web.xml</strong>配置文件。web.xml修改后需<strong>重启才生效</strong>。</p>
<ul>
<li>WEB-INF/web.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 修改当前web工程session超时时间，web.xml修改需重新部署web生效 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">session-config</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">session-timeout</span>&gt;</span>30<span class="tag">&lt;/<span class="name">session-timeout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">session-config</span></span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>修改Tomcat-Session默认超时时间</strong></p>
<p>若想修改当前Tomcat默认的Session超时时间，即在此Tomcat上运行的所有Web项目Session默认超时时间都将会被改变，则需改变<strong>Tomcat</strong>中的web.xml配置文件。</p>
<ul>
<li>conf/web.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 修改当前Tomcat搭载的所有web工程session超时时间 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">session-config</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">session-timeout</span>&gt;</span>30<span class="tag">&lt;/<span class="name">session-timeout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">session-config</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>IDEA开发过程中整合Tomcat后的web.xml映射地址在项目部署打印 <strong>Using CATALINA_BASE</strong>路径的conf目录下。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210529170202.png"
                      alt=""
                ></p>
</li>
</ul>
</li>
</ul>
<h4 id="立即销毁">立即销毁</h4>
<ul>
<li><strong>invalidata</strong>：可调用该方法立即销毁一个session对象</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session.invalidate();<span class="comment">//立即销毁</span></span><br></pre></td></tr></table></figure>
<h2 id="小结">小结</h2>
<p>Cookie基于HTTP协议实现(包含Cookie)，Servlet API Session 基于Cookie与API实现</p>
<h1 id="过滤器">过滤器</h1>
<h2 id="基本概念-10">基本概念</h2>
<p>过滤器(Filter)是Web服务器<strong>三大组件之一</strong>(Servlet、Listener)，因此Filter是<strong>JavaEE的规范</strong>，即<strong>接口</strong>。过滤器的主要作用是<strong>拦截</strong>客户对某个资源的<strong>请求和响应</strong>。允许建立多个过滤器，形成<strong>过滤链</strong>。</p>
<p>常见应用场景：</p>
<ul>
<li>权限检查过滤器</li>
<li>登录检查过滤器</li>
<li>数据压缩过滤器</li>
<li>日记操作过滤器</li>
<li>事务管理过滤器</li>
<li>…</li>
</ul>
<hr>
<ul>
<li>过滤器作用示意图：</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210531223233.png"
                      style="zoom:80%;" /
                >
<h2 id="Filter接口实现">Filter接口实现</h2>
<p>由于Filter和Servlet都是javaEE的组件，规范接口。因此学习起来应存在有共性。</p>
<ol>
<li>
<p>编写一个类去<strong>实现Filter接口</strong></p>
</li>
<li>
<p>在doFilter()方法中编写过滤的处理或判断逻辑。</p>
<ul>
<li><code>return</code>语句或<code>从未调用过doFilter执行完代码</code>则拦截/结束</li>
<li>FilterChain对象的<code>doFilter()</code>方法放行</li>
</ul>
</li>
<li>
<p>在web.xml中配置<strong>声明拦截器</strong>并为其指定<strong>拦截范围</strong>(路径)，类似Servlet</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>AdminFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.website.servlet.AdminFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>AdminFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &#x27;/&#x27; 与Servlet配置一样，表示请求地址为：http://ip:port/工程路径/</span></span><br><span class="line"><span class="comment">              即映射到IDEA的web目录 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 拦截资源的作用范围(拦截路径) --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/admin/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<p>现如今有一应用场景，只有用户登录之后才能访问指定资源(admin目录下的web资源)。此时可以通过使用Filter过滤器实现请求资源的拦截判断处理。</p>
<p><strong>注意</strong>：测试过程中若访问过静态资源后，非登录状态下仍能访问资源很可能是<strong>静态资源缓存问题</strong>，清除一下浏览器缓存再次尝试即可。</p>
<ul>
<li>
<p><strong>文件目录情况</strong>：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210531214723.png"
                      alt=""
                ></p>
</li>
<li>
<p><strong>login.html</strong></p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/14_Filter/userServlet&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">        用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;admin&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">br</span>&gt;</span></span><br><span class="line">        密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;登录&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">br</span>&gt;</span></span><br><span class="line">    访问登录后的资源:</span><br><span class="line">    <span class="tag">&lt;/<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;admin/shoppingCart.html&quot;</span>&gt;</span>shoppingCart<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;admin/testImg.jpg&quot;</span>&gt;</span>testImg<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>UserServlet.java</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.website.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yhd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2021-05-31 21:19</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        req.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        resp.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        String username = req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        String password = req.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;username = &quot;</span> + username);</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;admin&quot;</span>.equals(username) &amp;&amp; <span class="string">&quot;password&quot;</span>.equals(password))&#123;</span><br><span class="line">            req.getSession().setAttribute(<span class="string">&quot;user&quot;</span>,username);</span><br><span class="line">            resp.sendRedirect(req.getContextPath() + <span class="string">&quot;/login.html&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;登录失败&lt;/br&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>AdminFilter.java</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.website.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yhd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2021-05-31 21:29</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AdminFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        HttpServletRequest request = (HttpServletRequest) servletRequest;</span><br><span class="line">        HttpServletResponse response = (HttpServletResponse) servletResponse;</span><br><span class="line"></span><br><span class="line">        HttpSession session = request.getSession();</span><br><span class="line">        String user = (String) session.getAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(user == <span class="keyword">null</span>)&#123;<span class="comment">//未登录，拦截，并跳转到登录页面提示登录</span></span><br><span class="line">            response.sendRedirect(request.getContextPath() + <span class="string">&quot;/login.html&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;<span class="comment">//登录成功，放行</span></span><br><span class="line">            filterChain.doFilter(servletRequest,servletResponse);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>web.xml</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>AdminFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.website.servlet.AdminFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>AdminFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &#x27;/&#x27; 与Servlet配置一样，表示请求地址为：http://ip:port/工程路径/</span></span><br><span class="line"><span class="comment">              即映射到IDEA的web目录 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 拦截资源的作用范围(拦截路径) --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/admin/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>UserServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.website.servlet.UserServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>UserServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/userServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Filter生命周期">Filter生命周期</h2>
<h3 id="生命周期">生命周期</h3>
<p>Filter 的生命周期包含几个方法：</p>
<ol>
<li>
<p><strong>构造器方法</strong></p>
</li>
<li>
<p>**init 初始化方法 **(FilterConfig filterConfig)</p>
<hr>
<ul>
<li>在 web 工程启动的时候执行1，2 步骤（Filter 已经创建）</li>
</ul>
</li>
<li>
<p>**doFilter过滤方法 **(FilterChain filterChain)</p>
<ul>
<li>每次拦截到请求，就会执行</li>
</ul>
</li>
<li>
<p><strong>destroy销毁方法</strong></p>
<ul>
<li>停止web工程的时候，就会执行</li>
</ul>
</li>
</ol>
<h3 id="FilterConfig">FilterConfig</h3>
<p>在Filter生命周期的<strong>init</strong>方法中，含有一个传入对象FilterConfig对象。封装了当前Filter<strong>配置文件</strong>(web.xml)的<strong>配置信息</strong>。类似ServletConfig</p>
<ul>
<li>获取Filter在配置中的名称filter-name的内容：</li>
<li>获取Filter在配置的init-param初始化参数</li>
<li>获取ServletContext 对象</li>
</ul>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">filterConfig.getFilterName();</span><br><span class="line"></span><br><span class="line">filterConfig.getInitParameter(&quot;key&quot;);</span><br><span class="line">filterConfig.getInitParameterNames();</span><br><span class="line"></span><br><span class="line">filterConfig.getServletContext();</span><br></pre></td></tr></table></figure>
<h3 id="FilterChain">FilterChain</h3>
<p>FilterChain译为<strong>过滤链</strong>，即多个过滤器组合起来的过滤序列，简称过滤链。</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210531223024.png"
                      style="zoom:80%;" /
                >
<h4 id="doFilter">doFilter</h4>
<p>FilterChain对象只有一个方法，就是doFilter()，基本功能描述如下：</p>
<ul>
<li>
<p>当只有一个过滤器，则直接放行，执行目标请求资源，否则执行下一个Filter过滤器</p>
</li>
<li>
<p>doFilter()：之上的代码为当前请求拦截处理代码，doFilter()之下为响应拦截处理代码。</p>
<blockquote>
<p>原理在于doFilter()实际上是内嵌调用目标请求资源或下一个过滤器，以下解释</p>
</blockquote>
</li>
</ul>
<h2 id="过滤链的使用">过滤链的使用</h2>
<h3 id="执行特点">执行特点</h3>
<ol>
<li>doFilter的调用逻辑，实际上是包裹主目标请求资源，过滤链即多个过滤器的内嵌式调用</li>
<li>一个请求中，所有的<strong>Filter</strong>和<strong>目标资源</strong>，<strong>默认</strong>都执行在<strong>同一个线程</strong>中</li>
<li>多个Filter公同执行时，都使用<strong>同一个ServletRequest对象</strong>(从doFilter方法中可知，类转发操作)</li>
</ol>
<h3 id="调用逻辑">调用逻辑</h3>
<p>一开始提及过，Filter不仅能够拦截过滤对某个资源的<strong>请求操作</strong>，还能拦截过滤<strong>响应操作</strong>。其中doFilter()：之上的代码为当前请求拦截处理代码，doFilter()之下为响应拦截处理代码。</p>
<ul>
<li>
<p>原理：chain.doFilter()方法是将<strong>Servlet包裹起来</strong>进行<strong>内嵌调用</strong>的。(从Filter事务管理也能体会到)</p>
</li>
<li>
<p>当多个过滤器组合工作时，形成的过滤链工作流程如下：</p>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210531224212.png"
                      alt=""
                ></p>
<ul>
<li>javaEE三大组件调用逻辑如下：</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210602163904.png"
                      alt=""
                ></p>
<h3 id="过滤链的配置">过滤链的配置</h3>
<p>过滤链的配置实际上就是多个的Filter配置，真正需要注意配置的是过滤链中<strong>过滤器的执行顺序配置</strong>：</p>
<ul>
<li>多个Filter组成的过滤链中Filter的执行顺序取决于：<strong>web.xml中配置</strong>的上下<strong>位置顺序</strong></li>
</ul>
<h2 id="Filter实际使用">Filter实际使用</h2>
<h3 id="概念">概念</h3>
<p>类似Servlet组件，为了开发的便利与高效也会进行一系列的<strong>优化与封装</strong>，Filter也有如：</p>
<ul>
<li>Servlet ——&gt; GenericServlet ——&gt; HttpServlet</li>
<li><strong>Filter</strong>   ——&gt;<strong>GenericFilter</strong>   ——&gt; <strong>HttpFilter</strong></li>
</ul>
<hr>
<table>
<thead>
<tr>
<th>接口</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>GenericFilter</strong></td>
<td>该<strong>抽象类</strong>，<strong>实现</strong>了<strong>FilterConfig</strong>接口的方法和<strong>Filter</strong>接口的Init方法</td>
</tr>
<tr>
<td><strong>HttpFilter</strong></td>
<td>该<strong>抽象类</strong>，<strong>继承</strong>了<strong>GenericFilter</strong>类，实现了针对<strong>HTTP</strong>协议的过滤器</td>
</tr>
</tbody>
</table>
<p><strong>结论</strong>：因此在实际Web开发中，直接通过<strong>继承HttpFilter</strong>来使用Filter过滤器。</p>
<blockquote>
<ul>
<li>注意：index首页通过<strong>请求转发</strong>到的页面<strong>不能是被过滤器拦截的页面</strong>，否则会进行转发拦截死循环</li>
<li>若首页转发的页面受拦截器作用，则只能用重定向</li>
</ul>
</blockquote>
<h3 id="使用步骤">使用步骤</h3>
<ol>
<li>
<p>编写一个类去<strong>继承HttpFilter抽象类</strong></p>
</li>
<li>
<p>实现doFilter()方法，并在其中编写过滤的处理或判断逻辑。</p>
<ul>
<li><code>return</code>语句或<code>从未调用过doFilter执行完代码</code>则表示拦截/结束</li>
<li>FilterChain对象的<code>doFilter()</code>方法放行</li>
</ul>
</li>
<li>
<p>在web.xml中配置<strong>声明拦截器</strong>并为其指定<strong>拦截范围</strong>(路径)，类似Servlet</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>AdminFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.website.servlet.AdminFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>AdminFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &#x27;/&#x27; 与Servlet配置一样，表示请求地址为：http://ip:port/工程路径/</span></span><br><span class="line"><span class="comment">              即映射到IDEA的web目录 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 拦截资源的作用范围(拦截路径) --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/admin/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>拦截路径/访问的几种配置，匹配的操作：注意，Filter 过滤器它<strong>只关心</strong>请求的<strong>地址是否匹配</strong>，<strong>不关心</strong>请求的<strong>资源是否存在</strong>！！</p>
<ol>
<li>
<p><strong>精确匹配</strong>：</p>
<ul>
<li>
<p>单精确匹配：</p>
<ul>
<li>请求地址必须为：<code>http://ip:port/工程路径/target.jsp</code></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/target.jsp<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>多精确匹配：</p>
<ul>
<li>请求地址必须为：<code>http://ip:port/工程路径/index.html</code>或<code>http://ip:port/工程路径/test.jsp</code></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>AdminFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/pages/index.html<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/pages/test.jsp<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p><strong>目录匹配</strong>：</p>
<ul>
<li>请求地址必须为：<code>http://ip:port/工程路径/admin/*</code></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/admin/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>后缀名匹配</strong>：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.html<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">以上配置的路径，表示请求地址必须以.html 结尾才会拦截到</span><br><span class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">以上配置的路径，表示请求地址必须以.do 结尾才会拦截到</span><br><span class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.action<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">以上配置的路径，表示请求地址必须以.action 结尾才会拦截到</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<h1 id="web-xml-2">web.xml</h1>
<h2 id="基本概念-11">基本概念</h2>
<ul>
<li>在Servlet 3.0之前，每个Web应用程序都必须有一个部署描述文件（web.xml），部署描述文件（Deployment Descriptor，简称DD文件）。它用来部署Web应用中所包含的组件，如Servlet等。</li>
<li>从Servlet 3.0开始，有些组件<strong>可使用注解配置</strong>，但还有些内容（安全配置等）需要使用部署描述文件配置。</li>
<li>Web应用启动时，容器读取该文件，对应用程序配置，所以有时也将该文件称为配置文件。</li>
</ul>
<h2 id="注解使用">注解使用</h2>
<ul>
<li>注解属于javax.servlet.annotation包，因此在定义Servlet时应使用下列语句导入。
<ul>
<li><code>import javax.servlet.annotation.WebServlet;</code></li>
</ul>
</li>
</ul>
<p>注解代码示例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(name = &quot;testServlet&quot;,urlPatterns = &#123;&quot;/testServlet&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;注解注册servlet&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>等价与以下的web.xml配置</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>TestServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.website.servlet.TestServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>TestServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/testServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="启动页设置">启动页设置</h2>
<ul>
<li>可配置多个，服务器启动后逐一匹配至可访问资源展示为启动页</li>
<li>若均不匹配返回404错误</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>/index.html<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>/index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>/test_welcome.html<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="错误页配置">错误页配置</h2>
<ul>
<li>配置错误页面，由Tomcat容器进行统一的错误页面跳转</li>
<li>配置错误信息的方式有两种：HTTP响应码、java异常类全类名</li>
<li>使用前提是，Tomcat容器必须能检测到这些异常，有些默认能直接检测，有些异常抛出
<ul>
<li>404：无需代码干涉，Tomcat容器能直接首先检测到</li>
<li>500：程序内部错误，一般编程人员没有进行异常捕获，异常最终是能够传递给Tomcat的，但若代码捕获过异常，又想依赖于Tomcat错误页面检测，则需再把异常抛出来。</li>
</ul>
</li>
</ul>
<h3 id="HTTP响应码匹配">HTTP响应码匹配</h3>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 通过匹配HTTP响应代码跳转错误页面 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">error-page</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 404错误可被Tomcat直接捕获，不或访问到web程序，可直接配置生效 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">error-code</span>&gt;</span>404<span class="tag">&lt;/<span class="name">error-code</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">location</span>&gt;</span>/error/error_400.html<span class="tag">&lt;/<span class="name">location</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">error-page</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">error-page</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 设置HTTP错误代码，500即Tomcat发现内部错误(异常)时调用指定页面 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 对于500内部异常错误，需Tomcat捕获到程序异常才能生效 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">error-code</span>&gt;</span>500<span class="tag">&lt;/<span class="name">error-code</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">location</span>&gt;</span>/error/error_500.html<span class="tag">&lt;/<span class="name">location</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">error-page</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="异常类类型匹配">异常类类型匹配</h3>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">error-page</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exception-type</span>&gt;</span>java.lang.RuntimeException<span class="tag">&lt;/<span class="name">exception-type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">location</span>&gt;</span>/error/error_500.html<span class="tag">&lt;/<span class="name">location</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">error-page</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="xml解析技术">xml解析技术</h1>
<h2 id="Dom4j解析技术">Dom4j解析技术</h2>
<p>dom4j 是优秀的第三方解析XML类库。需要使用 dom4j 就需要到 dom4j 官网下载 dom4j 的 jar 包。具体操作可以查看官方文档，或者下载离线jar包后查看离线帮助文档，如下</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://gitee.com/yihangdeng/blogImage/raw/master/img/20210324165652.png"
                      alt=""
                ></p>
<h2 id="Dom4j编程步骤">Dom4j编程步骤</h2>
<ol>
<li>添加jar包，如 dom4j-1.6.1.jar</li>
<li>通过创建<strong>SAXReader</strong>对象调用read方法<strong>加载xml文件</strong>获取<strong>Document</strong>对象</li>
<li>通过Document对象获取对应的xml对象的<strong>根元素</strong></li>
<li>通过根元素调用element(标签名)或elements(标签名)方法获取对应的xml标签对象或集合</li>
<li>获得标签对象后通过调用对应方法获取属性，或子标签。具体演示如下</li>
</ol>
<hr>
<ul>
<li>
<p>创建实例XML文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">books</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">book</span> <span class="attr">sn</span>=<span class="string">&quot;SN12341232&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>effective of java<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">price</span>&gt;</span>9.9<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">author</span>&gt;</span>刘德华<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">book</span> <span class="attr">sn</span>=<span class="string">&quot;SN12341231&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>深入了解虚拟机<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">price</span>&gt;</span>99.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">author</span>&gt;</span>陈慧娴<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">books</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>编写标签对应的java类，并封装成java类，输出所有属性。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String book;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Double price;</span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line">    <span class="comment">//....建立构造，重写toString等基操</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> <span class="keyword">throws</span> DocumentException </span>&#123;</span><br><span class="line">    <span class="comment">//1、通过创建SAXReader对象调用read方法加载xml文件获取Document对象</span></span><br><span class="line">    SAXReader reader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">    Document read = reader.read(<span class="string">&quot;src/books.xml&quot;</span>);</span><br><span class="line">    <span class="comment">//2、通过Document对象获取对应的xml对象的根元素</span></span><br><span class="line">    Element rootElement = read.getRootElement();</span><br><span class="line">    <span class="comment">//3、通过根元素获取对应的xml标签对象,主要使用element()与elements()方法</span></span><br><span class="line">    List&lt;Element&gt; books = rootElement.elements(<span class="string">&quot;book&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(Element book : books)&#123;</span><br><span class="line">        <span class="comment">//1、获取当前标签属性</span></span><br><span class="line">        String sn = book.attributeValue(<span class="string">&quot;sn&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2、获取book标签下name、price、author标签的值</span></span><br><span class="line">        <span class="comment">//方式1：通过再获取子标签的element对象,再调用getText()</span></span><br><span class="line">        String name = book.element(<span class="string">&quot;name&quot;</span>).getText();</span><br><span class="line">        <span class="comment">//方式2：直接通过</span></span><br><span class="line">        String author = book.elementText(<span class="string">&quot;author&quot;</span>);</span><br><span class="line">        Double price = Double.parseDouble(book.elementText(<span class="string">&quot;price&quot;</span>));</span><br><span class="line">        System.out.println(<span class="keyword">new</span> Book(sn,name,price,author));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*输出如下</span></span><br><span class="line"><span class="comment">Book&#123;book=&#x27;SN12341232&#x27;, name=&#x27;effective of java&#x27;, price=9.9, author=&#x27;刘德华&#x27;&#125;</span></span><br><span class="line"><span class="comment">Book&#123;book=&#x27;SN12341231&#x27;, name=&#x27;深入了解虚拟机&#x27;, price=99.99, author=&#x27;陈慧娴&#x27;&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
</li>
</ul>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>Post title：JavaWeb编程技术</li>
        <li>Post author：yhd</li>
        <li>Create time：2021-06-02 19:54:32</li>
        <li>
            Post link：https://keep.xpoet.cn/2021/06/02/JavaWeb编程技术/
        </li>
        <li>
            Copyright Notice：All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.
        </li>
    </ul>
</div>

            </div>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2021/06/03/%E5%8E%9F%E7%94%9FWeb%E6%8A%80%E6%9C%AF%E6%96%B9%E6%A1%88/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">原生Web技术方案</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2021/05/24/Java%E8%AF%AD%E8%A8%80PV%E6%93%8D%E4%BD%9C%E5%88%9D%E4%BD%BF%E7%94%A8/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Java语言PV操作初使用</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>&nbsp;-&nbsp;
            
            2021&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">yhd</a>
        </div>
        
            <script async  src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.1</a>
        </div>
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#JavaWeb%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0"><span class="nav-number">1.</span> <span class="nav-text">JavaWeb技术概述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%87%E7%BB%B4%E7%BD%91"><span class="nav-number">1.1.</span> <span class="nav-text">万维网</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Web%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="nav-number">1.1.1.</span> <span class="nav-text">Web服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">1.1.1.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Tomcat-Sevlet-JSP-JDK%E7%89%88%E6%9C%AC%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB"><span class="nav-number">1.1.1.2.</span> <span class="nav-text">Tomcat&amp;Sevlet&#x2F;JSP&#x2F;JDK版本对应关系</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E4%BB%96Web%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="nav-number">1.1.1.3.</span> <span class="nav-text">其他Web服务器</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Web%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="nav-number">1.1.2.</span> <span class="nav-text">Web客户端</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE"><span class="nav-number">1.1.3.</span> <span class="nav-text">通讯协议</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#HTTP"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">HTTP</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#URL-URI"><span class="nav-number">1.1.3.2.</span> <span class="nav-text">URL&amp;URI</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%8A%B6%E6%80%81%E7%A0%81"><span class="nav-number">1.1.3.3.</span> <span class="nav-text">状态码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%B5%84%E6%BA%90"><span class="nav-number">1.2.</span> <span class="nav-text">服务器资源</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B5%84%E6%BA%90%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.2.1.</span> <span class="nav-text">资源类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E6%96%87%E6%A1%A3%E6%8A%80%E6%9C%AF"><span class="nav-number">1.2.2.</span> <span class="nav-text">动态文档技术</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Tomcat"><span class="nav-number">2.</span> <span class="nav-text">Tomcat</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85"><span class="nav-number">2.1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E4%BB%8B%E7%BB%8D"><span class="nav-number">2.2.</span> <span class="nav-text">目录介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E4%B8%8E%E5%85%B3%E9%97%AD"><span class="nav-number">2.3.</span> <span class="nav-text">启动与关闭</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E6%96%B9%E5%BC%8F"><span class="nav-number">2.3.1.</span> <span class="nav-text">启动方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%97%AD%E6%96%B9%E5%BC%8F"><span class="nav-number">2.3.2.</span> <span class="nav-text">关闭方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF"><span class="nav-number">2.3.3.</span> <span class="nav-text">常见错误</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E9%BB%98%E8%AE%A4%E7%AB%AF%E5%8F%A3%E5%8F%B7"><span class="nav-number">2.4.</span> <span class="nav-text">修改默认端口号</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web%E5%B7%A5%E7%A8%8B%E9%83%A8%E7%BD%B2"><span class="nav-number">3.</span> <span class="nav-text">Web工程部署</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E9%83%A8%E7%BD%B2"><span class="nav-number">3.1.</span> <span class="nav-text">静态资源部署</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%B5%84%E6%BA%90%E9%83%A8%E7%BD%B2"><span class="nav-number">3.2.</span> <span class="nav-text">动态资源部署</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Web%E5%B7%A5%E7%A8%8B%E7%9B%AE%E5%BD%95"><span class="nav-number">3.2.1.</span> <span class="nav-text">Web工程目录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4%E5%A6%82%E4%B8%8B"><span class="nav-number">3.2.2.</span> <span class="nav-text">步骤如下</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%8A%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E7%A8%8B%E9%83%A8%E7%BD%B2"><span class="nav-number">3.2.3.</span> <span class="nav-text">半自动化工程部署</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E5%B7%A5%E7%A8%8B%E5%8F%8A%E9%A6%96%E9%A1%B5"><span class="nav-number">3.3.</span> <span class="nav-text">默认工程及首页</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#IDEA%E6%95%B4%E5%90%88Tomcat"><span class="nav-number">4.</span> <span class="nav-text">IDEA整合Tomcat</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B4%E5%90%88Tomcat%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="nav-number">4.1.</span> <span class="nav-text">整合Tomcat服务器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%8A%A8%E6%80%81Web%E5%B7%A5%E7%A8%8B"><span class="nav-number">4.2.</span> <span class="nav-text">创建动态Web工程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8Web%E5%B7%A5%E7%A8%8B"><span class="nav-number">4.3.</span> <span class="nav-text">启动Web工程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IDEA%E4%B8%AD%E4%BF%AE%E6%94%B9%E7%AB%AF%E5%8F%A3%E5%8F%B7"><span class="nav-number">4.4.</span> <span class="nav-text">IDEA中修改端口号</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E8%B5%84%E6%BA%90%E7%83%AD%E9%83%A8%E7%BD%B2"><span class="nav-number">4.5.</span> <span class="nav-text">配置资源热部署</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IDEA%E5%88%9B%E5%BB%BAServlet"><span class="nav-number">4.6.</span> <span class="nav-text">IDEA创建Servlet</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IDEA%E7%9A%84%E9%83%A8%E7%BD%B2%E9%80%BB%E8%BE%91"><span class="nav-number">4.7.</span> <span class="nav-text">IDEA的部署逻辑</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Servlet"><span class="nav-number">5.</span> <span class="nav-text">Servlet</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Servlet%E5%8F%8A%E5%85%B6%E5%AE%B9%E5%99%A8"><span class="nav-number">5.1.</span> <span class="nav-text">Servlet及其容器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Servlet%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0"><span class="nav-number">5.2.</span> <span class="nav-text">Servlet接口实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Servlet%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">5.3.</span> <span class="nav-text">Servlet生命周期</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E6%8E%A5%E5%8F%A3%E4%B8%8E%E7%B1%BB"><span class="nav-number">5.3.1.</span> <span class="nav-text">相关接口与类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ServletConfig"><span class="nav-number">5.4.</span> <span class="nav-text">ServletConfig</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-2"><span class="nav-number">5.4.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8"><span class="nav-number">5.4.2.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#API"><span class="nav-number">5.4.3.</span> <span class="nav-text">API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ServletContext"><span class="nav-number">5.4.4.</span> <span class="nav-text">ServletContext</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-3"><span class="nav-number">5.4.4.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8-2"><span class="nav-number">5.4.4.2.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#API-2"><span class="nav-number">5.4.4.3.</span> <span class="nav-text">API</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ServletRequest"><span class="nav-number">5.5.</span> <span class="nav-text">ServletRequest</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-4"><span class="nav-number">5.5.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8-3"><span class="nav-number">5.5.2.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#API-3"><span class="nav-number">5.5.3.</span> <span class="nav-text">API</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="nav-number">5.5.3.1.</span> <span class="nav-text">示例代码</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2"><span class="nav-number">5.5.3.1.1.</span> <span class="nav-text">前端页面</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E5%B1%95%E7%A4%BA"><span class="nav-number">5.5.3.1.1.1.</span> <span class="nav-text">前端页面展示</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E6%BA%90%E7%A0%81"><span class="nav-number">5.5.3.1.1.2.</span> <span class="nav-text">前端页面源码</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E6%A0%BC%E5%BC%8F"><span class="nav-number">5.5.3.1.1.3.</span> <span class="nav-text">参数传递格式</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#web-xml"><span class="nav-number">5.5.3.1.2.</span> <span class="nav-text">web.xml</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#LoginServlet-java"><span class="nav-number">5.5.3.1.3.</span> <span class="nav-text">LoginServlet.java</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ServletResponse"><span class="nav-number">5.6.</span> <span class="nav-text">ServletResponse</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8-4"><span class="nav-number">5.6.1.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#API-4"><span class="nav-number">5.6.2.</span> <span class="nav-text">API</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GenericServlet"><span class="nav-number">5.7.</span> <span class="nav-text">GenericServlet</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82%E9%A9%B1%E5%8A%A8"><span class="nav-number">5.7.1.</span> <span class="nav-text">需求驱动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3%E6%80%9D%E8%B7%AF"><span class="nav-number">5.7.2.</span> <span class="nav-text">解决思路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90"><span class="nav-number">5.7.3.</span> <span class="nav-text">问题分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GenericServlet-2"><span class="nav-number">5.7.4.</span> <span class="nav-text">GenericServlet</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86"><span class="nav-number">5.8.</span> <span class="nav-text">HTTP请求处理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP%E8%AF%B7%E6%B1%82"><span class="nav-number">5.8.1.</span> <span class="nav-text">HTTP请求</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#GET"><span class="nav-number">5.8.1.1.</span> <span class="nav-text">GET</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E6%A0%BC%E5%BC%8F"><span class="nav-number">5.8.1.1.1.</span> <span class="nav-text">请求格式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0%E6%A0%BC%E5%BC%8F"><span class="nav-number">5.8.1.1.2.</span> <span class="nav-text">传递参数格式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#GET%E8%AF%B7%E6%B1%82%E7%B1%BB%E5%9E%8B%E6%93%8D%E4%BD%9C"><span class="nav-number">5.8.1.1.3.</span> <span class="nav-text">GET请求类型操作</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%89%B9%E7%82%B9"><span class="nav-number">5.8.1.1.4.</span> <span class="nav-text">特点</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#POST"><span class="nav-number">5.8.1.2.</span> <span class="nav-text">POST</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E6%A0%BC%E5%BC%8F-2"><span class="nav-number">5.8.1.2.1.</span> <span class="nav-text">请求格式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#POST%E8%AF%B7%E6%B1%82%E7%B1%BB%E5%9E%8B%E6%93%8D%E4%BD%9C"><span class="nav-number">5.8.1.2.2.</span> <span class="nav-text">POST请求类型操作</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP%E5%93%8D%E5%BA%94"><span class="nav-number">5.8.2.</span> <span class="nav-text">HTTP响应</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%93%8D%E5%BA%94%E6%A0%BC%E5%BC%8F"><span class="nav-number">5.8.2.1.</span> <span class="nav-text">响应格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84%E5%93%8D%E5%BA%94%E7%A0%81"><span class="nav-number">5.8.2.2.</span> <span class="nav-text">常用的响应码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MIME%E7%B1%BB%E5%9E%8B%E8%AF%B4%E6%98%8E"><span class="nav-number">5.8.3.</span> <span class="nav-text">MIME类型说明</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HttpServlet"><span class="nav-number">5.9.</span> <span class="nav-text">HttpServlet</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HttpServletRequest-Response%E5%88%9D%E8%B0%88"><span class="nav-number">5.9.1.</span> <span class="nav-text">HttpServletRequest&#x2F;Response初谈</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E6%B1%82%E9%A9%B1%E5%8A%A8-2"><span class="nav-number">5.9.1.1.</span> <span class="nav-text">需求驱动</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">5.9.1.2.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96HttpServletRequest-Response"><span class="nav-number">5.9.1.3.</span> <span class="nav-text">获取HttpServletRequest&#x2F;Response</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82%E9%A9%B1%E5%8A%A8-3"><span class="nav-number">5.9.2.</span> <span class="nav-text">需求驱动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HttpServlet-2"><span class="nav-number">5.9.3.</span> <span class="nav-text">HttpServlet</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HttpServletRequest"><span class="nav-number">5.10.</span> <span class="nav-text">HttpServletRequest</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#API-5"><span class="nav-number">5.10.1.</span> <span class="nav-text">API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81"><span class="nav-number">5.10.2.</span> <span class="nav-text">请求中文乱码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#GET%E8%AF%B7%E6%B1%82"><span class="nav-number">5.10.2.1.</span> <span class="nav-text">GET请求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#POST%E8%AF%B7%E6%B1%82"><span class="nav-number">5.10.2.2.</span> <span class="nav-text">POST请求</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HttpServletResponse"><span class="nav-number">5.11.</span> <span class="nav-text">HttpServletResponse</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#API-6"><span class="nav-number">5.11.1.</span> <span class="nav-text">API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%93%8D%E5%BA%94%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81"><span class="nav-number">5.11.2.</span> <span class="nav-text">响应中文乱码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B9%B1%E7%A0%81%E7%9A%84%E5%8E%9F%E5%9B%A0"><span class="nav-number">5.11.2.1.</span> <span class="nav-text">乱码的原因</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A8%E8%8D%90%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="nav-number">5.11.2.2.</span> <span class="nav-text">推荐解决方案</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Servlet%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="nav-number">5.12.</span> <span class="nav-text">Servlet体系结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E5%8C%96Servlet%E5%BC%80%E5%8F%91%E5%B1%82%E9%9D%A2"><span class="nav-number">5.12.1.</span> <span class="nav-text">优化Servlet开发层面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86%E5%B1%82%E9%9D%A2"><span class="nav-number">5.12.2.</span> <span class="nav-text">请求处理层面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%8C%E6%95%B4%E7%BB%93%E6%9E%84%E4%BD%93%E7%B3%BB"><span class="nav-number">5.12.3.</span> <span class="nav-text">完整结构体系</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web%E8%B7%AF%E5%BE%84"><span class="nav-number">6.</span> <span class="nav-text">Web路径</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%9D%E5%AF%B9%E4%B8%8E%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84"><span class="nav-number">6.1.</span> <span class="nav-text">绝对与相对路径</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E2%80%98-%E2%80%99-%E6%96%9C%E6%9D%A0%E7%9A%84%E4%B8%8D%E5%90%8C%E5%90%AB%E4%B9%89"><span class="nav-number">6.2.</span> <span class="nav-text">‘&#x2F;’ 斜杠的不同含义</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#JSP"><span class="nav-number">7.</span> <span class="nav-text">JSP</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9C%80%E6%B1%82%E9%A9%B1%E5%8A%A8-4"><span class="nav-number">7.1.</span> <span class="nav-text">需求驱动</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JSP%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">7.2.</span> <span class="nav-text">JSP基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HelloWorld"><span class="nav-number">7.3.</span> <span class="nav-text">HelloWorld</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JSP%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86"><span class="nav-number">7.4.</span> <span class="nav-text">JSP运行原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86"><span class="nav-number">7.4.1.</span> <span class="nav-text">运行原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JSP%E7%9A%84Servlet%E6%BA%90%E7%A8%8B%E5%BA%8F"><span class="nav-number">7.4.2.</span> <span class="nav-text">JSP的Servlet源程序</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BA%90%E7%A8%8B%E5%BA%8F%E8%B7%AF%E5%BE%84"><span class="nav-number">7.4.2.1.</span> <span class="nav-text">源程序路径</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JSP%E6%9C%AC%E8%B4%A8"><span class="nav-number">7.4.3.</span> <span class="nav-text">JSP本质</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9%E5%A4%A7%E9%9A%90%E5%90%AB%E5%AF%B9%E8%B1%A1"><span class="nav-number">7.5.</span> <span class="nav-text">9大隐含对象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JSP%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="nav-number">7.6.</span> <span class="nav-text">JSP基本语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E5%85%83%E7%B4%A0"><span class="nav-number">7.6.1.</span> <span class="nav-text">模板元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E9%87%8A"><span class="nav-number">7.6.2.</span> <span class="nav-text">注释</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JSP%E8%84%9A%E6%9C%AC"><span class="nav-number">7.6.3.</span> <span class="nav-text">JSP脚本</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#JSP%E5%B0%8F%E8%84%9A%E6%9C%AC"><span class="nav-number">7.6.3.1.</span> <span class="nav-text">JSP小脚本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSP%E5%A3%B0%E6%98%8E"><span class="nav-number">7.6.3.2.</span> <span class="nav-text">JSP声明</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JSP%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">7.6.4.</span> <span class="nav-text">JSP表达式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JSP%E4%B8%8EHTML%E4%BA%92%E5%B5%8C"><span class="nav-number">7.6.5.</span> <span class="nav-text">JSP与HTML互嵌</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JSP%E6%8C%87%E4%BB%A4"><span class="nav-number">7.6.6.</span> <span class="nav-text">JSP指令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#page%E6%8C%87%E4%BB%A4"><span class="nav-number">7.6.6.1.</span> <span class="nav-text">page指令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#include%E6%8C%87%E4%BB%A4"><span class="nav-number">7.6.6.2.</span> <span class="nav-text">include指令</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JSP%E5%8A%A8%E4%BD%9C"><span class="nav-number">7.6.7.</span> <span class="nav-text">JSP动作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4%E5%A4%A7%E5%9F%9F%E5%AF%B9%E8%B1%A1"><span class="nav-number">7.7.</span> <span class="nav-text">4大域对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E7%94%A8%E6%96%B9%E6%B3%95"><span class="nav-number">7.7.1.</span> <span class="nav-text">通用方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E4%BD%9C%E7%94%A8%E8%8C%83%E5%9B%B4"><span class="nav-number">7.7.2.</span> <span class="nav-text">属性作用范围</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%87%8D%E5%AE%9A%E5%90%91"><span class="nav-number">7.8.</span> <span class="nav-text">转发与重定向</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E8%BD%AC%E5%8F%91"><span class="nav-number">7.8.1.</span> <span class="nav-text">请求转发</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-5"><span class="nav-number">7.8.1.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4"><span class="nav-number">7.8.1.2.</span> <span class="nav-text">实现步骤</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E7%9A%84%E9%87%8D%E5%AE%9A%E5%90%91"><span class="nav-number">7.8.2.</span> <span class="nav-text">请求的重定向</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-6"><span class="nav-number">7.8.2.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4-2"><span class="nav-number">7.8.2.2.</span> <span class="nav-text">实现步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%B9%E5%BC%8F1"><span class="nav-number">7.8.2.2.1.</span> <span class="nav-text">方式1</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%B9%E5%BC%8F2"><span class="nav-number">7.8.2.2.2.</span> <span class="nav-text">方式2</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#out-getWriter"><span class="nav-number">7.9.</span> <span class="nav-text">out&amp;getWriter()</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF%E5%A4%8D%E7%8E%B0"><span class="nav-number">7.9.1.</span> <span class="nav-text">场景复现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90"><span class="nav-number">7.9.2.</span> <span class="nav-text">原理分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95"><span class="nav-number">7.9.3.</span> <span class="nav-text">测试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E8%AE%BA"><span class="nav-number">7.9.4.</span> <span class="nav-text">结论</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#write-print"><span class="nav-number">7.9.5.</span> <span class="nav-text">write &amp; print</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#EL%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">8.</span> <span class="nav-text">EL表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5"><span class="nav-number">8.1.</span> <span class="nav-text">基础概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%9F%E6%95%B0%E6%8D%AE%E7%9A%84%E6%90%9C%E7%B4%A2%E9%A1%BA%E5%BA%8F"><span class="nav-number">8.2.</span> <span class="nav-text">域数据的搜索顺序</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E8%AF%AD%E6%B3%95"><span class="nav-number">8.2.1.</span> <span class="nav-text">输出语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%9F%E6%95%B0%E6%8D%AE%E7%9A%84%E6%90%9C%E7%B4%A2%E9%A1%BA%E5%BA%8F-2"><span class="nav-number">8.2.2.</span> <span class="nav-text">域数据的搜索顺序</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#java%E7%B1%BB%E5%B1%9E%E6%80%A7%E8%BE%93%E5%87%BA"><span class="nav-number">8.3.</span> <span class="nav-text">java类属性输出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">8.4.</span> <span class="nav-text">运算符</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">8.4.1.</span> <span class="nav-text">关系运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">8.4.2.</span> <span class="nav-text">逻辑运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">8.4.3.</span> <span class="nav-text">算术运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#empty%E8%BF%90%E7%AE%97"><span class="nav-number">8.4.4.</span> <span class="nav-text">empty运算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E5%85%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">8.4.5.</span> <span class="nav-text">三元运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8E-%E4%B8%AD%E6%8B%AC%E5%8F%B7%E8%BF%90%E7%AE%97"><span class="nav-number">8.4.6.</span> <span class="nav-text">&quot;.&quot;与[]中括号运算</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11%E4%B8%AA%E9%9A%90%E5%87%BD%E5%AF%B9%E8%B1%A1"><span class="nav-number">8.5.</span> <span class="nav-text">11个隐函对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%90%E5%87%BD%E5%AF%B9%E8%B1%A1%E5%88%97%E8%A1%A8"><span class="nav-number">8.5.1.</span> <span class="nav-text">隐函对象列表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%9F%E9%9A%90%E5%87%BD%E5%AF%B9%E8%B1%A1"><span class="nav-number">8.5.2.</span> <span class="nav-text">域隐函对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pageContext"><span class="nav-number">8.5.3.</span> <span class="nav-text">pageContext</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#param"><span class="nav-number">8.5.4.</span> <span class="nav-text">param</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#header"><span class="nav-number">8.5.5.</span> <span class="nav-text">header</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cookie"><span class="nav-number">8.5.6.</span> <span class="nav-text">cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#initParam"><span class="nav-number">8.5.7.</span> <span class="nav-text">initParam</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#JSTL"><span class="nav-number">9.</span> <span class="nav-text">JSTL</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B-2"><span class="nav-number">9.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%87%E7%AD%BE%E5%BA%93%E7%B1%BB%E5%9E%8B"><span class="nav-number">9.2.</span> <span class="nav-text">标签库类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JSTL%E7%9A%84%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4"><span class="nav-number">9.3.</span> <span class="nav-text">JSTL的使用步骤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#core%E6%A0%B8%E5%BF%83%E5%BA%93"><span class="nav-number">9.4.</span> <span class="nav-text">core核心库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#set"><span class="nav-number">9.4.1.</span> <span class="nav-text">set</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#if"><span class="nav-number">9.4.2.</span> <span class="nav-text">if</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#choose-when-otherwise"><span class="nav-number">9.4.3.</span> <span class="nav-text">choose-when-otherwise</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#forEach"><span class="nav-number">9.4.4.</span> <span class="nav-text">forEach</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%81%8D%E5%8E%86%E8%BE%93%E5%87%BA"><span class="nav-number">9.4.4.1.</span> <span class="nav-text">遍历输出</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%81%8D%E5%8E%86%E6%95%B0%E7%BB%84"><span class="nav-number">9.4.4.2.</span> <span class="nav-text">遍历数组</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%81%8D%E5%8E%86Map"><span class="nav-number">9.4.4.3.</span> <span class="nav-text">遍历Map</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%81%8D%E5%8E%86List"><span class="nav-number">9.4.4.4.</span> <span class="nav-text">遍历List</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Listener%E7%9B%91%E5%90%AC%E5%99%A8"><span class="nav-number">10.</span> <span class="nav-text">Listener监听器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ServletContextListener"><span class="nav-number">10.1.</span> <span class="nav-text">ServletContextListener</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%9F%E8%83%BD"><span class="nav-number">10.1.1.</span> <span class="nav-text">功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4"><span class="nav-number">10.1.2.</span> <span class="nav-text">操作步骤</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD"><span class="nav-number">11.</span> <span class="nav-text">文件上传与下载</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="nav-number">11.1.</span> <span class="nav-text">文件上传</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%AD%A5%E9%AA%A4"><span class="nav-number">11.1.1.</span> <span class="nav-text">基本步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP%E5%8D%8F%E8%AE%AE%E9%83%A8%E5%88%86"><span class="nav-number">11.1.2.</span> <span class="nav-text">HTTP协议部分</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8A%E4%BC%A0%E5%AE%9E%E7%8E%B0"><span class="nav-number">11.1.3.</span> <span class="nav-text">上传实现</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#jar%E5%8C%85%E4%BE%9D%E8%B5%96"><span class="nav-number">11.1.3.1.</span> <span class="nav-text">jar包依赖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E7%B1%BB%E8%AF%B4%E6%98%8E"><span class="nav-number">11.1.3.2.</span> <span class="nav-text">常用类说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81-2"><span class="nav-number">11.1.3.3.</span> <span class="nav-text">示例代码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="nav-number">11.2.</span> <span class="nav-text">文件下载</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%AD%A5%E9%AA%A4-2"><span class="nav-number">11.2.1.</span> <span class="nav-text">基本步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BD%E5%AE%9E%E7%8E%B0"><span class="nav-number">11.2.2.</span> <span class="nav-text">下载实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#setHeader%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81"><span class="nav-number">11.2.3.</span> <span class="nav-text">setHeader中文乱码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#URL%E7%BC%96%E7%A0%81%E6%96%B9%E6%A1%88"><span class="nav-number">11.2.3.1.</span> <span class="nav-text">URL编码方案</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Base64%E7%BC%96%E7%A0%81%E6%96%B9%E6%A1%88"><span class="nav-number">11.2.3.2.</span> <span class="nav-text">Base64编码方案</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%BC%E5%90%88%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="nav-number">11.2.3.3.</span> <span class="nav-text">综合解决方案</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BC%9A%E8%AF%9D%E6%9C%BA%E5%88%B6"><span class="nav-number">12.</span> <span class="nav-text">会话机制</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-7"><span class="nav-number">12.1.</span> <span class="nav-text">基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82%E9%A9%B1%E5%8A%A8-5"><span class="nav-number">12.1.1.</span> <span class="nav-text">需求驱动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A0%E7%8A%B6%E6%80%81%E7%89%B9%E6%80%A7"><span class="nav-number">12.1.2.</span> <span class="nav-text">无状态特性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%9A%E8%AF%9D%E6%A6%82%E5%BF%B5"><span class="nav-number">12.1.3.</span> <span class="nav-text">会话概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%9A%E8%AF%9D%E8%B7%9F%E8%B8%AA%E6%96%B9%E6%A1%88"><span class="nav-number">12.1.4.</span> <span class="nav-text">会话跟踪方案</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cookie"><span class="nav-number">12.2.</span> <span class="nav-text">Cookie</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-8"><span class="nav-number">12.2.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BACookie"><span class="nav-number">12.2.2.</span> <span class="nav-text">创建Cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96Cookie"><span class="nav-number">12.2.3.</span> <span class="nav-text">获取Cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9Cookie"><span class="nav-number">12.2.4.</span> <span class="nav-text">修改Cookie</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%A1%881%EF%BC%9A%E9%87%8D%E6%9E%84"><span class="nav-number">12.2.4.1.</span> <span class="nav-text">方案1：重构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%A1%882%EF%BC%9AsetValue"><span class="nav-number">12.2.4.2.</span> <span class="nav-text">方案2：setValue()</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E5%91%BD%E6%8E%A7%E5%88%B6"><span class="nav-number">12.2.5.</span> <span class="nav-text">生命控制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%89%E6%95%88%E8%B7%AF%E5%BE%84"><span class="nav-number">12.2.6.</span> <span class="nav-text">有效路径</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8BCookie"><span class="nav-number">12.2.7.</span> <span class="nav-text">查看Cookie</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Chrome"><span class="nav-number">12.2.7.1.</span> <span class="nav-text">Chrome</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Firefox"><span class="nav-number">12.2.7.2.</span> <span class="nav-text">Firefox</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cookie%E5%BA%94%E7%94%A8"><span class="nav-number">12.2.8.</span> <span class="nav-text">Cookie应用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%8D%E7%99%BB%E5%BD%95"><span class="nav-number">12.2.8.1.</span> <span class="nav-text">免登录</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Session"><span class="nav-number">12.3.</span> <span class="nav-text">Session</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-9"><span class="nav-number">12.3.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Session%E6%9C%BA%E5%88%B6"><span class="nav-number">12.3.2.</span> <span class="nav-text">Session机制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%8E%E8%8E%B7%E5%8F%96"><span class="nav-number">12.3.3.</span> <span class="nav-text">创建与获取</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Session%E6%95%B0%E6%8D%AE%E5%9F%9F"><span class="nav-number">12.3.4.</span> <span class="nav-text">Session数据域</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%94%80%E6%AF%81%E6%8E%A7%E5%88%B6"><span class="nav-number">12.3.5.</span> <span class="nav-text">销毁控制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B6%85%E6%97%B6%E9%94%80%E6%AF%81"><span class="nav-number">12.3.5.1.</span> <span class="nav-text">超时销毁</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AB%8B%E5%8D%B3%E9%94%80%E6%AF%81"><span class="nav-number">12.3.5.2.</span> <span class="nav-text">立即销毁</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-number">12.4.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="nav-number">13.</span> <span class="nav-text">过滤器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-10"><span class="nav-number">13.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Filter%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0"><span class="nav-number">13.2.</span> <span class="nav-text">Filter接口实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Filter%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">13.3.</span> <span class="nav-text">Filter生命周期</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">13.3.1.</span> <span class="nav-text">生命周期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FilterConfig"><span class="nav-number">13.3.2.</span> <span class="nav-text">FilterConfig</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FilterChain"><span class="nav-number">13.3.3.</span> <span class="nav-text">FilterChain</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#doFilter"><span class="nav-number">13.3.3.1.</span> <span class="nav-text">doFilter</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4%E9%93%BE%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">13.4.</span> <span class="nav-text">过滤链的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E7%89%B9%E7%82%B9"><span class="nav-number">13.4.1.</span> <span class="nav-text">执行特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%83%E7%94%A8%E9%80%BB%E8%BE%91"><span class="nav-number">13.4.2.</span> <span class="nav-text">调用逻辑</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4%E9%93%BE%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="nav-number">13.4.3.</span> <span class="nav-text">过滤链的配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Filter%E5%AE%9E%E9%99%85%E4%BD%BF%E7%94%A8"><span class="nav-number">13.5.</span> <span class="nav-text">Filter实际使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5"><span class="nav-number">13.5.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4"><span class="nav-number">13.5.2.</span> <span class="nav-text">使用步骤</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web-xml-2"><span class="nav-number">14.</span> <span class="nav-text">web.xml</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-11"><span class="nav-number">14.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%A8%E8%A7%A3%E4%BD%BF%E7%94%A8"><span class="nav-number">14.2.</span> <span class="nav-text">注解使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E9%A1%B5%E8%AE%BE%E7%BD%AE"><span class="nav-number">14.3.</span> <span class="nav-text">启动页设置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%94%99%E8%AF%AF%E9%A1%B5%E9%85%8D%E7%BD%AE"><span class="nav-number">14.4.</span> <span class="nav-text">错误页配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP%E5%93%8D%E5%BA%94%E7%A0%81%E5%8C%B9%E9%85%8D"><span class="nav-number">14.4.1.</span> <span class="nav-text">HTTP响应码匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%82%E5%B8%B8%E7%B1%BB%E7%B1%BB%E5%9E%8B%E5%8C%B9%E9%85%8D"><span class="nav-number">14.4.2.</span> <span class="nav-text">异常类类型匹配</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#xml%E8%A7%A3%E6%9E%90%E6%8A%80%E6%9C%AF"><span class="nav-number">15.</span> <span class="nav-text">xml解析技术</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Dom4j%E8%A7%A3%E6%9E%90%E6%8A%80%E6%9C%AF"><span class="nav-number">15.1.</span> <span class="nav-text">Dom4j解析技术</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dom4j%E7%BC%96%E7%A8%8B%E6%AD%A5%E9%AA%A4"><span class="nav-number">15.2.</span> <span class="nav-text">Dom4j编程步骤</span></a></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>



    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-copy.js"></script>




    
<script src="/js/lazyload.js"></script>



<div class="post-scripts">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>



</body>
</html>
